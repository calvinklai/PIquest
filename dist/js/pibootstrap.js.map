{"version":3,"file":"pibootstrap.js","sources":["config.js","pibootstrap.js","utils/timer/timerStopper.js","utils/timer/timerDirective.js","utils/timer/timerNow.js","utils/timer/timer-module.js","utils/utils/preloaderService.js","utils/utils/preloaderDecorator.js","utils/utils/utilsModule.js","quest/directives/buttons/buttons.js","utils/database/template/templateFilter.js","utils/database/template/templateObjProvider.js","utils/database/template/templateModule.js","utils/console/consoleProvider.js","utils/console/consolePrototypeProvider.js","utils/console/console.html!text","utils/console/consoleDirective.js","utils/console/consoleModule.js","utils/modal/modal.html!text","utils/modal/modalService.js","utils/modal/modalModule.js","quest/directives/questController.js","quest/directives/piQuest/piQuest.html!text","quest/directives/piQuest/piQuest-directive.js","quest/directives/piQuest/piqPage.html!text","quest/directives/piQuest/piqPage-directive.js","quest/directives/wrapper/wrapper.html!text","quest/directives/wrapper/wrapper-directive.js","quest/directives/text/text.html!text","quest/directives/text/textarea.html!text","quest/directives/text/textDirective.js","text!quest/directives/text/text-number.html","quest/directives/text/text-number-directive.js","quest/directives/select/selectMixerProvider.js","quest/directives/select/dropdown.html!text","quest/directives/select/dropdownDirective.js","quest/directives/select/selectOne.html!text","quest/directives/select/selectOneDirective.js","quest/directives/select/selectMulti.html!text","quest/directives/select/selectMultiDirective.js","quest/directives/grid/grid.html!text","quest/directives/grid/gridDirective.js","quest/directives/grid/gridRow.html!text","quest/directives/grid/gridRowDirective.js","quest/directives/slider/slider.html!text","quest/directives/slider/sliderDirective.js","quest/directives/slider/slider.js","quest/directives/toRegexFilter.js","quest/directives/dfltUnitsFilter.js","quest/directives/questDirectivesModule.js","utils/logger/LoggerProvider.js","utils/logger/logger-module.js","utils/database/randomize/randomizeModule.js","utils/database/mixer/mixer.js","utils/database/mixer/mixerSequential.js","utils/database/mixer/mixerRecursive.js","utils/database/mixer/mixerSequenceProvider.js","utils/database/mixer/branching/dotNotation.js","utils/database/mixer/branching/mixerDotNotationProvider.js","utils/database/mixer/branching/mixerConditionProvider.js","utils/database/mixer/branching/mixerEvaluateProvider.js","utils/database/mixer/branching/mixerBranchingDecorator.js","utils/database/mixer/mixerModule.js","utils/database/collection/collectionProvider.js","utils/database/randomizer/randomizerProvider.js","utils/database/queryProvider.js","utils/database/inflateProvider.js","utils/database/store/storeProvider.js","utils/database/databaseProvider.js","utils/database/databaseSequenceProvider.js","utils/database/databaseModule.js","quest/task/questSequenceProvider.js","quest/task/taskProvider.js","quest/task/parseProvider.js","quest/task/dfltQuestLogger.js","quest/task/task-module.js","quest/questModule.js","message/messageDirective.js","message/messageDoneDirective.js","message/messageModule.js","taskManager/task/taskActivateProvider.js","taskManager/task/taskDirective.js","taskManager/task/taskModule.js","taskManager/canvas/canvasConstructor.js","taskManager/canvas/managerCanvasService.js","taskManager/canvas/canvasModule.js","utils/helperDirectives/piSwap/piSwapDirective.js","utils/helperDirectives/piSpinner/spinner.html!text","utils/helperDirectives/piSpinner/piSpinnerDirective.js","utils/helperDirectives/helperDirectivesModule.js","taskManager/managerService.js","taskManager/managerSequence.js","taskManager/managerLoadService.js","taskManager/managerGetScriptService.js","taskManager/managerTaskLoadService.js","taskManager/managerDirective.js","taskManager/managerTaskDirective.js","taskManager/managerModule.js","utils/animations/rafPolyfill.js","utils/animations/dropInAnimation.js","utils/animations/fadeAnimation.js","utils/animations/slideAnimation.js","utils/animations/animationModule.js","app.js","../../bower_components/PIPlayer/dist/js/extensions/dscore/Scorer.js","APIs/APIConstructor.js","APIs/pipAPI.js","APIs/pi/APIdecorator.js","APIs/pi/pipAPI.js","APIs/questAPI.js","APIs/pi/questAPI.js","APIs/managerAPI.js","managerAPI/pi/messageTemplate.jst!text","managerAPI/pi/messageTemplateDebrief.jst!text","managerAPI/pi/messageTemplatePanel.jst!text","APIs/pi/managerAPI.js"],"names":["define","require","config","paths","underscore","angular","animate","text","jquery","packages","name","location","main","shim","exports","deps","window","app","$provide","decorator","$delegate","$window","exception","cause","_errs","push","element","ready","setTimeout","resumeBootstrap","stopperProvider","now","Stopper","this","startTime","prototype","$inject","timerController","$timeout","TimerStopper","timerStart","options","_","isPlainObject","Error","$scope","ctrl","getScope","defaults","direction","template","show","removeOnEnd","duration","stopper","targetTime","tick","timerStop","cancel","timeoutId","remove","INTERVAL","timeLeft","$emit","currentTime","extend","milisToTime","Math","min","time","secs","floor","hours","divisor_for_minutes","minutes","divisor_for_seconds","seconds","ceil","obj","current","milis","start","stop","timerDirective","$compile","controller","priority","link","$element","$attr","$timerElement","prepend","contents","localScope","$new","zeroPad","n","$on","nowFn","performance","mozNow","webkitNow","msNow","oNow","apply","Date","module","service","directive","value","preloaderService","$q","loaders","loaded","preloaderRegister","type","fn","isFunction","preloaderLoad","description","promise","resultObj","loader","getObj","call","isPromiseLike","then","result","preloaderLoadArr","descriptions","defs","isArray","map","load","all","preloaderGetObj","find","loadObj","preloaderGet","register","loadArr","get","preloaderDecorator","preloader","imageLoader","url","def","defer","img","Image","onload","bind","resolve","onerror","reject","src","$injector","piInvoke","locals","global","$rootScope","invoke","constant","activeClass","toggleEvent","buttonConfig","scope","attrs","ctrls","buttonsCtrl","ngModelCtrl","$render","toggleClass","equals","$modelValue","$eval","btnRadio","isActive","hasClass","isDefined","uncheckable","$apply","$setViewValue","getTrueValue","getCheckboxValue","btnCheckboxTrue","getFalseValue","btnCheckboxFalse","attributeValue","defaultValue","val","templateFilter","$log","defaultContext","input","context","indexOf","e","error","message","templateObjProvider","$filter","templateObj","deepTemplate","forEach","key","expand","deep","includes","isString","filter","mapValues","consoleProvider","consolePrototype","Console","tags","force","$console","create","consoleSetSettings","settings","setSettings","consolePrototypeProvider","shouldLog","level","targetLevel","targetTags","LOGFUNCTIONS","LEVELS","intersection","length","createLog","i","args","arguments","hideConsole","each","none","warn","info","log","debug","replace","index","logs","splice","reverse","stringify","pretty","toJson","modalConstructor","$rootElement","$document","modalCleanup","$destroy","deferred","$backDrop","off","removeClass","modalOpener","close","on","header","body","button","addClass","$digest","open","questController","$parse","piConsole","registerModel","ngModel","correctValidator","response","correctValue","data","isNumber","isEqual","$setValidity","ngModelGet","dfltValue","hasOwnProperty","dflt","model","$parent","isUndefined","assign","self","serial","size","questions","$viewValue","$formatters","modelValue","$parsers","viewValue","latency","pristineLatency","$watch","newValue","oldValue","onChange","onDestroy","correct","onCreate","NaN","event","preventDefault","declined","undefined","submitLatency","onSubmit","onDecline","timeout","onTimeout","piQuestCtrl","Task","templateDefaultContext","mixerDefaultContext","next","target","task","prev","script","pageData","$animate","terminal","parentElement","attr","cleanupLastPage","previousElement","currentScope","currentElement","leave","newPage","page","newScope","tempElm","jqLite","addAnimations","enter","refresh","animationsStr","animations","split","animation","has","piqPageCtrl","piModal","pageRefresh","pageSetup","timer","timerEnd","$broadcast","pagesMeta","$meta","pagesData","$context","timerProceed","submit","submitOnEnd","harvest","lognow","q","$logged","skipValidation","valid","pageForm","$valid","submitAttempt","proceed","decline","$event","$el","notDoubleClick","setup","$ctrl","capitaliseFirstLetter","string","charAt","toUpperCase","slice","questElement","children","eq","attrName","PREFIX","kebabCase","textDirective","el","textTemplate","textareaTemplate","controllerAs","maxlengthLimit","$input","limit","maxlength","form","autoSubmit","which","minValidator","parseFloat","isNaN","maxValidator","max","selectMixerProvider","shuffle","mixer","selectMixer","answersArr","answers","answer","numericValues","randomize","order","quest","chooseText","requiredValidator","$isEmpty","html","required","unshift","buttons","style","listCss","listItemCss","listClass","listItemClass","lineHeight","minWidth","isEmpty","chosen","pluck","gridDirective","mapColumns","columns","objectify","column","tap","noReverse","reverseValue","commit","mapRows","rows","row","zerofill","thru","identity","stem","w","an","abs","digitCount","LN10","zeroString","pow","toString","substr","$watchCollection","responses","reduce","total","isFinite","gridRowDirective","newVal","$response","sliderDirective","root","factory","amd","join","setValue","percentage","steppedPercentage","steps","round","renderView","showHandle","handleDisplay","highlightDisplay","highlight","highlightStyle","right","display","handleStyle","left","toPercentage","range","fromPercentage","toFixed","onHandleMousedown","mouseMove","fixEvent","basePercentage","pageX","basePosition","prop","sliderHandleWidth","mouseUp","SLIDER_CHANGE_EVENT","stopPropagation","onSliderMouseDown","sliderWidth","sliderPosition","getBoundingClientRect","querySelector","clientWidth","pipWidth","labels","labelsWidth","getNumber","num","Array","eventDoc","doc","clientX","ownerDocument","document","documentElement","scrollLeft","clientLeft","pageY","clientY","scrollTop","clientTop","toRegexFilter","toRegex","err","isRegExp","RegExp","dfltUnits","unit","suffix","isNumeric","String","$sceProvider","enabled","transclude","unvalid","loggerProvider","$http","Logger","dfltLogFn","pending","sent","meta","suppress","a","logObj","logFn","logCounter","pulse","send","success","post","sendData","suppressPulse","getCount","$get","provider","random","mixProvider","mix","mixerName","mixers","remix","$parsed","wrapper","repeat","sequence","times","concat","clone","randomDeepMixer","arr","seq","choose","take","weightedRandom","total_weight","weights","cur","random_num","weight_sum","mixerSequentialProvider","mixerSequential","depth","mixed","shift","mixerRecursiveProvider","mixerRecursive","flatten","mixerSequenceProvider","MixerSequence","stack","add","pointer","subSequence","isNext","pop","number","outOf","memo","sub","dotNotation","chain","mixerDotNotationProvider","mixerDotNotation","escapeSeparatorRegex","test","mixerConditionProvider","mixerCondition","condition","operator","compare","to","evaluateProvider","evaluate","conditions","cond","and","every","nand","or","some","nor","mixerBranchingDecorator","branch","elseData","multiBranch","branches","collectionService","Collection","collection","first","last","end","previous","list","at","methods","method","coll","RandomizerProvider","randomizeInt","randomizeRange","Randomizer","_cache","exRandom","sequential","seed","cache","queryProvider","queryFn","query","randomizer","set","where","handle","namespace","JSON","inflateProvider","customize","source","inflate","recursive","parent","child","cloneDeep","inheritObj","inherit","merge","childProp","parentProp","storeProvider","Store","store","nameSpace","read","update","del","DatabaseProvider","DatabaseSequence","Database","createColl","getColl","$inflated","reinflate","$templated","regenerateTemplate","SequenceProvider","Sequence","db","mixerSequence","questionsArr","TaskProvider","QuestSequence","parse","dfltQuestLogger","logger","onEnd","noop","nextObj","parseProvider","pagesSets","questionsSets","DEBUG","responseObj","onKeydown","keyArr","keys","charCodeAt","done","empty","events","$template","activators","taskActivateProvider","taskActivate","activator","destroy","$script","play","annotate","activateTask","canvas","proceedListener","keyCode","ctrlKey","one","skipListener","proceedObject","bustCache","canvasOff","oldTitle","taskName","skip","piGlobal","title","activateProvider","activateQuest","$canvas","append","activateMessage","activatePIP","req","requirejs","uniqueId","baseUrl","backbone","activate","canvasContructor","offArr","rule","property","old","css","managerCanvasService","$body","background","canvasBackground","fontSize","fontColor","canvasConstructor","swapControler","swapDirective","compile","pre","$ctrls","$transclude","cleanupLast","opts","postLeave","props","spinner","managerService","ManagerSequence","taskLoad","manager","preloadImages","loadOptions","setBaseUrl","sequenceProvider","tasksSets","managerLoadService","getScript","managerLoadScript","when","getScriptProvider","isText","getTime","taskLoadService","managerGetScript","scriptUrl","templateUrl","promises","managerControler","ManagerService","managerLoad","init","getPath","path","substring","lastIndexOf","taskSource","loading","prevTask","currentTask","thisCtrl","$qSequence","onPreTask","swap","taskDone","ev","prms","piManager","piManagerTask","vendors","requestAnimationFrame","vp","cancelAnimationFrame","navigator","userAgent","lastTime","callback","nextTime","clearTimeout","topdx","raf","rafCancel","deltaTime","proportion","top","cancelId","canceled","opacity","submodules","run","globalAttr","r","dataArray","AnalyzedVar","ErrorVar","condVar","cond1VarValues","cond2VarValues","parcelVar","parcelValue","fastRT","maxFastTrialsRate","minRT","maxRT","maxErrorParcelRate","errorLatency","use","penalty","useForSTD","postSettings","setComputeObject","setDataArray","messages","MessageDef","manyErrors","tooFast","notEnough","setMsgObject","getScoreMsg","t","o","s","c","cut","u","getMessage","parcelArray","scoreData","msgMan","Init","l","g","h","p","f","d","v","m","y","trialIData","validate","checkErrors","errorMessage","addPenalty","avgCon1","avgCon2","checkArray","avgAll","avgParcel","diff","avgBoth","varianceAll","varianceParcel","variance","scoreAll","scoreParcel","score","sqrt","computeData","parcelMng","console","addSettings","computeD","FBMsg","getFBMsg","DScore","postToServer","msg","dynamicPost","APIconstructor","API","sets","camelCase","add_set","setName","settingsObj","addSequence","addGlobal","getGlobal","addCurrent","getCurrent","addScript","defined","ajax","contentType","dataType","injector","setSetter","setArr","targetSets","api","addTrialSets","addTrialSet","addStimulusSets","addStimulusSet","addMediaSets","addMediaSet","getLogs","APIdecorator","constructor","save","taskNumber","counter","Constructor","buildBaseUrl","isDev","version","host","setVersion","ver","piTemplate","content","showFeedback","showPanel","messageTemplateDebrief","messageTemplate","sessionStatus","footer","messageTemplatePanel","wrap","noFeedback","exclude","feedback"],"mappings":"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","sourcesContent":["/*jshint unused: vars */\ndefine('config',[],function(){\n\trequire.config({\n\t\tpaths: {\n\t\t\t// libs\n\t\t\tunderscore: [\"//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min\",\"../../bower_components/lodash-compat/lodash.min\"],\n\t\t\t//angular: '../../bower_components/angular/angular',\n\t\t\tangular: ['//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min','../../bower_components/angular/angular.min'],\n\t\t\tanimate: ['//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-animate.min', '../../bower_components/angular-animate/angular-animate.min'],\n\t\t\ttext: ['//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.10/text.min','../../bower_components/requirejs-text/text'],\n\n\t\t\t// this lib is needed for pipScorer\n\t\t\tjquery: [\"//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min\",\"../../bower_components/jquery/dist/jquery.min\"]\n\t\t},\n\n\t\tpackages:[\n\t\t\t{\n\t\t\t\tname: 'pipScorer',\n\t\t\t\tlocation: '../../bower_components/PIPlayer/dist/js/extensions/dscore',\n\t\t\t\tmain: 'Scorer'\n\t\t\t}\n\t\t],\n\t\tshim: {\n\t\t\tangular : {exports : 'angular'},\n\t\t\tanimate : {deps: ['angular'], exports: 'angular'}\n\t\t},\n\t\tdeps: [\n\t\t\t// The APIs are preloaded into the app so we don't have to set them as dependencies here\n\t\t\t'angular', 'animate', 'underscore','text'\n\t\t]\n\t});\n\n\t//http://code.angularjs.org/1.2.1/docs/guide/bootstrap#overview_deferred-bootstrap\n\twindow.name = 'NG_DEFER_BOOTSTRAP!';\n});\n","/*jshint unused: vars */\ndefine('pibootstrap',['./config'], function(){\n\n\trequire.config({\n\t\tpackages: [\n\t\t\t{name: 'pipAPI', location:'APIs', main:'pi/pipAPI'},\n\t\t\t{name: 'questAPI', location:'APIs', main:'pi/questAPI'},\n\t\t\t{name: 'managerAPI', location:'APIs', main:'pi/managerAPI'}\n\t\t]\n\t});\n\n\trequire(['angular','app'], function(angular, app) {\n\n\t\t// integrate with erroception\n\t\tapp.config(['$provide',function($provide) {\n\t\t\t$provide.decorator(\"$exceptionHandler\", ['$delegate','$window', function($delegate, $window) {\n\t\t\t\treturn function(exception, cause) {\n\t\t\t\t\t$window._errs && $window._errs.push(exception);\n\t\t\t\t\t$delegate(exception, cause);\n\t\t\t\t};\n\t\t\t}]);\n\t\t}]);\n\n\t\t// resume boot strap\n\t\t// http://stackoverflow.com/a/25770449/1400366\n\t\t// The angular.js detects dom ready via JQLite. When the document loads, it triggers a method which defines the resumeBootstrap method.\n\t\t// The problem is that you cannot enforce processing order between domready and JQLite ready,\n\t\t// if domready already fulfills your dependency before the method gets defined, you are in trouble.\n\t\t// The workaround is to enforce javascript to execute all event handlers before your resumeBootstrap invocation.\n\t\t// I've used the setTimeout method to do so, e.g.: setTimeout(angular.resumeBootstrap, 0).\n\t\tangular.element().ready(function() {\n\t\t\tsetTimeout(function(){\n\t\t\t\tangular.resumeBootstrap([app.name]);\n\t\t\t},0);\n\t\t});\n\t});\n});\n","/**\n * a stopper\n */\n\ndefine('utils/timer/timerStopper',[],function(){\n\n\tstopperProvider.$inject = ['timerNow'];\n\tfunction stopperProvider(now){\n\t\tfunction Stopper(){\n\t\t\tthis.startTime = now();\n\t\t}\n\n\t\tStopper.prototype.now = function(){\n\t\t\treturn now() - this.startTime;\n\t\t};\n\n\t\treturn Stopper;\n\t}\n\n\treturn stopperProvider;\n\n});\n","/**\n * The piTimer directive lies dormant on its parent element\n * When \"start(options)\" is called it starts a timer\n *\n * options:\n * direction: up/down (default)\n * show: display counter\n * remove: remove counter when timer ends\n * duration: how long...\n *\n */\ndefine('utils/timer/timerDirective',['require','underscore','angular'],function (require) {\n\n\tvar _ = require('underscore');\n\tvar angular = require('angular');\n\n\ttimerController.$inject = ['$timeout','timerStopper'];\n\tfunction timerController($timeout, TimerStopper){\n\t\tvar ctrl = this;\n\t\tvar $scope = {}; // the local scope that we created (fake object for case we attempt to access scope before we set it...)\n\t\tctrl.start = timerStart;\n\t\tctrl.stop = timerStop;\n\n\t\tfunction timerStart(options){\n\t\t\tif (!_.isPlainObject(options)){\n\t\t\t\tthrow new Error('Timer options must be an object');\n\t\t\t}\n\n\t\t\t$scope = ctrl.getScope(); // get the local scope that we created\n\n\t\t\t$scope.options = _.defaults(options, {\n\t\t\t\tdirection : 'down',\n\t\t\t\ttemplate : 'normal',\n\t\t\t\tshow : true,\n\t\t\t\tremoveOnEnd : true,\n\t\t\t\tduration : 0 // in seconds\n\t\t\t});\n\n\t\t\t// translate duratio to ms\n\t\t\tctrl.stopper = new TimerStopper();\n\t\t\tctrl.targetTime = $scope.options.duration * 1000;\n\n\t\t\t$scope.options.show && ctrl.show();\n\n\t\t\t// activate the timer\n\t\t\ttick();\n\t\t}\n\n\t\tfunction timerStop(){\n\t\t\tvar options = $scope.options || {};\n\t\t\t$scope = ctrl.getScope(); // get the local scope that we created\n\t\t\t$timeout.cancel(ctrl.timeoutId);\n\t\t\toptions.removeOnEnd && ctrl.remove();\n\t\t}\n\n\t\tfunction tick(){\n\t\t\t// update scope\n\t\t\tvar INTERVAL = 100;\n\t\t\tvar options = $scope.options;\n\t\t\tvar now = ctrl.stopper.now();\n\t\t\tvar timeLeft = ctrl.targetTime - now;\n\n\n\t\t\tif (now >= ctrl.targetTime){\n\t\t\t\t$scope.$emit('timer-end');\n\t\t\t\toptions.removeOnEnd && ctrl.remove();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// time to show and parse\n\t\t\tvar currentTime = options.direction === 'up' ? now : timeLeft;\n\n\t\t\t// update scope with times\n\t\t\t_.extend($scope, milisToTime(currentTime));\n\t\t\tctrl.timeoutId = $timeout(tick, Math.min(INTERVAL,timeLeft));\n\t\t\t$scope.$emit('timer-tick');\n\t\t}\n\n\t\tfunction milisToTime(time){\n\t\t\tvar secs = Math.floor(time/1000);\n\t\t\tvar hours = Math.floor(secs / (60 * 60));\n\n\t\t\tvar divisor_for_minutes = secs % (60 * 60);\n\t\t\tvar minutes = Math.floor(divisor_for_minutes / 60);\n\n\t\t\tvar divisor_for_seconds = divisor_for_minutes % 60;\n\t\t\tvar seconds = Math.ceil(divisor_for_seconds);\n\n\t\t\tvar obj = {\n\t\t\t\tcurrent: time,\n\t\t\t\thours: hours,\n\t\t\t\tminutes: minutes,\n\t\t\t\tseconds: seconds,\n\t\t\t\tmilis: time % 1000\n\t\t\t};\n\t\t\treturn obj;\n\t\t}\n\t}\n\n\ttimerDirective.$inject = ['$compile'];\n\tfunction timerDirective($compile){\n\t\treturn {\n\t\t\tcontroller: timerController,\n\t\t\tpriority: 400,\n\t\t\tlink: function($scope, $element,$attr,ctrl){\n\t\t\t\tvar template = '<div class=\"pi-timer well well-sm text-center\" style=\"font-family: monospace;\">{{minutes}}:{{zeroPad(seconds)}}</div>';\n\t\t\t\tvar $timerElement;\n\t\t\t\tvar localScope = $scope.$new();\n\n\t\t\t\tctrl.show = show;\n\t\t\t\tctrl.remove = remove;\n\t\t\t\tctrl.getScope = function(){return localScope;};\n\n\t\t\t\tlocalScope.zeroPad = function pad(n){return n<10 ? '0'+n : n;};\n\t\t\t\t$scope.$on('$destroy',remove);\n\n\t\t\t\tfunction show(){\n\t\t\t\t\t$timerElement = angular.element(template);\n\t\t\t\t\t$element.prepend($timerElement);\n\t\t\t\t\t$compile($timerElement.contents())(localScope);\n\t\t\t\t}\n\n\t\t\t\tfunction remove(){\n\t\t\t\t\t$timerElement && $timerElement.remove();\n\t\t\t\t\t$timerElement = null;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\treturn timerDirective;\n});\n","/* global performance */\n\n/**\n * Returns current time (uses performance if possible).\n * Notably, this function return either time since epoch or since startup. It is useful only for latency calculations.\n * @return {integer} [Time in ms]\n */\ndefine('utils/timer/timerNow',[],function(){\n\n\tvar nowFn;\n\n\t// if performance is set, look for the now function\n\tif (!!window.performance) {\n\t\tnowFn = performance.now ||\n\t\tperformance.mozNow ||\n\t\tperformance.webkitNow ||\n\t\tperformance.msNow ||\n\t\tperformance.oNow;\n\t}\n\n\t// if we have now proxy it (so it uses perfomance as \"this\")\n\t// otherwise use regular date/time\n\treturn nowFn ?\n\t\tfunction now(){return nowFn.apply(performance);}\n\t\t: function now(){ return +new Date();};\n\n});\n","define('utils/timer/timer-module',['require','angular','./timerStopper','./timerDirective','./timerNow'],function(require){\n\tvar angular = require('angular');\n\tvar module = angular.module('timer',[]);\n\n\tmodule.service('timerStopper', require('./timerStopper'));\n\tmodule.directive('piTimer', require('./timerDirective'));\n\tmodule.value('timerNow', require('./timerNow'));\n\n\treturn module;\n});\n","define('utils/utils/preloaderService',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tpreloaderService.$inject = ['$q'];\n\tfunction preloaderService($q){\n\t\tthis.$q = $q;\n\t\tthis.loaders = {};\n\t\tthis.loaded = [];\n\t}\n\n\t_.extend(preloaderService.prototype, {\n\t\tregister: preloaderRegister,\n\t\tload: preloaderLoad,\n\t\tloadArr: preloaderLoadArr,\n\t\tget: preloaderGet,\n\t\tgetObj: preloaderGetObj\n\t});\n\n\treturn preloaderService;\n\n\t/**\n\t * register loader\n\t * loader functions take a single parameter: the description\n\t * and return a promise to be resolved with the result.\n\t *\n\t * @param  {String}   type The loader type\n\t * @param  {Function} fn   The loader function itself (should return a promise to be resolved with the result)\n\t */\n\tfunction preloaderRegister(type, fn){\n\t\tif (!_.isFunction(fn)){\n\t\t\tthrow new Error('Fn is not a function');\n\t\t}\n\n\t\tthis.loaders[type] = fn;\n\t}\n\n\tfunction preloaderLoad(type, description){\n\t\tvar loader = this.loaders[type];\n\t\tvar promise, resultObj;\n\n\t\t// check if this description has already been loaded\n\t\tresultObj = this.getObj(type, description);\n\t\tif (!resultObj){\n\t\t\tresultObj = {type:type, description:description};\n\t\t\tthis.loaded.push(resultObj);\n\t\t} else {\n\t\t\treturn resultObj.promise;\n\t\t}\n\n\t\t// make sure loader was registered\n\t\tif (!_.isFunction(loader)){\n\t\t\tthrow new Error('Loader \"' + type + '\" was not registered.');\n\t\t}\n\n\t\t// call loader\n\t\tpromise = resultObj.promise = loader.call(this, description);\n\n\t\t// make sure loader returns a promise\n\t\tif (!isPromiseLike(promise)){\n\t\t\tthrow new Error('Loader \"' + type + '\" must return a promise.');\n\t\t}\n\n\t\t// save result into the loaded array (we use an array in order to allow non string descriptions)\n\t\tpromise.then(function(result){\n\t\t\tresultObj.promise = null; // so that the promise can be garbage collected\n\t\t\tresultObj.value = result;\n\t\t\treturn result;\n\t\t});\n\n\t\treturn promise;\n\t}\n\n\tfunction preloaderLoadArr(type, descriptions){\n\t\tvar $q = this.$q;\n\t\tvar defs;\n\n\t\tif (!_.isArray(descriptions)){\n\t\t\tthrow new Error('descriptions must be an array.');\n\t\t}\n\n\t\tdefs = _.map(descriptions, function(description){\n\t\t\treturn this.load(type, description);\n\t\t}, this);\n\n\t\treturn $q.all(defs);\n\t}\n\n\tfunction preloaderGetObj(type, description){\n\t\t// get the\n\t\tvar result = _.find(this.loaded, function(loadObj){\n\t\t\treturn loadObj.type === type && loadObj.description === description;\n\t\t}, this);\n\n\t\treturn result;\n\t}\n\n\tfunction preloaderGet(type, description){\n\t\tvar result = this.getObj(type, description);\n\n\t\tif (!('value' in result)){\n\t\t\tthrow new Error('This object has not been loaded yet: \"' + description + '\"');\n\t\t}\n\n\t\treturn result.value;\n\t}\n\n\tfunction isPromiseLike(obj){\n\t\treturn _.isPlainObject(obj) && _.isFunction(obj.then);\n\t}\n});\n","define('utils/utils/preloaderDecorator',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tpreloaderDecorator.$inject = ['$delegate'];\n\tfunction preloaderDecorator(preloader){\n\t\tpreloader.register('image', imageLoader);\n\t\treturn preloader;\n\t}\n\n\tfunction imageLoader(url){\n\t\tvar def = this.$q.defer();\n\t\tvar img = new Image();\t// create img object\n\t\timg.onload = _.bind(def.resolve, def, img);\n\t\timg.onerror = _.bind(def.reject, def, img);\n\t\timg.src = url;\n\t\treturn def.promise;\n\t}\n\n\treturn preloaderDecorator;\n});\n","define('utils/utils/utilsModule',['require','angular','underscore','./preloaderService','./preloaderDecorator'],function(require){\n\tvar angular = require('angular');\n\tvar _ = require('underscore');\n\tvar module = angular.module('pi.utils',[]);\n\n\tmodule.service('piPreloader', require('./preloaderService'));\n\tmodule.config(['$provide', function($provide){\n\t\t$provide.decorator('piPreloader', require('./preloaderDecorator'));\n\t}]);\n\n\n\n\t/**\n\t * Wrapper for angular invoke.\n\t * Injects global and current automatically.\n\t *\n\t * @param {Function} fn The function to invoke\n\t * @param {Object} locals Locals to add to angualr invoke\n\t */\n\tmodule.service('piInvoke', ['$injector',function($injector){\n\t\tvar $rootScope = $injector.get('$rootScope');\n\n\t\tfunction piInvoke(fn, locals){\n\t\t\tvar global = $rootScope.global || {};\n\n\t\t\t// if fn is undefined don't get all mushy about it\n\t\t\tif (!fn){\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$injector.invoke(fn, null, _.extend(locals, {\n\t\t\t\tglobal: global,\n\t\t\t\tcurrent: global.current\n\t\t\t}));\n\t\t}\n\n\t\treturn piInvoke;\n\t}]);\n\n\treturn module;\n});\n","define('quest/directives/buttons/buttons',['require','angular'],function(require){\n\tvar angular = require('angular');\n\treturn angular\n\n\t.module('ui.bootstrap.buttons', [])\n\n\t.constant('buttonConfig', {\n\t\tactiveClass: 'active',\n\t\ttoggleEvent: 'click'\n\t})\n\n\t.controller('ButtonsController', ['buttonConfig', function(buttonConfig) {\n\t\tthis.activeClass = buttonConfig.activeClass || 'active';\n\t\tthis.toggleEvent = buttonConfig.toggleEvent || 'click';\n\t}])\n\n\t.directive('btnRadio', function () {\n\t\treturn {\n\t\t\trequire: ['btnRadio', 'ngModel'],\n\t\t\tcontroller: 'ButtonsController',\n\t\t\tlink: function (scope, element, attrs, ctrls) {\n\t\t\t\tvar buttonsCtrl = ctrls[0], ngModelCtrl = ctrls[1];\n\n\t\t\t\t//model -> UI\n\t\t\t\tngModelCtrl.$render = function () {\n\t\t\t\t\telement.toggleClass(buttonsCtrl.activeClass, angular.equals(ngModelCtrl.$modelValue, scope.$eval(attrs.btnRadio)));\n\t\t\t\t};\n\n\t\t\t\t//ui->model\n\t\t\t\telement.bind(buttonsCtrl.toggleEvent, function () {\n\t\t\t\t\tvar isActive = element.hasClass(buttonsCtrl.activeClass);\n\n\t\t\t\t\tif (!isActive || angular.isDefined(attrs.uncheckable)) {\n\t\t\t\t\t\tscope.$apply(function () {\n\t\t\t\t\t\t\tngModelCtrl.$setViewValue(isActive ? null : scope.$eval(attrs.btnRadio));\n\t\t\t\t\t\t\tngModelCtrl.$render();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t})\n\n\t.directive('btnCheckbox', function () {\n\t\treturn {\n\t\t\trequire: ['btnCheckbox', 'ngModel'],\n\t\t\tcontroller: 'ButtonsController',\n\t\t\tlink: function (scope, element, attrs, ctrls) {\n\t\t\t\tvar buttonsCtrl = ctrls[0], ngModelCtrl = ctrls[1];\n\n\t\t\t\tfunction getTrueValue() {\n\t\t\t\t\treturn getCheckboxValue(attrs.btnCheckboxTrue, true);\n\t\t\t\t}\n\n\t\t\t\tfunction getFalseValue() {\n\t\t\t\t\treturn getCheckboxValue(attrs.btnCheckboxFalse, false);\n\t\t\t\t}\n\n\t\t\t\tfunction getCheckboxValue(attributeValue, defaultValue) {\n\t\t\t\t\tvar val = scope.$eval(attributeValue);\n\t\t\t\t\treturn angular.isDefined(val) ? val : defaultValue;\n\t\t\t\t}\n\n\t\t\t\t//model -> UI\n\t\t\t\tngModelCtrl.$render = function () {\n\t\t\t\t\telement.toggleClass(buttonsCtrl.activeClass, angular.equals(ngModelCtrl.$modelValue, getTrueValue()));\n\t\t\t\t};\n\n\t\t\t\t//ui->model\n\t\t\t\telement.bind(buttonsCtrl.toggleEvent, function () {\n\t\t\t\t\tscope.$apply(function () {\n\t\t\t\t\t\tngModelCtrl.$setViewValue(element.hasClass(buttonsCtrl.activeClass) ? getFalseValue() : getTrueValue());\n\t\t\t\t\t\tngModelCtrl.$render();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t});\n});\n","define('utils/database/template/templateFilter',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\ttemplateFilter.$inject = ['$log','templateDefaultContext'];\n\tfunction templateFilter($log, defaultContext){\n\n\t\tfunction template(input, context){\n\n\t\t\t// if there is no template just return the string\n\t\t\tif (!~input.indexOf('<%')){\n\t\t\t\treturn input;\n\t\t\t}\n\n\t\t\t// build context (extend it with the default context)\n\t\t\tcontext = _.extend(context || {}, defaultContext);\n\n\t\t\t// filters don't throw errors when used from within templates\n\t\t\t// therefore we need catch any errors here... (we may decide to drop this if it hits performance too mutch...)\n\t\t\ttry{\n\t\t\t\treturn _.template(input)(context);\n\t\t\t} catch(e){\n\t\t\t\t$log.error(\"ERROR: \\\"\" + e.message + \"\\\" in the following template: \", input);\n\t\t\t\treturn \"\";\n\t\t\t}\n\n\t\t}\n\n\t\treturn template;\n\n\t}\n\n\treturn templateFilter;\n});\n","define('utils/database/template/templateObjProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\ttemplateObjProvider.$inject = ['$filter'];\n\tfunction templateObjProvider($filter){\n\t\tvar filter = $filter('template');\n\n\t\tfunction templateObj(obj, context, options){\n\t\t\toptions || (options = {});\n\t\t\tvar deepTemplate = obj.deepTemplate;\n\n\t\t\t_.forEach(obj, function(value,key,obj){\n\t\t\t\tobj[key] = expand(value, context, {deep: _.includes(deepTemplate, key)});\n\t\t\t});\n\n\t\t\treturn obj;\n\t\t}\n\n\t\treturn templateObj;\n\n\t\tfunction expand(value, context, options){\n\t\t\tvar deep = options && options.deep;\n\n\t\t\tif (_.isString(value)){\n\t\t\t\treturn filter(value, context);\n\t\t\t}\n\n\t\t\tif (deep && _.isArray(value)){\n\t\t\t\treturn _.map(value, _.bind(expand, null, _, context, options));\n\t\t\t}\n\n\t\t\tif (deep && _.isPlainObject(value)){\n\t\t\t\treturn _.mapValues(value, _.bind(expand, null, _, context, options));\n\t\t\t}\n\n\t\t\treturn value;\n\t\t}\n\n\t}\n\n\n\treturn templateObjProvider;\n});\n","define('utils/database/template/templateModule',['require','angular','./templateFilter','./templateObjProvider'],function(require){\n\tvar angular = require('angular');\n\n\tvar module = angular.module('template', []);\n\n\tmodule.filter('template', require('./templateFilter'));\n\tmodule.service('templateObj', require('./templateObjProvider'));\n\tmodule.constant('templateDefaultContext',{});\n\n\treturn module;\n});\n","/**\n * A factory for $console\n *\n * each $console is prototyped on `consolePrototype`\n */\ndefine('utils/console/consoleProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tconsoleProvider.$inject = ['piConsolePrototype'];\n\n\tfunction consoleProvider(consolePrototype){\n\n\t\t// decorate Console with a simple settings manager\n\t\tConsole.setSettings = consoleSetSettings;\n\n\t\treturn Console;\n\n\t\tfunction Console(tags, force){\n\t\t\tvar $console = _.create(consolePrototype);\n\n\t\t\t_.extend($console, {\n\t\t\t\ttags: _.isArray(tags) ? tags : [tags], // make sure tags is an array\n\t\t\t\tforce: !!force\n\t\t\t});\n\n\t\t\treturn $console;\n\t\t}\n\n\t\t// a mehtod of console\n\t\tfunction consoleSetSettings (settings) {\n\t\t\tconsolePrototype.settings = settings;\n\t\t}\n\n\t}\n\n\treturn consoleProvider;\n});\n","/**\n * This is our $console object.\n * It is a bit weird as it is supposed to work in concert with the consoleProvider.\n *\n * it depends on `tags` {Array} and `force` {Boolean} to be set externaly.\n *\n * {\n * \t\tlog: logFn\n * \t\tinfo: infoFn\n * \t\tshouldLog: fn that test whether as specific level should be logged\n * \t\tsettings: settingsObj ==> to be set from piConsole\n * \t\ttags: ['tag1'] // to be compared to settings.tags ==> to be set from piConsole\n * \t\tforce: false // ignore tags and level ==> to be set from piConsole\n * }\n */\ndefine('utils/console/consolePrototypeProvider',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\tvar LOGFUNCTIONS = ['log', 'info', 'warn', 'error', 'debug'];\n\tvar LEVELS = {none:9, error:1, warn:2, info:3, log:4, debug:4};\n\n\tconsolePrototypeProvider.$inject = ['$log', '$rootScope'];\n\tfunction consolePrototypeProvider ($log, $rootScope) {\n\t\t/**\n\t\t * Create the prototype for the instances of piConsole\n\t\t */\n\t\tvar consolePrototype = {};\n\n\t\t// add logging function\n\t\t_.each(LOGFUNCTIONS, function(level){\n\t\t\tconsolePrototype[level] = createLog(level);\n\t\t});\n\n\t\t// default settings\n\t\tconsolePrototype.settings = {};\n\n\t\t// the function that checks if this instance\n\t\tconsolePrototype.shouldLog = shouldLog;\n\n\t\t// if we want the individual functions to be seperable sometime...\n\t\t//_.bindAll(consolePrototype);\n\n\t\treturn consolePrototype;\n\n\t\t/**\n\t\t * This function is a method of the consolePrototype.\n\t\t * It accesses the global settings, and the definitions set by Console and returns whether we should log\n\t\t *\n\t\t * @param  {String} level \tThe level of logging we are testing\n\t\t * @return {Boolean}\t\tWhether to log this or not\n\t\t */\n\t\tfunction shouldLog(level){\n\t\t\tvar targetLevel = this.settings.level || 'error'; // levels set to show\n\t\t\tvar targetTags = this.settings.tags || 'all'; // tags set to show\n\t\t\tvar tags = this.tags;\n\t\t\tvar force = this.force;\n\n\t\t\tif (force){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// check if this level should *not* be logged\n\t\t\tif (!~_.indexOf(LOGFUNCTIONS, targetLevel)){\n\t\t\t\tthis.settings.level = 'error';\n\t\t\t\tthis.error('Unknow DEBUG level: \"' + targetLevel + '\". The valid levels are debug>info>warn>error>none');\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (LEVELS[level] > LEVELS[targetLevel]){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// check if these tags should be logged (fit targetTags)\n\t\t\tif (targetTags !== 'all' && !_.intersection(tags, _.isArray(targetTags) ? targetTags : [targetTags]).length){\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// if we were not regected, this should be logged\n\t\t\treturn true;\n\t\t}\n\n\t\t/**\n\t\t * Builds the log functions for consolePrototype\n\t\t * @param  {String} level \tLevel name\n\t\t * @return {Function}       A logging function\n\t\t */\n\t\tfunction createLog (level) {\n\t\t\treturn function(){\n\t\t\t\tvar settings = this.settings;\n\t\t\t\tvar i, args = [];\n\n\t\t\t\tif (this.shouldLog(level)){\n\t\t\t\t\t// get arguments (so that we don't leak the arguments object)\n\t\t\t\t\tfor (i=0; i < arguments.length; i++){args[i] = arguments[i];}\n\n\t\t\t\t\t// do the actual logging\n\t\t\t\t\t$log[level].apply(null, args);\n\n\t\t\t\t\tif (settings.hideConsole){return;}\n\n\t\t\t\t\t// broadcast to the piConsole directive\n\t\t\t\t\t$rootScope.$emit('console:log',{\n\t\t\t\t\t\ttime: new Date(),\n\t\t\t\t\t\ttype: level,\n\t\t\t\t\t\targs: args,\n\t\t\t\t\t\ttags: this.tags\n\t\t\t\t\t});\n\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n\n\treturn consolePrototypeProvider;\n\n});\n","\ndefine('text!utils/console/console.html',[],function () { return '<div>\\n\\t<div\\n\\t\\tng-repeat=\"log in logs | orderBy:\\'time\\':true\"\\n\\t\\tclass=\"alert\"\\n\\t\\tng-class=\"{\\n\\t\\t\\t\\'alert-warning\\':log.type == \\'warn\\',\\n\\t\\t\\t\\'alert-danger\\':log.type == \\'error\\',\\n\\t\\t\\t\\'alert-info\\':log.type == \\'info\\',\\n\\t\\t\\t\\'alert-success\\':log.type == \\'log\\',\\n\\t\\t\\t\\'alert-success\\':log.type == \\'debug\\'\\n\\n\\t\\t}\"\\n\\t\\trole=\"alert\"\\n\\t>\\n\\t\\t<button ng-click=\"remove(log)\" type=\"button\" class=\"close\" data-dismiss=\"alert\"><span aria-hidden=\"true\">&times;</span><span class=\"sr-only\">Close</span></button>\\n\\t\\t<strong>{{ log.type | uppercase}}:</strong> <i class=\"text-danger\">{{log.time | date : \\'HH:mm:ss:sss\\'}}</i> - <strong>{{log.tags.join(\\' \\')}}</strong>:</br>\\n\\t\\t<span\\n\\t\\t\\tng-repeat=\"arg in log.args track by $index\"\\n\\t\\t\\tng-click=\"pre = !pre\"\\n\\t\\t\\tng-class=\"{pre:pre}\"\\n\\t\\t\\tng-bind-html=\"arg | stringify:pre\"\\n\\t\\t></span>\\n\\n\\t</div>\\n</div>';});\n\n","define('utils/console/consoleDirective',['require','text!./console.html','underscore'],function (require) {\n\t// This is the only way to get a non js file relatively\n\tvar template = require('text!./console.html');\n\tvar _ = require('underscore');\n\n\tdirective.$inject = ['$rootScope'];\n\tfunction directive($rootScope){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\tlink: function(scope) {\n\t\t\t\tvar logs = scope.logs = [];\n\n\t\t\t\tscope.remove = remove;\n\t\t\t\tscope.reverse = true;\n\n\t\t\t\t$rootScope.$on('console:log', function(scope, log){\n\t\t\t\t\tlogs.push(log);\n\t\t\t\t});\n\n\t\t\t\tfunction remove(log){\n\t\t\t\t\tvar index = _.indexOf(logs, log);\n\t\t\t\t\tif (index > -1) {\n\t\t\t\t\t\tlogs.splice(index, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","define('utils/console/consoleModule',['require','angular','./consoleProvider','./consolePrototypeProvider','./consoleDirective'],function(require){\n\tvar angular = require('angular');\n\tvar module = angular.module('piConsole',[]);\n\n\tmodule.service('piConsole', require('./consoleProvider'));\n\tmodule.service('piConsolePrototype', require('./consolePrototypeProvider'));\n\tmodule.directive('piConsole', require('./consoleDirective'));\n\n\tmodule.filter('stringify', function(){\n\t\treturn stringify;\n\t});\n\n\treturn module;\n\n\tfunction stringify(value, pretty) {\n\t\tif (value == null) { // null || undefined\n\t\t\treturn '<i class=\"text-muted\">undefined</i>';\n\t\t}\n\t\tif (value === '') {\n\t\t\treturn '<i class=\"text-muted\">an empty string</i>';\n\t\t}\n\n\t\tswitch (typeof value) {\n\t\t\tcase 'string':\n\t\t\t\tbreak;\n\t\t\tcase 'number':\n\t\t\t\tvalue = '' + value;\n\t\t\t\tbreak;\n\t\t\tcase 'object':\n\t\t\t\t// display the error message not the full thing...\n\t\t\t\tif (value instanceof Error){\n\t\t\t\t\tvalue = value.message;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t/* fall through */\n\t\t\tdefault:\n\t\t\t\tvalue = '<a href=\"javascript:void(0)\">' + angular.toJson(value, !!pretty) + '</a>';\n\t\t}\n\n\t\treturn value;\n\t}\n});\n\n\n\n","\ndefine('text!utils/modal/modal.html',[],function () { return '<div class=\"modal in\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\" aria-hidden=\"true\">\\n\\t<div class=\"modal-dialog\">\\n\\t\\t<div class=\"modal-content\">\\n\\t\\t\\t<div class=\"modal-header\" ng-ifs=\"header\">\\n\\t\\t\\t\\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\" ng-click=\"close()\"><span aria-hidden=\"true\">&times;</span></button>\\n\\t\\t\\t\\t<h4 class=\"modal-title\" id=\"myModalLabel\">{{ header || \"Heads Up!\" }}</h4>\\n\\t\\t\\t</div>\\n\\t\\t\\t<div class=\"modal-body\">{{body}}</div>\\n\\t\\t\\t<div class=\"modal-footer\">\\n\\t\\t\\t\\t<button type=\"button\" class=\"btn btn-default\" ng-click=\"close()\">{{button || \"Close\"}}</button>\\n\\t\\t\\t</div>\\n\\t\\t</div>\\n\\t</div>\\n</div>';});\n\n","define('utils/modal/modalService',['require','underscore','text!./modal.html','angular'],function(require){\n\n\tvar _ = require('underscore');\n\tvar template = require('text!./modal.html');\n\n\tvar angular = require('angular');\n\n\tmodalConstructor.$inject = ['$rootScope', '$rootElement', '$compile', '$q', '$document'];\n\tfunction modalConstructor($rootScope, $rootElement, $compile, $q, $document){\n\t\tvar $element, $scope, deferred;\n\t\tvar $backDrop = angular.element('<div class=\"modal-backdrop in\"/>');\n\n\t\tthis.open = modalOpener;\n\t\tthis.close = modalCleanup;\n\n\t\tfunction modalCleanup(){\n\t\t\tif ($element){\n\t\t\t\t$element.remove();\n\t\t\t}\n\n\t\t\tif ($scope){\n\t\t\t\t$scope.$destroy();\n\t\t\t}\n\n\t\t\tif (deferred){\n\t\t\t\tdeferred.resolve();\n\t\t\t}\n\n\t\t\t$backDrop.remove();\n\t\t\t$document.off('keydown', modalCleanup);\n\t\t\t$rootElement.removeClass('modal-open');\n\t\t}\n\n\t\tfunction modalOpener(options){\n\t\t\tvar context = options.context || {};\n\n\t\t\t// close any existing modals\n\t\t\tmodalCleanup();\n\n\t\t\t// create deferred\n\t\t\tdeferred = $q.defer();\n\n\t\t\t// create new scope\n\t\t\t$scope = (options.$scope || $rootScope).$new();\n\t\t\t// set up scope methods\n\t\t\t$scope.close = modalCleanup;\n\t\t\t$document.on('keydown', modalCleanup);\n\n\n\t\t\t// set scope texts + template\n\t\t\t$scope.header = _.template(options.header)(context);\n\t\t\t$scope.body = _.template(options.body)(context);\n\t\t\t$scope.button = _.template(options.button)(context);\n\n\t\t\t// create new element\n\t\t\t$element = angular.element(template);\n\t\t\t$rootElement.addClass('modal-open');\n\n\t\t\t// compile and activate\n\t\t\t$rootElement.prepend($backDrop);\n\t\t\t$rootElement.prepend($element);\n\t\t\t$compile($element.contents())($scope);\n\t\t\t$scope.$digest();\n\n\t\t\treturn deferred.promise;\n\t\t}\n\n\t\tfunction onEsc(e){\n\t\t\tvar which = e.which || e.keyCode;\n\n\t\t\tif(which == 27) {\n\t\t\t\t$document.one('keydown', skipListener);\n\t        }\n\n\t\t}\n\t}\n\n\treturn modalConstructor;\n\n});\n","define('utils/modal/modalModule',['require','angular','./modalService'],function(require){\n\n\tvar angular = require('angular');\n\tvar module = angular.module('pi.modal',[]);\n\n\tmodule.service('piModal', require('./modalService'));\n\n\treturn module;\n});\n","/**\n * This is the default controller for all questions.\n * It exposes the local scope, and a `value` method that the harvester can use.\n */\n\ndefine('quest/directives/questController',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tquestController.$inject = ['$scope', 'timerStopper', '$parse', '$attrs','piConsole', 'piInvoke', '$rootScope'];\n\tfunction questController($scope, Stopper, $parse, $attr, piConsole, invoke, $rootScope){\n\t\tvar self = this;\n\t\tvar log;\n\t\tvar data;\n\t\tvar defaults = {\n\t\t\tdflt: NaN,\n\t\t\tdata: $scope.data\n\t\t};\n\n\t\tthis.scope = $scope;\n\t\tthis.stopper = new Stopper();\n\n\n\t\tthis.registerModel = registerModel;\n\n\t\t/**\n\t\t * Listen for quest events\n\t\t */\n\t\t$scope.$on('quest:submit', function(event){\n\t\t\tevent.preventDefault();\n\t\t\tlog.declined = undefined;\n\t\t\tlog.submitLatency = self.stopper.now();\n\t\t\tinvoke(data.onSubmit, {log:log});\n\t\t});\n\n\t\t$scope.$on('quest:decline', function(event){\n\t\t\tevent.preventDefault();\n\t\t\tlog.declined = true;\n\t\t\tlog.submitLatency = self.stopper.now();\n\t\t\tinvoke(data.onDecline, {log:log});\n\t\t});\n\n\t\t$scope.$on('quest:timeout', function(event){\n\t\t\tevent.preventDefault();\n\t\t\tlog.timeout = true;\n\t\t\tinvoke(data.onTimeout, {log:log});\n\t\t});\n\n\n\t\t/**\n\t\t * Get the model and options from the directive\n\t\t * @param  {Object} ngModel\n\t\t * @param  {Object} options\n\t\t */\n\t\tfunction registerModel(ngModel, options){\n\t\t\toptions = _.defaults(options || {}, defaults);\n\t\t\tdata = options.data;\n\n\t\t\tvar ngModelGet = $parse($attr.ngModel);\n\t\t\tvar dfltValue = data.hasOwnProperty('dflt') ? data.dflt : options.dflt;\n\n\t\t\t// make model accesable from within scope\n\t\t\t$scope.model = ngModel;\n\n\t\t\t// has to be evaluated in the context of the parent scope because we're assuming that the quest directives have an isolated scope\n\t\t\tlog = ngModelGet($scope.$parent);\n\n\t\t\t// init log\n\t\t\t// ********\n\t\t\t// create log if it doesn't exist yet\n\t\t\tif (_.isUndefined(log)){\n\t\t\t\tlog = {};\n\t\t\t\tngModelGet.assign($scope.$parent, log);\n\t\t\t} else {\n\t\t\t\tpiConsole(['question']).warn('This question has already been in use: \"' + log.name + '\"');\n\t\t\t}\n\n\t\t\t// expose all the stuff...\n\t\t\tself.log = ngModel.$modelValue = log;\n\n\t\t\t_.defaults(log,{\n\t\t\t\tname: data.name,\n\t\t\t\tresponse: dfltValue,\n\t\t\t\t// @TODO: this is a bit fragile and primitive.\n\t\t\t\t// besides, who says this is where \"current\" will be...\n\t\t\t\t// we should probably create a unique ID service of some sort...\n\t\t\t\t// maybe just grab it off of rootscope\n\t\t\t\tserial: _.size($rootScope.current && $rootScope.current.questions)\n\t\t\t});\n\n\t\t\t$scope.response = ngModel.$viewValue = log.response;\n\n\t\t\t// model --> view\n\t\t\t// should probably never be called (since our model is an object and not a primitive)\n\t\t\tngModel.$formatters.push(function(modelValue) {\n\t\t\t\treturn modelValue.response;\n\t\t\t});\n\n\t\t\t// view --> model\n\t\t\tngModel.$parsers.push(function(viewValue){\n\t\t\t\t// don't know exactly why this is needed!\n\t\t\t\t// probably has to do with our use of nested ng-module\n\t\t\t\tif (_.isUndefined(viewValue)){\n\t\t\t\t\treturn log;\n\t\t\t\t}\n\t\t\t\tvar latency = self.stopper.now();\n\n\t\t\t\tlog.response = viewValue;\n\t\t\t\tlog.latency = latency;\n\n\t\t\t\t// if this is the first change\n\t\t\t\tif (!log.pristineLatency){\n\t\t\t\t\tlog.pristineLatency = latency;\n\t\t\t\t}\n\n\t\t\t\treturn log;\n\t\t\t});\n\n\t\t\t$scope.$watch('response',function(newValue, oldValue /*, scope*/){\n\t\t\t\tif (!_.isEqual(newValue, oldValue)){\n\t\t\t\t//if (newValue !== oldValue){\n\t\t\t\t\tngModel.$setViewValue(newValue);\n\t\t\t\t\tinvoke(data.onChange, {log:log});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$scope.$on('$destroy', function(){\n\t\t\t\tinvoke(data.onDestroy, {log:log});\n\t\t\t});\n\n\t\t\tif (data.correct) {\n\t\t\t\tngModel.$parsers.push(correctValidator);\n\t\t\t\tdata.response = correctValidator(this.log);\n\t\t\t}\n\n\t\t\tinvoke(data.onCreate, {log:log});\n\n\t\t\tfunction correctValidator(value) {\n\t\t\t\tvar response = value.response;\n\t\t\t\tvar correctValue = data.correctValue;\n\n\t\t\t\t// make sure numbers are always treated as strings\n\t\t\t\t_.isNumber(correctValue) && (correctValue+=\"\");\n\t\t\t\t_.isNumber(response) && (response+=\"\");\n\n\t\t\t\tif (_.isEqual(correctValue, response)) {\n\t\t\t\t\tngModel.$setValidity('correct', true);\n\t\t\t\t} else {\n\t\t\t\t\tngModel.$setValidity('correct', false);\n\t\t\t\t\t//value.response = dfltValue;\n\t\t\t\t}\n\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t}\n\t}\n\n\treturn questController;\n});\n","\ndefine('text!quest/directives/piQuest/piQuest.html',[],function () { return '<div piq-page ng-module=\"page\"></div>';});\n\n","/**\n * Main tag for piQuest component.\n * All you need in order to use it is set a script in the $rootScope and insert the tag.\n *\n * This directive is responsible for:\n *\t\t1. Creating the task object.\n *\t\t2. Relaying pages from the sequence to piqPage.\n *\t\t3. For now, deal with the end of a task (redirect, callback, broadcast etc. - later this should move into the task)\n *\n * @name piQuest\n\t*/\ndefine('quest/directives/piQuest/piQuest-directive',['require','underscore','text!./piQuest.html','angular'],function (require) {\n\tvar _ = require('underscore');\n\tvar template = require('text!./piQuest.html');\n\tvar jqLite = require('angular').element;\n\n\tpiQuestCtrl.$inject = ['$scope','$rootScope','Task','templateDefaultContext', 'mixerDefaultContext'];\n\tfunction piQuestCtrl($scope, $rootScope, Task, templateDefaultContext, mixerDefaultContext){\n\t\tvar self = this;\n\t\tvar task = self.task = new Task($scope.script);\n\t\tvar defaultContext; // for templates and the mixer\n\t\tvar global = $rootScope.global; // setup in app.run\n\t\tvar current = $rootScope.current || {}; // setup in taskDirective\n\n\t\tcurrent.questions = {};\n\n\t\t// create default context\n\t\tdefaultContext = {\n\t\t\tglobal: global,\n\t\t\tcurrent: current,\n\t\t\tquestions: current.questions\n\t\t};\n\n\t\t// set default contexts\n\t\t_.extend(templateDefaultContext,defaultContext);\n\t\t_.extend(mixerDefaultContext,defaultContext);\n\n\t\t// setup the first page\n\t\ttask.next();\n\n\t\t$scope.$on('quest:next', next);\n\t\t$scope.$on('quest:prev', prev);\n\n\t\t$scope.$on('quest:log', function(event, log, pageData){\n\t\t\ttask.log(log, pageData, $scope.global);\n\t\t});\n\n\t\tfunction next(event, target){\n\t\t\ttask.next(target);\n\t\t\t$scope.$emit('quest:newPage');\n\t\t}\n\n\t\tfunction prev(event, target){\n\t\t\ttask.prev(target);\n\t\t\t$scope.$emit('quest:newPage');\n\t\t}\n\n\t}\n\n\tdirective.$inject = ['$compile', '$animate','$injector','piConsole'];\n\tfunction directive($compile, $animate, $injector, piConsole){\n\t\treturn {\n\t\t\tcontroller: piQuestCtrl,\n\t\t\tterminal:true,\n\t\t\tpriority: 500,\n\t\t\tlink: function(scope, parentElement, attr, ctrl) {\n\t\t\t\tvar task = ctrl.task,\n\t\t\t\t\tcurrentScope,\n\t\t\t\t\tcurrentElement,\n\t\t\t\t\tpreviousElement;\n\n\t\t\t\tscope.$on('quest:refresh', refresh); // just refresh the object\n\t\t\t\tscope.$on('quest:newPage', newPage); // new element, new object and animation\n\t\t\t\tnewPage();\n\n\t\t\t\tfunction cleanupLastPage() {\n\t\t\t\t\tif(previousElement) {\n\t\t\t\t\t\tpreviousElement.remove();\n\t\t\t\t\t\tpreviousElement = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(currentScope) {\n\t\t\t\t\t\tcurrentScope.$destroy();\n\t\t\t\t\t\tcurrentScope = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(currentElement) {\n\t\t\t\t\t\t$animate.leave(currentElement, function() {\n\t\t\t\t\t\t\tpreviousElement = null;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpreviousElement = currentElement;\n\t\t\t\t\t\tcurrentElement = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction newPage(){\n\t\t\t\t\tvar page = task.current();\n\n\t\t\t\t\tif (page){\n\t\t\t\t\t\tvar newScope = scope.$new();\n\t\t\t\t\t\tvar tempElm = jqLite(template); // create a new element here so we can add the animation classes before linking\n\n\t\t\t\t\t\tnewScope.page = page;\n\t\t\t\t\t\taddAnimations(tempElm, page.animate);\n\n\t\t\t\t\t\t// first send away the previous element (if it exists)\n\t\t\t\t\t\tcleanupLastPage();\n\n\t\t\t\t\t\t// enter: new element\n\t\t\t\t\t\tcurrentElement = $compile(tempElm)(newScope);\n\n\t\t\t\t\t\t$animate.enter(currentElement, parentElement);\n\n\t\t\t\t\t\tcurrentScope = newScope;\n\t\t\t\t\t\tcurrentScope.$emit('quest:updated');\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcleanupLastPage();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction refresh(){\n\t\t\t\t\tcurrentScope.page = task.current();\n\t\t\t\t}\n\n\t\t\t\tfunction addAnimations(element, animationsStr){\n\t\t\t\t\tif (!animationsStr){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar animations = animationsStr.split(\" \");\n\n\t\t\t\t\t_.each(animations, function(animation){\n\t\t\t\t\t\t// Make sure that this animation exists\n\t\t\t\t\t\tif (!$injector.has(\".\" + animation + '-animation')){\n\t\t\t\t\t\t\tpiConsole(['page','animation']).error('Unknown animation type: \"' + animation + '\"');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t\telement.addClass(animationsStr);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/piQuest/piqPage.html',[],function () { return '<div ng-form name=\"pageForm\" pi-timer>\\n\\t<div pi-timer=\"page.timer\"></div>\\n\\t<div ng-if=\"page.progressBar\" class=\"text-center\" ng-bind-html=\"page.progressBar\"></div>\\n\\t<h3 ng-if=\"page.header\" ng-bind-html=\"page.header\" ng-style=\"page.headerStyle\"></h3>\\n\\t<div ng-bind-html=\"page.text\"></div>\\n\\t<ol ng-class=\"{\\'list-unstyled\\':!page.numbered}\" start=\"{{page.numberStart}}\">\\n\\t\\t<li ng-repeat=\"quest in page.questions\">\\n\\t\\t\\t<div quest-wrapper quest-data=\"quest\" quest-current=\"current\"></div>\\n\\t\\t</li>\\n\\t</ol>\\n\\n\\t<div class=\"pull-right\" ng-class=\"{\\'btn-group\\': !page.v1style, \\'btn-toolbar\\': page.v1style}\">\\n\\t\\t<button\\n\\t\\t\\tng-click=\"prev()\"\\n\\t\\t\\tdata-role=\"submit\"\\n\\t\\t\\tclass=\"btn\"\\n\\t\\t\\tng-if=\"page.prev && page.$meta.number > 1\"\\n\\t\\t>{{page.prevText || \"Go Back\"}}</button>\\n\\n\\t\\t<button\\n\\t\\t\\tng-click=\"submit()\"\\n\\t\\t\\tdata-role=\"submit\"\\n\\t\\t\\tclass=\"btn btn-primary\"\\n\\t\\t\\tng-if=\"!page.noSubmit\"\\n\\t\\t>{{page.submitText || \"Submit\"}}</button>\\n\\n\\t\\t<button\\n\\t\\t\\tng-click=\"decline($event)\"\\n\\t\\t\\tdata-role=\"submit\"\\n\\t\\t\\tclass=\"btn btn-warning\"\\n\\t\\t\\tng-class=\"{\\'btn-active-accented\\':page.v1style}\"\\n\\t\\t\\tng-if=\"page.decline\"\\n\\t\\t>{{page.declineText || \"Decline to Answer\"}}</button>\\n\\t</div>\\n</div>';});\n\n","/**\n * Main tag for piqPage component.\n * Used automaticaly from within the piQuest directive.\n *\n * This directive is responsible for:\n * 1. Displaying page questions.\n * 2. Detecting the end of a page (submit, TO).\n * 3. Harvesting information from the questions.\n * 4. Suplying information to the logger.\n *\n * @name piqPage\n  */\ndefine('quest/directives/piQuest/piqPage-directive',['require','text!./piqPage.html','underscore','angular'],function (require) {\n\tvar template = require('text!./piqPage.html');\n\tvar _ = require('underscore');\n\tvar angular = require('angular');\n\n\tpiqPageCtrl.$inject = ['$scope','$timeout', '$rootScope', 'piModal'];\n\tfunction piqPageCtrl($scope,$timeout, $rootScope, piModal){\n\t\tvar self = this;\n\n\t\t$scope.global = $rootScope.global;\n\t\t$scope.current = $rootScope.current;\n\n\t\t/**\n\t\t * Harvest piqPage questions, and log them.\n\t\t * by default logging is deferred to the end (so that we can go back to questions...)\n\t\t * This can be changed by setting lognow to true (page.lognow)\n\t\t */\n\t\tthis.harvest = function(lognow){\n\t\t\tvar questions = $scope.current.questions;\n\n\t\t\t_.each($scope.page.questions, function(q){\n\t\t\t\t// don't log if we don't have a name or if lognow is'nt true\n\t\t\t\tif (!q.name || !(lognow || q.lognow)){return;}\n\n\t\t\t\t// get the appropriate log object\n\t\t\t\tvar log = questions[q.name];\n\n\t\t\t\t// don't log if this has already been logged\n\t\t\t\tif (log.$logged){return;}\n\n\t\t\t\t// emit to quest directive\n\t\t\t\t$scope.$emit('quest:log', log, self.log);\n\t\t\t\tlog.$logged = true;\n\t\t\t});\n\t\t};\n\n\t\t/**\n\t\t * Proceed to next page.\n\t\t *\n\t\t * @name submit\n\t\t * @param  {Boolean} skipValidation [Should skip validation of the form before submitting?]\n\t\t */\n\t\t$scope.submit = function(skipValidation){\n\t\t\tvar valid = $scope.pageForm.$valid;\n\n\t\t\t// mark this attempt for submitting\n\t\t\t// useful for validation...\n\t\t\t$scope.submitAttempt = true;\n\n\t\t\tif (!valid && skipValidation !== true){\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\t// broadcast to the quest controller\n\t\t\t// so that it can set submit latency\n\t\t\t$scope.$broadcast('quest:submit');\n\n\t\t\tself.proceed();\n\n\t\t\t// emit to the piQuest directive so that it knows to advance to the next page\n\t\t\t$scope.$emit('quest:next');\n\t\t};\n\n\t\t/**\n\t\t * Decline to answer. mark all questions on this page as declined\n\t\t */\n\t\t$scope.decline = function($event){\n\t\t\tvar $el = angular.element($event.target);\n\t\t\tvar notDoubleClick = (this.page.decline !== 'double');\n\n\t\t\t// decline and proceed to next page\n\t\t\t// unless this is a double style decline and then simply set \"active\".\n\t\t\tif (notDoubleClick || $el.hasClass('active')){\n\t\t\t\t// broadcast to the quest controller (so that it marks logs as declined and marks decline time)\n\t\t\t\t$scope.$broadcast('quest:decline');\n\t\t\t\tself.proceed();\n\t\t\t\t$scope.$emit('quest:next');\n\t\t\t} else {\n\t\t\t\t$el.addClass('active');\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Go back to previous page.\n\t\t */\n\t\t$scope.prev = function(){\n\t\t\t// broadcast to the quest controller\n\t\t\tself.proceed();\n\t\t\t$scope.$broadcast('quest:prev');\n\t\t};\n\n\n\t\t/**\n\t\t * Wraps up page setup\n\t\t * Closes timer stuff.\n\t\t * Harvests if needed.\n\t\t */\n\t\tthis.proceed = function(){\n\n\t\t\t// remove timeout if needed\n\t\t\tself.timer.stop();\n\n\t\t\t// by default, harvest after every page..\n\t\t\tself.harvest($scope.page.lognow);\n\t\t};\n\n\t\tthis.setup = pageSetup;\n\n\t\t// refresh page on question change (deep watch)\n\t\t// should refresh this directive without animating the whole page in...\n\t\t$scope.$watch('current.questions', pageRefresh, true);\n\n\t\t// listen for auto submit calls (from textDirective etc.)\n\t\t$scope.$on('quest:submit:now', function(){\n\t\t\t$scope.submit();\n\t\t});\n\n\t\t// refresh $scope.page\n\t\t// indirectly triggers pageSetup\n\t\tfunction pageRefresh(){\n\t\t\t$scope.$emit('quest:refresh');\n\t\t}\n\n\t\tfunction pageSetup(timer){\n\t\t\tvar newPage = $scope.page;\n\t\t\tself.timer = timer;\n\n\t\t\t// set the page log object\n\t\t\tself.log = {\n\t\t\t\tname: newPage.name,\n\t\t\t\tstartTime: +new Date()\n\t\t\t};\n\n\t\t\t// If there is a timeout set, submit when it runs out.\n\t\t\tif (newPage.timer){\n\t\t\t\ttimer.start(newPage.timer);\n\t\t\t\ttimer.getScope().$on('timer-end', timerEnd);\n\t\t\t}\n\n\t\t\tfunction timerEnd(){\n\t\t\t\tvar message = newPage.timer.message; // timer must be defined to get here...\n\t\t\t\tvar context;\n\t\t\t\t// mark logs as timeout\n\t\t\t\tself.log.timeout = true;\n\t\t\t\t$scope.$broadcast('quest:timeout');\n\n\t\t\t\t// proceed\n\t\t\t\tif (message){\n\t\t\t\t\t// create context for message tempates\n\t\t\t\t\tcontext = {\n\t\t\t\t\t\tpagesMeta: newPage.$meta,\n\t\t\t\t\t\tpagesData: newPage.data,\n\t\t\t\t\t\tglobal: $rootScope.global,\n\t\t\t\t\t\tcurrent: $rootScope.current\n\t\t\t\t\t};\n\n\t\t\t\t\t// create message object out of string\n\t\t\t\t\t_.isString(message) && (message = {body: message});\n\n\t\t\t\t\t// extend message object with scope and context\n\t\t\t\t\t_.defaults(message, {\n\t\t\t\t\t\theader: 'Timer Done',\n\t\t\t\t\t\t$context: context,\n\t\t\t\t\t\t$scope: $scope\n\t\t\t\t\t});\n\n\t\t\t\t\t// activate message and only then proceed\n\t\t\t\t\tpiModal.open(message).then(timerProceed);\n\t\t\t\t} else {\n\t\t\t\t\t// if there is no messgae proceed imidiately\n\t\t\t\t\ttimerProceed();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfunction timerProceed(){\n\t\t\t\tvar submit = newPage.timer.submitOnEnd || _.isUndefined(newPage.timer.submitOnEnd);\n\t\t\t\tsubmit && $scope.submit(true);\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction directive(){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\tcontroller: piqPageCtrl,\n\t\t\ttemplate:template,\n\t\t\trequire: ['piqPage','piTimer'],\n\t\t\tlink: function($scope, $el, $attr, $ctrl){\n\t\t\t\t$ctrl[0].setup($ctrl[1]);\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/wrapper/wrapper.html',[],function () { return '<div class=\"form-group\">\\n\\t<label ng-hide=\"data.inline\" for=\"{{data.name}}\" ng-bind-html=\"data.stem\" ng-style=\"data.stemCss\"></label>\\n\\t<div ng-bind-html=\"data.description\"></div>\\n\\t<div quest-data=\"data\" ng-model=\"current.questions[data.name]\" ng-style=\"{\\'max-width\\':data.maxWidth}\"></div>\\n\\t<p class=\"help-block\" ng-if=\"data.help\" ng-bind-html=\"data.helpText\"></p>\\n</div>';});\n\n","/*\n * The directive for creating the generic question layout (stub, surrounding etc.).\n */\ndefine('quest/directives/wrapper/wrapper-directive',['require','text!./wrapper.html','underscore'],function (require) {\n\n\tvar PREFIX = 'quest';\n\tvar template = require('text!./wrapper.html');\n\tvar _ = require('underscore');\n\n\tfunction capitaliseFirstLetter(string){\n\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\n\t}\n\n\tdirective.$inject = ['$compile', '$injector'];\n\tfunction directive($compile, $injector){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\tpriority: 5, // Allows the wrapper to use the same scope as the questions\n\t\t\tscope:{\n\t\t\t\tdata: '=questData',\n\t\t\t\tcurrent: '=questCurrent'\n\t\t\t},\n\t\t\tlink: function(scope,element) {\n\t\t\t\tvar type = scope.data.type || 'text';\n\t\t\t\tvar questElement = element.children().eq(2);\n\t\t\t\tvar attrName = PREFIX + capitaliseFirstLetter(type);\n\n\t\t\t\t// Make sure that this directive exists\n\t\t\t\tif (!$injector.has(attrName + 'Directive')){\n\t\t\t\t\tthrow new Error ('Unknown question type: \"' + type + '\"');\n\t\t\t\t}\n\n\t\t\t\t// snake case the attr name\n\t\t\t\tattrName = _.kebabCase(attrName);\n\n\t\t\t\t// add the appropriate attribute to the directive and compile it\n\t\t\t\tquestElement.attr(attrName,true);\n\t\t\t\t$compile(questElement)(scope);\n\t\t\t}\n\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/text/text.html',[],function () { return '<div ng-form ng-class=\"{\\'form-inline\\':data.inline}\">\\n\\t<label ng-show=\"data.inline\" for=\"{{data.name}}\" ng-bind-html=\"data.stem\" ng-style=\"data.stemCss\"></label>\\n\\t<input\\n\\t \\ttype=\"text\"\\n\\t\\tng-model=\"response\"\\n\\t\\tng-minlength=\"{{data.minLength || data.minlength}}\"\\n\\t\\tng-maxlength=\"{{data.maxlength}}\"\\n\\t\\tng-pattern=\"data.pattern | toRegex\"\\n\\t\\tng-required=\"{{data.required}}\"\\n\\t\\tclass=\"form-control\"\\n\\t\\tng-attr-style=\"width:{{data.width | dfltUnits}}\"\\n\\n\\t\\tng-keydown=\"data.maxlengthLimit && maxlengthLimit($event)\"\\n\\t\\tng-keyup=\"data.maxlengthLimit && maxlengthLimit($event)\"\\n\\t/>\\n\\t<div pi-quest-validation=\"form.$error.minlength\">{{data.errorMsg.minLength || data.errorMsg.minlength || \"Too short!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.maxlength\">{{data.errorMsg.maxlength || \"Too long!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.pattern\">{{data.errorMsg.pattern || \"wrong pattern!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","\ndefine('text!quest/directives/text/textarea.html',[],function () { return '<div ng-form ng-class=\"{\\'form-inline\\':data.inline}\">\\n\\t<label ng-show=\"data.inline\" for=\"{{data.name}}\" ng-bind-html=\"data.stem\" ng-style=\"data.stemCss\"></label>\\n\\t<textarea\\n\\t \\ttype=\"text\"\\n\\t\\tng-model=\"response\"\\n\\t\\tng-minlength=\"{{data.minLength || data.minlength}}\"\\n\\t\\tng-maxlength=\"{{data.maxlength}}\"\\n\\t\\tng-pattern=\"data.pattern | toRegex\"\\n\\t\\tng-required=\"{{data.required}}\"\\n\\t\\tclass=\"form-control\"\\n\\n\\t\\tng-attr-style=\"resize:none;width:{{data.columns? \\'auto\\' : data.width | dfltUnits}};\"\\n\\t\\tcols=\"{{data.columns}}\"\\n\\t\\trows=\"{{data.rows}}\"\\n\\n\\t\\tng-keydown=\"data.maxlengthLimit && maxlengthLimit($event)\"\\n\\t\\tng-keyup=\"data.maxlengthLimit && maxlengthLimit($event)\"\\n\\t/>\\n\\t<div pi-quest-validation=\"form.$error.minlength\">{{data.errorMsg.minLength || data.errorMsg.minlength || \"Too short!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.maxlength\">{{data.errorMsg.maxlength || \"Too long!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.pattern\">{{data.errorMsg.pattern || \"wrong pattern!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","/*\n * The directive for creating text inputs.\n */\ndefine('quest/directives/text/textDirective',['require','text!./text.html','text!./textarea.html','angular'],function (require) {\n\t// This is the only way to get a non js file relatively\n\tvar textTemplate = require('text!./text.html');\n\tvar textareaTemplate = require('text!./textarea.html');\n\tvar angular = require('angular');\n\n\tfunction textDirective(){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate: function(el,attr){\n\t\t\t\treturn 'questText' in attr ? textTemplate : textareaTemplate;\n\t\t\t},\n\t\t\trequire: ['form', 'ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar form = ctrls[0];\n\t\t\t\tvar ngModel = ctrls[1];\n\t\t\t\tvar ctrl = scope.ctrl;\n\t\t\t\tvar data = scope.data;\n\n\t\t\t\tscope.form = form;\n\t\t\t\tscope.maxlengthLimit = maxlengthLimit;\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: \"\"\n\t\t\t\t});\n\n\t\t\t\tdata.autoSubmit && element.bind(\"keydown keypress\", function (event) {\n\t\t\t\t\tif(event.which === 13) {\n\t\t\t\t\t\tscope.$apply(function(){\n\t\t\t\t\t\t\tscope.$emit('quest:submit:now');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// limit the length of the input string\n\t\t\t\t// essentially a formatter for the input ngModel\n\t\t\t\tfunction maxlengthLimit($event){\n\t\t\t\t\tvar $input = angular.element($event.target);\n\t\t\t\t\tvar response = $input.val();\n\t\t\t\t\tvar limit = data.maxlength || response.length; // in case maxlength isn't defined...\n\t\t\t\t\t// update the scope\n\t\t\t\t\tscope.response = response.slice(0,limit);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\treturn textDirective;\n});\n","\ndefine('text!quest/directives/text/text-number.html',[],function () { return '<div ng-form ng-class=\"{\\'form-inline\\':data.inline}\">\\n\\t<label ng-show=\"data.inline\" for=\"{{data.name}}\" ng-bind-html=\"data.stem\" ng-style=\"data.stemCss\"></label>\\n\\t<input\\n\\t \\ttype=\"number\"\\n\\t\\tng-model=\"response\"\\n\\t\\tng-required=\"{{data.required}}\"\\n\\t\\tclass=\"form-control\"\\n\\t\\tng-attr-style=\"width:{{data.width | dfltUnits}}\"\\n\\t>\\n\\t<div pi-quest-validation=\"form.$error.number\">{{data.errorMsg.number || \"Must be a number!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.qstMin\">{{data.errorMsg.min || \"Too small!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.qstMax\">{{data.errorMsg.max || \"Too big!\"}}</div>\\n\\t<div pi-quest-validation=\"form.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","\n/*\n * The directive for creating textNumber inputs.\n */\ndefine('quest/directives/text/text-number-directive',['require','text!./text-number.html'],function (require) {\n\t// This is the only way to get a non js file relatively\n\tvar template = require('text!./text-number.html');\n\n\tvar directive = function(){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\trequire: ['form', 'ngModel', '^?piqPage'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\n\t\t\t\tvar form = ctrls[0];\n\t\t\t\tvar input = element.find('input');\n\t\t\t\tvar ngModel = input.eq(0).controller('ngModel');\n\n\t\t\t\tscope.form = form;\n\n\t\t\t\tscope.ctrl.registerModel(ctrls[1], {\n\t\t\t\t\tdflt: \"\"\n\t\t\t\t});\n\n\t\t\t\tscope.data.autoSubmit && element.bind(\"keydown keypress\", function (event) {\n\t\t\t\t\tif(event.which === 13) {\n\t\t\t\t\t\tscope.$apply(function(){\n\t\t\t\t\t\t\tscope.$emit('quest:submit:now');\n\t\t\t\t\t\t});\n\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// we have a specific problem with min max that don't take internal\n\t\t\t\t// http://stackoverflow.com/questions/15656617/validation-not-triggered-when-data-binding-a-number-inputs-min-max-attributes\n\t\t\t\tvar minValidator = function(value) {\n\t\t\t\t\tvar min = parseFloat(scope.data.min);\n\t\t\t\t\tif (!isNaN(min) && value < min) {\n\t\t\t\t\t\tngModel.$setValidity('qstMin', false);\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tngModel.$setValidity('qstMin', true);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tngModel.$parsers.push(minValidator);\n\t\t\t\tngModel.$formatters.push(minValidator);\n\n\t\t\t\tvar maxValidator = function(value) {\n\t\t\t\t\tvar max = parseFloat(scope.data.max);\n\t\t\t\t\tif (!isNaN(max) && value > max) {\n\t\t\t\t\t\tngModel.$setValidity('qstMax', false);\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tngModel.$setValidity('qstMax', true);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tngModel.$parsers.push(maxValidator);\n\t\t\t\tngModel.$formatters.push(maxValidator);\n\t\t\t}\n\t\t};\n\t};\n\n\treturn directive;\n});\n","define('quest/directives/select/selectMixerProvider',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\tselectMixerProvider.$inject = ['randomizeShuffle', 'mixerRecursive'];\n\tfunction selectMixerProvider(shuffle, mixer){\n\n\t\tfunction selectMixer(answersArr, options){\n\t\t\tvar answers = mixer(answersArr);\n\n\t\t\t// inject values\n\t\t\tanswers = _.map(answers, function(answer, index){\n\n\t\t\t\tif (!_.isPlainObject(answer)){\n\t\t\t\t\tanswer = {text:answer};\n\t\t\t\t}\n\n\t\t\t\tif (_.isUndefined(answer.value)){\n\t\t\t\t\tanswer.value = options.numericValues ? index + 1 : answer.text;\n\t\t\t\t}\n\t\t\t\treturn answer;\n\t\t\t});\n\n\t\t\tif (options.reverse){\n\t\t\t\tanswers = _(answers).reverse().value();\n\t\t\t}\n\n\t\t\tif (options.randomize){\n\t\t\t\tanswers = shuffle(answers);\n\t\t\t}\n\n\t\t\t_.each(answers, function(answer,index){\n\t\t\t\tanswer.order = index;\n\t\t\t});\n\n\t\t\treturn answers;\n\t\t}\n\n\t\treturn selectMixer;\n\t}\n\n\treturn selectMixerProvider;\n});\n","\ndefine('text!quest/directives/select/dropdown.html',[],function () { return '<div ng-form>\\n\\t<select\\n\\t\\tng-model=\"response\"\\n\\t\\tng-options=\"answer.value as answer.text group by answer.group for answer in quest.answers\"\\n\\t\\tng-required=\"data.required\"\\n\\t\\tng-change=\"data.autoSubmit && autoSubmit($event)\"\\n\\t\\tclass=\"form-control\"\\n\\t\\t>\\n\\t\\t<option value=\"\">{{chooseText || \"-- Choose an option --\"}}</option>\\n\\t</select>\\n\\t<div pi-quest-validation=\"model.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","/*\n * The directive for creating dropdown inputs.\n * scope.response is the value of the chosen response\n */\ndefine('quest/directives/select/dropdownDirective',['require','text!./dropdown.html'],function (require) {\n\n\t// This is the only way to get a non js file relatively\n\tvar template = require('text!./dropdown.html');\n\n\tdirective.$inject = ['questSelectMixer','$timeout'];\n\tfunction directive(mixer,$timeout){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\trequire: ['ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar ctrl = scope.ctrl;\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: NaN\n\t\t\t\t});\n\n\t\t\t\t// render quest if needed\n\t\t\t\tscope.quest = {\n\t\t\t\t\tanswers: mixer(scope.data.answers || [], scope.data)\n\t\t\t\t};\n\n\t\t\t\t// createChooseText\n\t\t\t\tscope.chooseText = \"chooseText\" in scope.data && scope.data.chooseText;\n\n\t\t\t\t/**\n\t\t\t\t * Manage auto submit\n\t\t\t\t */\n\t\t\t\tscope.autoSubmit = function(){\n\t\t\t\t\t$timeout(function(){\n\t\t\t\t\t\tscope.$emit('quest:submit:now');\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/select/selectOne.html',[],function () { return '<div>\\n\\t<div ng-class=\"listClass\" ng-style=\"listCss\">\\n\\t\\t<!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\\'t add a $$hashkey property -->\\n\\t\\t<!-- using interpolation within class, so that we can keep the style info separate within the directive -->\\n\\t\\t<a\\n\\t\\t\\ttabindex=\"-1\"\\n\\t\\t\\tng-repeat=\"answer in quest.answers track by answer.order\"\\n\\t\\t\\tng-model=\"$parent.responseObj\"\\n\\t\\t\\tbtn-radio=\"answer\"\\n\\t\\t\\tng-class=\"$parent.listItemClass\"\\n\\t\\t\\tng-style=\"listItemCss\"\\n\\t\\t\\tclass=\"{{ $parent.response == answer.value ? \\'active\\' : \\'\\' }}\"\\n\\t\\t\\tuncheckable\\n\\t\\t\\tng-click=\"data.autoSubmit && autoSubmit($event)\"\\n\\t\\t\\tng-bind-html=\"answer.text\"\\n\\t\\t\\tunselectable=\"on\"\\n\\t\\t></a>\\n\\t</div>\\n\\t<div pi-quest-validation=\"model.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","/*\n * The directive for creating selectOne inputs.\n *\n * scope.response is the value of the chosen response\n * scope.responseObj is the full answer object or undefined\n */\ndefine('quest/directives/select/selectOneDirective',['require','angular','underscore','text!./selectOne.html'],function (require) {\n\n\tvar angular = require('angular');\n\tvar _ = require('underscore');\n\tvar template = require('text!./selectOne.html');\n\n\tdirective.$inject = ['questSelectMixer', 'buttonConfig', '$compile'];\n\tfunction directive(mixer, buttonConfig, $compile){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\trequire: ['ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar ctrl = scope.ctrl;\n\t\t\t\tvar data = scope.data;\n\n\t\t\t\t// compile the template (this is currently the only way to use a scope dependent template)\n\t\t\t\telement.html(template);\n\t\t\t\t$compile(element.contents())(scope);\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: NaN\n\t\t\t\t});\n\n\t\t\t\t// render quest if needed\n\t\t\t\tscope.quest = {\n\t\t\t\t\tanswers: mixer(scope.data.answers || [], scope.data)\n\t\t\t\t};\n\n\t\t\t\t// update controller with the response\n\t\t\t\tscope.$watch('responseObj',function(newValue, oldValue){\n\t\t\t\t\tif (newValue === oldValue){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tscope.response = newValue && newValue.value;\n\t\t\t\t});\n\n\t\t\t\t/**\n\t\t\t\t * Required\n\t\t\t\t * Since we don't control the ngModel element any more we need to manually create a required validation\n\t\t\t\t * we don't implement $observe since in our case required is static\n\t\t\t\t */\n\n\t\t\t\tif (scope.data.required){\n\t\t\t\t\tngModel.$formatters.push(requiredValidator);\n\t\t\t\t\tngModel.$parsers.unshift(requiredValidator);\n\t\t\t\t\trequiredValidator(scope.response); // check validity at the begining - without need for change...\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Compute list styles\n\t\t\t\t */\n\n\t\t\t\t// back support for \"buttons\"\n\t\t\t\t// @DEPRICATED\n\t\t\t\tif (scope.data.buttons){\n\t\t\t\t\tscope.data.style = 'horizontal';\n\t\t\t\t} else {\n\t\t\t\t\tscope.data.style == 'horizontal' && (scope.data.buttons = true);\n\t\t\t\t}\n\n\t\t\t\t// some specific css added to the list\n\t\t\t\tscope.listCss = {};\n\t\t\t\tscope.listItemCss = {};\n\n\t\t\t\tswitch (data.style){\n\t\t\t\t\tcase 'horizontal' :\n\t\t\t\t\t\tscope.listClass = 'btn-group btn-group-justified btn-group-lg';\n\t\t\t\t\t\tscope.listItemClass = 'btn btn-select';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'multiButtons':\n\t\t\t\t\t\tscope.listClass = 'btn-toolbar';\n\t\t\t\t\t\tscope.listItemClass = 'btn  btn-select';\n\t\t\t\t\t\tscope.listCss.lineHeight = 2.8;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'list':\n\t\t\t\t\t\t/* fall through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tscope.listClass = 'list-group';\n\t\t\t\t\t\tscope.listItemClass = 'list-group-item';\n\t\t\t\t}\n\n\t\t\t\tdata.minWidth && (scope.listItemCss.minWidth = data.minWidth);\n\n\t\t\t\t/**\n\t\t\t\t * Manage auto submit\n\t\t\t\t * @param  {event} e [description]\n\t\t\t\t */\n\t\t\t\tscope.autoSubmit = function(e){\n\t\t\t\t\tif (!scope.data.autoSubmit){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar isActive = angular.element(e.target).hasClass(buttonConfig.activeClass);\n\n\t\t\t\t\tif (isActive){\n\t\t\t\t\t\t// this whole function happens within a digest cycle, so we don't need to $apply\n\t\t\t\t\t\tscope.$emit('quest:submit:now');\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction requiredValidator(value){\n\t\t\t\t\tvar ctrl = ngModel;\n\t\t\t\t\tif (ctrl.$isEmpty(value)) {\n\t\t\t\t\t\tctrl.$setValidity('required', false);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tctrl.$setValidity('required', true);\n\t\t\t\t\t\treturn value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/select/selectMulti.html',[],function () { return '<div required=\"{{data.required}}\">\\n\\t<div ng-class=\"listClass\" ng-style=\"listCss\">\\n\\t\\t<!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\\'t add a $$hashkey property -->\\n\\t\\t<a\\n\\t\\t\\thref=\"javascript:void(0);\"\\n\\t\\t\\tng-repeat=\"answer in quest.answers track by answer.order\"\\n\\t\\t\\tng-model=\"answer.chosen\"\\n\\t\\t\\tbtn-checkbox\\n\\t\\t\\tng-class=\"$parent.listItemClass\"\\n\\t\\t\\tng-style=\"listItemCss\"\\n\\t\\t\\tclass=\"{{ answer.chosen ? \\'active\\' : \\'\\' }}\"\\n\\t\\t\\tuncheckable\\n\\t\\t\\tng-bind-html=\"answer.text\"\\n\\t\\t\\tunselectable=\"on\"\\n\\t\\t>\\n\\t\\t</a>\\n\\t</div>\\n\\t<div pi-quest-validation=\"model.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n\\t<div pi-quest-validation=\"model.$error.correct\">{{data.errorMsg.correct || \"You must answer the correct answer!\"}}</div>\\n</div>';});\n\n","/*\n * The directive for creating selectMulti inputs.\n */\ndefine('quest/directives/select/selectMultiDirective',['require','underscore','text!./selectMulti.html'],function (require) {\n\tvar _ = require('underscore');\n\n\t// This is the only way to get a non js file relatively\n\tvar template = require('text!./selectMulti.html');\n\n\tdirective.$inject = ['questSelectMixer'];\n\tfunction directive(mixer){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\trequire: ['^?piqPage', 'ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar ctrl = scope.ctrl;\n\t\t\t\tvar ngModel = ctrls[1];\n\t\t\t\tvar data = scope.data;\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: []\n\t\t\t\t});\n\n\t\t\t\tngModel.$isEmpty = function(){\n\t\t\t\t\treturn _.isEmpty(ngModel.$viewValue);\n\t\t\t\t};\n\n\t\t\t\t// render questions\n\t\t\t\tscope.quest = {\n\t\t\t\t\tanswers: mixer(scope.data.answers || [], scope.data)\n\t\t\t\t};\n\n\t\t\t\t// mark the chosen questions\n\t\t\t\t_.each(scope.quest.answers, function(answer){\n\t\t\t\t\t// mark it chosen if\n\t\t\t\t\tif (~_.indexOf(scope.response, answer.value)){\n\t\t\t\t\t\tanswer.chosen = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t/**\n\t\t\t\t * Compute list styles\n\t\t\t\t */\n\n\t\t\t\t// back support for \"buttons\"\n\t\t\t\t// @DEPRICATED\n\t\t\t\tif (scope.data.buttons){\n\t\t\t\t\tscope.data.style = 'horizontal';\n\t\t\t\t} else {\n\t\t\t\t\tscope.data.style == 'horizontal' && (scope.data.buttons = true);\n\t\t\t\t}\n\n\t\t\t\t// some specific css added to the list\n\t\t\t\tscope.listCss = {};\n\t\t\t\tscope.listItemCss = {};\n\n\t\t\t\tswitch (data.style){\n\t\t\t\t\tcase 'horizontal' :\n\t\t\t\t\t\tscope.listClass = 'btn-group btn-group-justified btn-group-lg';\n\t\t\t\t\t\tscope.listItemClass = 'btn btn-select';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'multiButtons':\n\t\t\t\t\t\tscope.listClass = 'btn-toolbar';\n\t\t\t\t\t\tscope.listItemClass = 'btn  btn-select';\n\t\t\t\t\t\tscope.listCss.lineHeight = 2.8;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'list':\n\t\t\t\t\t\t/* fall through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tscope.listClass = 'list-group';\n\t\t\t\t\t\tscope.listItemClass = 'list-group-item';\n\t\t\t\t}\n\n\t\t\t\tdata.minWidth && (scope.listItemCss.minWidth = data.minWidth);\n\n\n\t\t\t\t// update controller with the response\n\t\t\t\tscope.$watch('quest.answers',function(newValue, oldValue){\n\t\t\t\t\tif (newValue === oldValue){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// get chosen answers\n\t\t\t\t\tscope.response = _(newValue)\n\t\t\t\t\t\t.filter(function(answer){return answer.chosen;})\n\t\t\t\t\t\t.pluck('value')\n\t\t\t\t\t\t.value();\n\t\t\t\t},true); // deep watch\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","\ndefine('text!quest/directives/grid/grid.html',[],function () { return '<div ng-form class=\"table-responsive\" ng-class=\"{\\'pi-page-submitted\\':$parent.$parent.submitAttempt}\">\\n\\t<table class=\"table table-hover\">\\n\\t\\t<thead ng-if=\"!data.columnStemHide\">\\n\\t\\t\\t<tr>\\n\\t\\t\\t\\t<th ng-style=\"data.columnStemCss\"></th>\\n\\t\\t\\t\\t<th\\n\\t\\t\\t\\t\\tng-repeat=\"column in columns\"\\n\\t\\t\\t\\t\\tng-bind-html=\"column.stem\"\\n\\t\\t\\t\\t\\tng-style=\"data.columnStemCss\"\\n\\t\\t\\t\\t></th>\\n\\t\\t\\t</tr>\\n\\t\\t</thead>\\n\\t\\t<tbody>\\n\\t\\t\\t<tr\\n\\t\\t\\t\\tng-repeat=\"row in rows\"\\n\\t\\t\\t\\tquest-grid-row=\"row\"\\n\\t\\t\\t\\tquest-grid-data=\"data\"\\n\\t\\t\\t\\tng-model=\"$parent.$parent.current.questions[row.name]\"\\n\\t\\t\\t\\tng-required=\"{{data.required || row.required}}\"\\n\\t\\t\\t></tr>\\n\\t\\t</tbody>\\n\\t</table>\\n\\t<div pi-quest-validation=\"form.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n</div>';});\n\n","define('quest/directives/grid/gridDirective',['require','underscore','text!./grid.html'],function (require) {\n\tvar _ = require('underscore');\n\n\tgridDirective.$inject = ['questShuffle'];\n\tfunction gridDirective(shuffle){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate: require('text!./grid.html'),\n\t\t\trequire: ['ngModel','form'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData',\n\t\t\t\tcurrent: '=questCurrent'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar ctrl = scope.ctrl;\n\t\t\t\tvar data = scope.data;\n\n\t\t\t\tscope.form = ctrls[1];\n\n\t\t\t\tscope.columns = mapColumns(data.columns);\n\t\t\t\tscope.rows = mapRows(data.rows, data);\n\n\t\t\t\tscope.$watchCollection(function getResponses(){\n\t\t\t\t\treturn _.pluck(scope.rows, '$response');\n\t\t\t\t}, function sumResponses(responses){\n\t\t\t\t\tscope.response = _.reduce(responses, function(total, response) {\n\t\t\t\t\t\treturn _.isFinite(response) ? total + response : total;\n\t\t\t\t\t},0);\n\t\t\t\t});\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: 0\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\n\n\t\tfunction mapColumns(columns){\n\t\t\treturn _(columns || [])\n\t\t\t\t.map(objectify)\n\t\t\t\t.each(function setValues(column, index){\n\t\t\t\t\tcolumn.hasOwnProperty('value') || (column.value = index+1);\n\t\t\t\t\tcolumn.hasOwnProperty('type') || (column.type = 'checkbox');\n\t\t\t\t})\n\t\t\t\t.tap(function setReverseValues(columns){\n\t\t\t\t\t_(columns)\n\t\t\t\t\t\t.filter(function(column){return !column.noReverse;}) // ignore columns that shouldn't be reveresed\n\t\t\t\t\t\t.each(function(column, index, columns){\n\t\t\t\t\t\t\tcolumn.reverseValue = columns[columns.length - index - 1].value; // set the value from the mirroring column\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.commit(); // activate chain, since we aren't using _.value here\n\t\t\t\t})\n\t\t\t\t.value();\n\t\t}\n\n\t\tfunction mapRows(rows, data){\n\t\t\treturn _(rows || [])\n\t\t\t\t.map(objectify)\n\t\t\t\t.each(function setRowName(row, index){\n\t\t\t\t\trow.hasOwnProperty('name') || (row.name = data.name + zerofill(index+1,3));\n\t\t\t\t})\n\t\t\t\t.thru(data.shuffle ? shuffle : _.identity)\n\t\t\t\t.value();\n\t\t}\n\n\t\tfunction objectify(target){\n\t\t\treturn _.isPlainObject(target) ? target : {stem:target};\n\t\t}\n\n\t\t/**\n\t\t * Zero fills a number\n\t\t * http://stackoverflow.com/questions/1267283/how-can-i-create-a-zerofilled-value-using-javascript\n\t\t *\n\t\t * WARNING!! fails if n===0\n\t\t *\n\t\t * @param  {Number} n The number to zerofill\n\t\t * @param  {Number} w The width of the fill\n\t\t * @return {String}   Zerofilled number\n\t\t */\n\t\tfunction zerofill(n, w) {\n\t\t\tvar an = Math.abs(n);\n\t\t\tvar digitCount = 1 + Math.floor(Math.log(an) / Math.LN10);\n\t\t\tif (digitCount >= w) {\n\t\t\t\treturn n;\n\t\t\t}\n\t\t\tvar zeroString = Math.pow(10, w - digitCount).toString().substr(1);\n\t\t\treturn n < 0 ? '-' + zeroString + an : zeroString + an;\n\t\t}\n\t}\n\n\treturn gridDirective;\n});\n","\ndefine('text!quest/directives/grid/gridRow.html',[],function () { return '<th\\n\\tscope=\"row\"\\n\\tng-if=\"!data.rowStemHide\"\\n\\tng-bind-html=\"row.stem\"\\n\\tng-style=\"data.rowStemCss\"\\n></th>\\n<td ng-repeat=\"column in $parent.columns\" ng-switch=\"column.type\">\\n\\t<button\\n\\t\\tng-switch-when=\"checkbox\"\\n\\t\\tbtn-radio=\"row.reverse && !column.noReverse ? column.reverseValue : column.value\"\\n\\t\\tng-model=\"$parent.$parent.response\"\\n\\t\\tclass=\"btn btn-default\"\\n\\t\\tuncheckable\\n\\t></button>\\n\\t<div\\n\\t\\tclass=\"text\"\\n\\t\\tng-switch-when=\"text\"\\n\\t\\tng-bind-html=\"row[column.textProperty]\"\\n\\t></div>\\n\\n\\t<div\\n\\t\\tclass=\"cell-labels\"\\n\\t\\tng-if=\"data.cellLabels\"\\n\\t\\tng-bind-html=\"column.stem\"\\n\\t></div>\\n</td>\\n';});\n\n","define('quest/directives/grid/gridRowDirective',['require','text!./gridRow.html'],function (require) {\n\tfunction gridRowDirective(){\n\t\treturn {\n\t\t\ttemplate: require('text!./gridRow.html'),\n\t\t\trequire: ['ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope: {\n\t\t\t\trow: '=questGridRow',\n\t\t\t\tdata: '=questGridData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar ngModel = ctrls[0];\n\t\t\t\tvar ctrl = scope.ctrl;\n\n\t\t\t\tscope.model = ngModel;\n\n\t\t\t\t// keep row updated with response so that we can watch it from the grid directive\n\t\t\t\tscope.$watch('response', function(newVal){\n\t\t\t\t\tscope.row.$response = newVal;\n\t\t\t\t});\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdata: scope.row\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\treturn gridRowDirective;\n});\n","\ndefine('text!quest/directives/slider/slider.html',[],function () { return '<div ng-form>\\n\\t<div\\n\\t\\tpi-slider\\n\\t\\tng-model=\"response\"\\n\\t\\tpi-slider-options=\"data\"\\n\\t\\tng-required=\"{{data.required}}\"\\n\\t></div>\\n\\t<h4 ng-if=\"data.displayValue\" class=\"text-center\"><span class=\"label label-info\">{{ response | number }}</span></h4>\\n\\t<div pi-quest-validation=\"form.$error.required && $parent.$parent.submitAttempt\">{{data.errorMsg.required || \"This field is required!\"}}</div>\\n</div>';});\n\n","define('quest/directives/slider/sliderDirective',['require','underscore','text!./slider.html'],function(require){\n\n\tvar _ = require('underscore');\n\t_;\n\n\n\tsliderDirective.$inject = [];\n\tfunction sliderDirective(){\n\t\treturn {\n\t\t\treplace: true,\n\t\t\ttemplate: require('text!./slider.html'),\n\t\t\trequire: ['form', 'ngModel'],\n\t\t\tcontroller: 'questController',\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tdata: '=questData'\n\t\t\t},\n\t\t\tlink: function(scope, element, attr, ctrls) {\n\t\t\t\tvar form = ctrls[0];\n\t\t\t\tvar ngModel = ctrls[1];\n\t\t\t\tvar ctrl = scope.ctrl;\n\t\t\t\tvar data = scope.data;\n\n\t\t\t\tscope.form = form;\n\n\t\t\t\tctrl.registerModel(ngModel, {\n\t\t\t\t\tdflt: undefined\n\t\t\t\t});\n\n\t\t\t\tdata.autoSubmit && scope.$on('slider:change', function(){\n\t\t\t\t\tscope.$emit('quest:submit:now');\n\t\t\t\t});\n\t\t\t}\n\n\t\t};\n\t}\n\n\treturn sliderDirective;\n});\n","(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define('quest/directives/slider/slider',[], factory);\n    } else {\n        var app = angular.module('pi', []);\n        app.directive('piSlider', factory(root.angular));\n    }\n}(this, function () {\n  var SLIDER_CHANGE_EVENT = 'slider:change';\n\n  sliderDirective.$inject = [\"$document\", \"$sce\"];\n  function sliderDirective($document) {\n    return {\n      scope: {\n        options: '=piSliderOptions'\n      },\n      replace: true,\n      require: 'ngModel',\n      template: ['<div class=\"slider\" ng-mousedown=\"onSliderMouseDown($event)\">',\n            '<div class=\"slider-label-left\">{{options.leftLabel}}</div>',\n            '<div class=\"slider-label-right\">{{options.rightLabel}}</div>',\n            '<div class=\"slider-container\">',\n              '<div class=\"slider-bar\">',\n                '<div class=\"slider-bar-highlight\" ng-style=\"highlightStyle\"></div>',\n              '</div>',\n              '<div class=\"slider-handle\" ng-mousedown=\"onHandleMousedown($event)\" ng-style=\"handleStyle\"></div>',\n            '</div>',\n            '<ul class=\"slider-pips\" ng-if=\"!options.hidePips\">',\n                '<li ng-repeat=\"i in getNumber(steps) track by $index\" ng-style=\"{width: pipWidth + \\'%\\'}\" ng-class=\"{last:$last}\"></li>',\n            '</ul>',\n            '<ul class=\"slider-labels\">',\n                '<li ng-repeat=\"label in labels track by $index\" ng-style=\"{width: labelsWidth + \\'%\\'}\" ng-class=\"{first:$first, last:$last}\">{{label}}</li>',\n            '</ul>',\n          '</div>'].join('\\n'),\n\n      link: function(scope, element, attr, ngModel) {\n        var sliderHandleWidth;\n        var options = scope.options || {};\n\n        sliderHandleWidth = element[0].querySelector('.slider-handle').clientWidth;\n\n        scope.ngModel = ngModel;\n\n        scope.min = options.min || 0;\n        scope.max = options.max || (scope.min + 100);\n        scope.range = scope.max - scope.min;\n\n        scope.steps = options.steps ? options.steps - 1 : 0;\n        scope.pipWidth = options.steps && 100/scope.steps;\n\n        scope.labels = options.labels;\n        scope.labelsWidth = options.labels && 100 / options.labels.length;\n\n        ngModel.$isEmpty = isEmpty;\n        ngModel.$render = renderView;\n        ngModel.$formatters.push(toPercentage);\n        ngModel.$parsers.push(fromPercentage);\n\n        scope.onHandleMousedown = onHandleMousedown;\n        scope.onSliderMouseDown = onSliderMouseDown;\n\n        // helper for ngRepeat\n        // http://stackoverflow.com/questions/16824853/way-to-ng-repeat-defined-number-of-times-instead-of-repeating-over-array\n        scope.getNumber = function getNumber(num){return new Array(num);};\n\n        function setValue(percentage){\n          ngModel.$setViewValue(percentage);\n          ngModel.$render();\n        }\n\n        // limit percenatge by step size\n        function steppedPercentage(percentage){\n          if (!scope.steps || ngModel.$isEmpty(percentage)){\n            return percentage;\n          }\n\n          return Math.round(percentage * scope.steps) / scope.steps;\n        }\n\n        // manage placing the handle as well as the highlight correctly\n        function renderView() {\n          var percentage = steppedPercentage(ngModel.$viewValue);\n          var showHandle = !isNaN(percentage);\n          var handleDisplay = showHandle ? 'block' : 'none';\n          var highlightDisplay = showHandle && options.highlight ? 'block' : 'none';\n          scope.highlightStyle = { right: (100 - percentage * 100) + '%', display: highlightDisplay};\n          scope.handleStyle = { left: (percentage * 100) + '%', display: handleDisplay};\n        }\n\n        // formater model => view\n        function toPercentage(modelValue){\n          // if this isn't a number we can't compute percentage...\n          if (ngModel.$isEmpty(modelValue)){\n            return NaN;\n          }\n\n          // limit model size\n          modelValue = Math.min(Math.max(modelValue, scope.min), scope.max);\n          return (modelValue - scope.min) / scope.range;\n        }\n\n        // parser view => model\n        function fromPercentage(percentage){\n          return +(scope.min + (steppedPercentage(percentage) * scope.range)).toFixed(4);\n        }\n\n        // handle drag\n        function onHandleMousedown(event) {\n          fixEvent(event);\n          var basePercentage, basePosition;\n          event.preventDefault();\n          event.stopPropagation(); // prevent propogation to slider so that change is fired for the beginin of a drag interaction\n          basePosition = event.pageX;\n          basePercentage = ngModel.$viewValue;\n\n          $document.on('mousemove', mouseMove);\n          $document.on('mouseup', mouseUp);\n\n          // drag\n          function mouseMove(event) {\n            fixEvent(event);\n            event.preventDefault();\n            var percentage = basePercentage + (event.pageX - basePosition) / (element.prop('clientWidth') - sliderHandleWidth);\n            // don't allow extending beyond slider size\n            percentage = Math.min(percentage, 1);\n            percentage = Math.max(percentage, 0);\n\n            scope.$apply(function(){\n              setValue(percentage);\n            });\n          }\n\n          // drop\n          function mouseUp() {\n            $document.off('mousemove', mouseMove);\n            $document.off('mouseup', mouseUp);\n            scope.$emit(SLIDER_CHANGE_EVENT, ngModel.$viewValue); // emit only on mouse drop\n          }\n        }\n\n        // slider click\n        function onSliderMouseDown(event){\n          fixEvent(event);\n          event.preventDefault();\n          var sliderWidth = element.prop('clientWidth');\n          var sliderPosition = element[0].getBoundingClientRect().left;\n          var percentage = (event.pageX - sliderPosition - sliderHandleWidth/2) / (sliderWidth - sliderHandleWidth);\n          // don't allow extending beyond slider size\n          percentage = Math.min(percentage, 1);\n          percentage = Math.max(percentage, 0);\n\n          // auto \"$apply\" by ng-mousedown\n          setValue(percentage);\n          scope.$emit(SLIDER_CHANGE_EVENT, ngModel.$viewValue);\n        }\n\n\n      }\n    };\n  }\n\n  return sliderDirective;\n\n  // fix IE8 events (missing pageX) - from jquery\n  function fixEvent(event){\n    var eventDoc, doc, body;\n    // Calculate pageX/Y if missing and clientX/Y available\n    if ( event.pageX == null && event.clientX != null ) {\n      eventDoc = event.target.ownerDocument || document;\n      doc = eventDoc.documentElement;\n      body = eventDoc.body;\n\n      event.pageX = event.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );\n      event.pageY = event.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );\n    }\n  }\n\n  function isEmpty(n){\n    return isNaN(parseFloat(n)) || !isFinite(n);\n  }\n}));\n\n\n\n","define('quest/directives/toRegexFilter',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\ttoRegexFilter.$inject = ['piConsole'];\n\tfunction toRegexFilter($console){\n\t\treturn toRegex;\n\n\t\tfunction toRegex(value) {\n\t\t\tvar err;\n\n\t\t\tif (_.isUndefined(value)){\n\t\t\t\treturn /(?:)/;\n\t\t\t}\n\n\t\t\tif (_.isRegExp(value) || _.isString(value)){\n\t\t\t\treturn new RegExp(value);\n\t\t\t} else {\n\t\t\t\terr = new Error('Question pattern is not a valid regular expression');\n\t\t\t\t$console('text').error(err, value);\n\t\t\t\tthrow err;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn toRegexFilter;\n});\n","define('quest/directives/dfltUnitsFilter',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\treturn function(){\n\t\treturn dfltUnits;\n\t};\n\n\tfunction dfltUnits(value, unit) {\n\t\tvar suffix;\n\n\t\t// if value is empty (unless it equals 0)\n\t\tif (!value && value !== 0 && value !== '0'){\n\t\t\treturn '';\n\t\t}\n\n\t\tif (isNumeric(value)){\n\t\t\tsuffix = _.isUndefined(unit) ? 'px' : String(unit);\n\t\t\treturn value + suffix;\n\t\t}\n\t\treturn value;\n\t}\n\n\t// taken from jquery\n\tfunction isNumeric(obj){\n\t\treturn !_.isArray( obj ) && (obj - parseFloat( obj ) + 1) >= 0;\n\t}\n});\n","define('quest/directives/questDirectivesModule',['require','angular','underscore','utils/timer/timer-module','utils/utils/utilsModule','./buttons/buttons','utils/database/template/templateModule','utils/console/consoleModule','utils/modal/modalModule','./questController','./piQuest/piQuest-directive','./piQuest/piqPage-directive','./wrapper/wrapper-directive','./text/textDirective','./text/textDirective','./text/text-number-directive','./select/selectMixerProvider','./select/dropdownDirective','./select/selectOneDirective','./select/selectMultiDirective','./grid/gridDirective','./grid/gridRowDirective','./slider/sliderDirective','./slider/slider','./toRegexFilter','./dfltUnitsFilter'],function(require){\n\tvar angular = require('angular');\n\tvar _ = require('underscore');\n\n\t// set modules that are requirements for the quest module\n\tvar module = angular.module('questDirectives',[\n\t\trequire('utils/timer/timer-module').name,\n\t\trequire('utils/utils/utilsModule').name,\n\t\trequire('./buttons/buttons').name,\n\t\trequire('utils/database/template/templateModule').name,\n\t\trequire('utils/console/consoleModule').name,\n\t\trequire('utils/modal/modalModule').name\n\t]);\n\n\tmodule.controller('questController', require('./questController'));\n\tmodule.directive('piQuest', require('./piQuest/piQuest-directive'));\n\tmodule.directive('piqPage', require('./piQuest/piqPage-directive'));\n\tmodule.directive('questWrapper', require('./wrapper/wrapper-directive'));\n\n\tmodule.directive('questText', require('./text/textDirective'));\n\tmodule.directive('questTextarea', require('./text/textDirective')); // uses the same directive as questText\n\tmodule.directive('questTextNumber', require('./text/text-number-directive'));\n\n\tmodule.service('questSelectMixer', require('./select/selectMixerProvider'));\n\tmodule.directive('questDropdown',require('./select/dropdownDirective'));\n\tmodule.directive('questSelectOne',require('./select/selectOneDirective'));\n\tmodule.directive('questSelectMulti',require('./select/selectMultiDirective'));\n\n\tmodule.value('questShuffle', _.shuffle); // we already have this in database but I don't want the directives to be too interdependant\n\tmodule.directive('questGrid', require('./grid/gridDirective'));\n\tmodule.directive('questGridRow', require('./grid/gridRowDirective'));\n\n\tmodule.directive('questSlider',require('./slider/sliderDirective'));\n\tmodule.directive('piSlider',require('./slider/slider'));\n\n\t// @TODO: move to utils or something\n\tmodule.config(['$sceProvider', function($sceProvider){\n\t\t$sceProvider.enabled(false);\n\t}]);\n\n\tmodule.directive('piQuestValidation', function(){\n\t\treturn {\n\t\t\treplace:true,\n\t\t\ttransclude: true,\n\t\t\tscope: {unvalid:'=piQuestValidation'},\n\t\t\ttemplate: [\n\t\t\t\t'<div class=\"alert alert-danger\" role=\"alert\" ng-show=\"unvalid\">',\n\t\t\t  \t\t'<span class=\"glyphicon glyphicon-exclamation-sign\" aria-hidden=\"true\"></span>',\n\t\t\t  \t\t'<span ng-transclude></span>',\n\t\t\t\t'</div>'\n\t\t\t].join('')\n\t\t};\n\t});\n\n\t// filters\n\tmodule.filter('toRegex', require('./toRegexFilter'));\n\tmodule.filter('dfltUnits', require('./dfltUnitsFilter'));\n\n\n\treturn module;\n\n\n});\n\n","/*\n *\tThe logger Object\n *\tLogger(settings)\n *\t@param settings: the settings for this logger (defaults to the settings defined on loggerProvider.settings)\n *\tsettings = {\n *\t\tpulse: 34, // after how many objects should we post\n *\t\turl: '/my/url', // where should we post to\n *\t\tmeta: an object that extends each log\n  *\t}\n *\n *\tmethods:\n *\n *\tlog(obj) - add an object to the log stack\n *\t@param obj: any object that we want to log (as long as it is defined)\n *\n *\tsend() - send any remaining objects to the server\n *\n  */\ndefine('utils/logger/LoggerProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tloggerProvider.$inject = ['$http','$q', 'piConsole'];\n\tfunction loggerProvider($http, $q, piConsole){\n\t\tvar self = this;\n\n\t\tfunction Logger(dfltLogFn){\n\t\t\tthis.pending = [];\n\t\t\tthis.sent = [];\n\t\t\tthis.settings = {};\n\t\t\tthis.meta = {};\n\t\t\tthis.suppress = false; // don't suppress send\n\t\t\tthis.dfltLogFn = dfltLogFn || function(a){return a;};\n\t\t}\n\n\t\t_.extend(Logger.prototype, {\n\t\t\tlog: function(){\n\t\t\t\tvar settings = this.settings;\n\t\t\t\tvar logObj = (settings.logFn || this.dfltLogFn).apply(settings, arguments);\n\n\t\t\t\tif (!_.isEmpty(this.meta) && !_.isPlainObject(logObj)){\n\t\t\t\t\tpiConsole(['logger']).debug(logObj);\n\t\t\t\t\tthrow new Error('Logger: in order to use \"meta\" the log must be an object.');\n\t\t\t\t}\n\n\t\t\t\t_.extend(logObj, this.meta);\n\n\t\t\t\t// if debug, then log this object\n\t\t\t\tpiConsole(['logger']).debug('Logged: ', logObj);\n\n\t\t\t\tthis.pending.push(logObj);\n\t\t\t\tself.logCounter++;\n\t\t\t\tif (settings.pulse && !this.suppress && this.pending.length >= settings.pulse){\n\t\t\t\t\tthis.send();\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsend: function(){\n\t\t\t\tvar i;\n\t\t\t\tvar settings = this.settings;\n\t\t\t\tvar sendData = this.pending;\n\t\t\t\tvar def = $q.defer();\n\n\t\t\t\t// if there are no records to send...\n\t\t\t\tif (sendData.length === 0){\n\t\t\t\t\tdef.resolve();\n\t\t\t\t\treturn def.promise;\n\t\t\t\t}\n\n\t\t\t\tif (_.isUndefined(settings.url)){\n\t\t\t\t\tpiConsole('logger').warn('The logger url is not set.');\n\t\t\t\t\tdef.resolve();\n\t\t\t\t\treturn def.promise;\n\t\t\t\t}\n\n\t\t\t\t// empty the pending stack\n\t\t\t\tthis.pending = [];\n\n\t\t\t\t$http.post(settings.url, sendData).then(success, error);\n\n\t\t\t\t// move everything pending to the sent stack\n\t\t\t\tfor (i = 0; i<sendData.length; i++){\n\t\t\t\t\tthis.sent.push(sendData[i]);\n\t\t\t\t}\n\n\t\t\t\treturn def.promise;\n\n\t\t\t\tfunction success(){\n\t\t\t\t\tdef.resolve();\n\t\t\t\t}\n\n\t\t\t\tfunction error(){\n\t\t\t\t\t// try again\n\t\t\t\t\treturn $http.post(settings.url, sendData).then(success, function(){\n\t\t\t\t\t\tpiConsole(['logger']).error('Failed to send data, it seems the backend is not responding. (sending to: \"' + settings.url +'\")');\n\t\t\t\t\t\tdef.reject();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * suppress pulse\n\t\t\t * sets suppress to `suppress`, or to true by default.\n\t\t\t */\n\t\t\tsuppressPulse: function (suppress) {\n\t\t\t\tthis.suppress = _.isUndefined(suppress) ? true : suppress;\n\t\t\t},\n\n\t\t\tgetCount: function(){\n\t\t\t\treturn self.logCounter;\n\t\t\t},\n\n\t\t\tsetSettings: function(settings){\n\t\t\t\tif (arguments.length === 0){\n\t\t\t\t\treturn this.settings;\n\t\t\t\t}\n\n\t\t\t\t// inherit settings both from settings obj, and the global settings\n\t\t\t\tthis.settings = _.defaults({}, settings, self.settings);\n\n\t\t\t\tif (!_.isUndefined(settings.meta) && !_.isPlainObject(settings.meta)){\n\t\t\t\t\tthrow new Error('Logger: \"meta\" must be an object.');\n\t\t\t\t}\n\n\t\t\t\t// inherit meta settings\n\t\t\t\tthis.meta = _.defaults({}, settings.meta, self.meta);\n\t\t\t}\n\t\t});\n\n\t\treturn Logger;\n\t}\n\n\treturn function(){\n\t\tthis.$get = loggerProvider;\n\t\tthis.settings = {};\n\t\tthis.meta = {};\n\t\tthis.logCounter = 0;\n\t};\n});\n","define('utils/logger/logger-module',['require','angular','./LoggerProvider','utils/console/consoleModule'],function(require){\n\tvar angular = require('angular');\n\tvar Logger = require('./LoggerProvider');\n\n\tvar module = angular.module('logger', [require('utils/console/consoleModule').name]);\n\tmodule.provider('Logger', Logger);\n\n\treturn module;\n});\n","/**\n * An assortment of useful randomization functions.\n * Good so we can easily mock them...\n */\ndefine('utils/database/randomize/randomizeModule',['require','angular','underscore'],function(require){\n\tvar angular = require('angular');\n\tvar _ = require('underscore');\n\tvar module = angular.module('randomize', []);\n\n\t/**\n\t * Just plain random\n\t */\n\n\tmodule.value('randomizeRandom', Math.random);\n\n\t/**\n\t * Just lodash shuffle...\n\t */\n\tmodule.value('randomizeShuffle', _.shuffle);\n\n\t/*\n\t * a function that returns a random integer between 0 and length\n\t * @param length: the upper boundary to the randomization.\n\t */\n\tmodule.value('randomizeInt', function randomInt(length){\n\t\treturn Math.floor(Math.random()*length);\n\t});\n\n\t/**\n\t * a function that returns a random array of integers between 0 and length\n\t * @param length: the upper boundary to the randomization.\n\t */\n\tmodule.value('randomizeRange', function randomArr(length){\n\t\treturn _.shuffle(_.range(length));\n\t});\n\n\treturn module;\n});\n","define('utils/database/mixer/mixer',['underscore'],function(_){\n\n\t/**\n\t * A function that maps a mixer object into a sequence.\n\t *\n\t * The basic structure of such an obect is:\n\t * {\n\t *\t\tmixer: 'functionType',\n\t *\t\tremix : false,\n\t *\t\tdata: [task1, task2]\n\t *\t}\n\t *\n\t * The results of the mix are set into `$parsed` within the original mixer object.\n\t * if remix is true $parsed is returned instead of recomputing\n\t *\n\t * @param {Object} [obj] [a mixer object]\n\t * @returns {Array} [An array of mixed objects]\n\t */\n\n\tmixProvider.$inject = ['randomizeShuffle', 'randomizeRandom'];\n\tfunction mixProvider(shuffle, random){\n\n\t\tfunction mix(obj){\n\t\t\tvar mixerName = obj.mixer;\n\n\t\t\t// if this isn't a mixer\n\t\t\t// make sure we catch mixers that are set with undefined by accident...\n\t\t\tif (!(_.isPlainObject(obj) && 'mixer' in obj)){\n\t\t\t\treturn [obj];\n\t\t\t}\n\n\t\t\tif (_.isUndefined(mix.mixers[mixerName])){\n\t\t\t\tthrow new Error('Mixer: unknow mixer type = ' + mixerName);\n\t\t\t}\n\n\t\t\tif (!obj.remix && obj.$parsed) {\n\t\t\t\treturn obj.$parsed;\n\t\t\t}\n\n\t\t\tobj.$parsed = mix.mixers[mixerName].apply(null, arguments);\n\n\t\t\treturn obj.$parsed;\n\t\t}\n\n\t\tmix.mixers = {\n\t\t\twrapper : function(obj){\n\t\t\t\treturn obj.data;\n\t\t\t},\n\n\t\t\trepeat: function(obj){\n\t\t\t\t\tvar sequence = obj.data || [];\n\t\t\t\t\tvar result = [], i;\n\t\t\t\t\tfor (i=0; i < obj.times; i++){\n\t\t\t\t\t\tresult = result.concat(_.clone(sequence,true));\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t},\n\n\t\t\t// randomize any elements\n\t\t\trandom: function(obj, context){\n\n\t\t\t\tfunction randomDeepMixer(sequence){\n\t\t\t\t\treturn _.reduce(sequence, function(arr,value){\n\t\t\t\t\t\tif (_.isPlainObject(value) && 'mixer' in value && value.mixer != 'wrapper'){\n\t\t\t\t\t\t\tvar seq = mix(value, context);\n\t\t\t\t\t\t\treturn arr.concat(seq);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn arr.concat([value]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}, []);\n\t\t\t\t}\n\n\t\t\t\tvar sequence = obj.data || [];\n\t\t\t\treturn shuffle(randomDeepMixer(sequence));\n\t\t\t},\n\n\t\t\tchoose: function(obj){\n\t\t\t\tvar sequence = obj.data || [];\n\t\t\t\treturn _.take(shuffle(sequence), obj.n ? obj.n : 1);\n\t\t\t},\n\n\t\t\tweightedRandom: function(obj){\n\t\t\t\tvar sequence = obj.data || [];\n\t\t\t\tvar i;\n\t\t\t\tvar total_weight = _.reduce(obj.weights,function (prev, cur) {\n\t\t\t\t\treturn prev + cur;\n\t\t\t\t});\n\n\t\t\t\tvar random_num = random() * total_weight; // cutoff - when we reach this sum - we've reached the desired weight\n\t\t\t\tvar weight_sum = 0;\n\n\t\t\t\tfor (i = 0; i < sequence.length; i++) {\n\t\t\t\t\tweight_sum += obj.weights[i];\n\t\t\t\t\tweight_sum = +weight_sum.toFixed(3);\n\n\t\t\t\t\tif (random_num <= weight_sum) {\n\t\t\t\t\t\treturn [obj.data[i]];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error('Mixer: something went wrong with weightedRandom');\n\t\t\t}\n\t\t};\n\n\t\treturn mix;\n\t}\n\n\treturn mixProvider;\n});\n","define('utils/database/mixer/mixerSequential',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmixerSequentialProvider.$inject = ['mixer'];\n\tfunction mixerSequentialProvider(mix){\n\t\tfunction mixerSequential(sequence, context, depth){\n\t\t\tvar mixed;\n\t\t\tvar obj = sequence[0];\n\n\t\t\tdepth = depth || 0;\n\t\t\tif (depth++ >= 10){\n\t\t\t\tthrow new Error('Mixer: the mixer allows a maximum depth of 10');\n\t\t\t}\n\n\t\t\tif (_.isUndefined(obj.mixer)){\n\t\t\t\treturn sequence;\n\t\t\t}\n\n\t\t\t// mix obj\n\t\t\tmixed = mix(obj, context);\n\n\t\t\t// remove obj from sequence\n\t\t\tsequence.shift();\n\n\t\t\t// concat mixed and sequence\n\t\t\tmixed = mixed.concat(sequence);\n\n\t\t\treturn _.isUndefined(mixed[0]) || _.isUndefined(mixed[0].mixer) ? mixed : mixerSequential(mixed, context, depth);\n\t\t}\n\n\t\treturn mixerSequential;\n\t}\n\n\treturn mixerSequentialProvider;\n});\n","define('utils/database/mixer/mixerRecursive',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmixerRecursiveProvider.$inject = ['mixer'];\n\tfunction mixerRecursiveProvider(mix){\n\t\tfunction mixerRecursive(sequence, context, depth){\n\t\t\tvar mixed = [];\n\n\t\t\tdepth = depth || 0;\n\t\t\tif (depth++ >= 10){\n\t\t\t\tthrow new Error('Mixer: the mixer allows a maximum depth of 10');\n\t\t\t}\n\n\t\t\tmixed = _(sequence)\n\t\t\t\t.map(function(obj){\n\n\t\t\t\t\tif (_.isUndefined(obj.mixer)){\n\t\t\t\t\t\treturn obj;\n\t\t\t\t\t}\n\n\t\t\t\t\t// mix object, and recursively mix the result\n\t\t\t\t\treturn mixerRecursive(mix(obj, context), context, depth);\n\t\t\t\t})\n\t\t\t\t.flatten()\n\t\t\t\t.value();\n\n\t\t\treturn mixed;\n\t\t}\n\n\t\treturn mixerRecursive;\n\t}\n\n\treturn mixerRecursiveProvider;\n});\n","define('utils/database/mixer/mixerSequenceProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmixerSequenceProvider.$inject = ['mixer'];\n\tfunction mixerSequenceProvider(mix){\n\n\t\t/**\n\t\t * MixerSequence takes an mixer array and allows browsing back and forth within it\n\t\t * @param {Array} arr [a mixer array]\n\t\t */\n\t\tfunction MixerSequence(arr){\n\t\t\tthis.sequence = arr;\n\t\t\tthis.stack = [];\n\t\t\tthis.add(arr);\n\t\t\tthis.pointer = 0;\n\t\t}\n\n\t\t_.extend(MixerSequence.prototype, {\n\t\t\t/**\n\t\t\t * Add sequence to mixer\n\t\t\t * @param {[type]} arr     Sequence\n\t\t\t * @param {[type]} reverse Whether to start from begining or end\n\t\t\t */\n\t\t\tadd: function(arr, reverse){\n\t\t\t\tthis.stack.push({pointer:reverse ? arr.length : -1,sequence:arr});\n\t\t\t},\n\n\t\t\tproceed: function(direction, context){\n\t\t\t\t// get last subSequence\n\t\t\t\tvar subSequence = this.stack[this.stack.length-1];\n\t\t\t\tvar isNext = (direction === 'next');\n\n\t\t\t\t// if we ran out of sequence\n\t\t\t\t// add the original sequence back in\n\t\t\t\tif (!subSequence) {\n\t\t\t\t\tthrow new Error ('mixerSequence: subSequence not found');\n\t\t\t\t}\n\n\t\t\t\tsubSequence.pointer += isNext ? 1 : -1;\n\n\t\t\t\tvar el = subSequence.sequence[subSequence.pointer];\n\n\t\t\t\t// if we ran out of elements, go to previous level (unless we are on the root sequence)\n\t\t\t\tif (_.isUndefined(el) && this.stack.length > 1){\n\t\t\t\t\tthis.stack.pop();\n\t\t\t\t\treturn this.proceed.call(this,direction,context);\n\t\t\t\t}\n\n\t\t\t\t// if element is a mixer, mix it\n\t\t\t\tif (el && el.mixer){\n\t\t\t\t\tthis.add(mix(el,context), !isNext);\n\t\t\t\t\treturn this.proceed.call(this,direction,context);\n\t\t\t\t}\n\n\t\t\t\t// regular element or undefined (end of sequence)\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tnext: function(context){\n\t\t\t\tthis.pointer++;\n\t\t\t\treturn this.proceed.call(this, 'next',context);\n\t\t\t},\n\n\t\t\tprev: function(context){\n\t\t\t\tthis.pointer--;\n\t\t\t\treturn this.proceed.call(this, 'prev',context);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Return current element\n\t\t\t * should **never** return a mixer - supposed to abstract them away\n\t\t\t * @return {[type]} undefined or element\n\t\t\t */\n\t\t\tcurrent:function(){\n\t\t\t\t// get last subSequence\n\t\t\t\tvar subSequence = this.stack[this.stack.length-1];\n\n\t\t\t\tif (!subSequence) {\n\t\t\t\t\tthrow new Error ('mixerSequence: subSequence not found');\n\t\t\t\t}\n\n\t\t\t\tvar el = subSequence.sequence[subSequence.pointer];\n\n\t\t\t\tif (!el){\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\n\t\t\t\t// extend element with meta data\n\t\t\t\tel.$meta = this.meta();\n\n\t\t\t\treturn el;\n\t\t\t},\n\n\t\t\tmeta: function(){\n\t\t\t\treturn {\n\t\t\t\t\tnumber: this.pointer,\n\n\t\t\t\t\t// sum of sequence length, minus one (the mixer) for each level of stack except the last\n\t\t\t\t\toutOf:  _.reduce(this.stack, function(memo,sub){return memo + sub.sequence.length-1;},0)+1\n\t\t\t\t};\n\t\t\t}\n\n\t\t});\n\n\t\treturn MixerSequence;\n\t}\n\n\treturn mixerSequenceProvider;\n});\n\n\n\n\n\n\n","define('utils/database/mixer/branching/dotNotation',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tfunction dotNotation(chain, obj){\n\n\t\tif (_.isString(chain)){\n\t\t\tchain = chain.split('.');\n\t\t}\n\n\t\treturn _.reduce(chain, function(result, link){\n\n\t\t\tif (_.isPlainObject(result) || _.isArray(result)){\n\t\t\t\treturn result[link];\n\t\t\t}\n\n\t\t\treturn undefined;\n\n\t\t}, obj);\n\t}\n\n\treturn dotNotation;\n});\n","define('utils/database/mixer/branching/mixerDotNotationProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmixerDotNotationProvider.$inject = ['dotNotation'];\n\tfunction mixerDotNotationProvider(dotNotation){\n\n\t\tfunction mixerDotNotation(chain, obj){\n\n\t\t\tvar escapeSeparatorRegex= /[^\\/]\\./;\n\n\t\t\tif (!_.isString(chain)){\n\t\t\t\treturn chain;\n\t\t\t}\n\n\t\t\t// We do not have a non escaped dot: we treat this as a string\n\t\t\tif (!escapeSeparatorRegex.test(chain)){\n\t\t\t\treturn chain.replace('/.','.');\n\t\t\t}\n\n\t\t\treturn dotNotation(chain, obj);\n\t\t}\n\n\t\treturn mixerDotNotation;\n\t}\n\n\treturn mixerDotNotationProvider;\n\n});\n","define('utils/database/mixer/branching/mixerConditionProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmixerConditionProvider.$inject = ['mixerDotNotation', 'piConsole'];\n\tfunction mixerConditionProvider(dotNotation, piConsole){\n\n\t\tfunction mixerCondition(condition, context){\n\t\t\tvar left, right, operator;\n\n\t\t\t// support a condition that is a plain function\n\t\t\tif (_.isFunction(condition)){\n\t\t\t\toperator = condition;\n\t\t\t} else {\n\t\t\t\t// @TODO angular.$parse may be a better candidate for doing this...\n\t\t\t\tleft = dotNotation(condition.compare,context);\n\t\t\t\tright = dotNotation(condition.to,context);\n\t\t\t\toperator = condition.operator;\n\t\t\t}\n\n\t\t\tpiConsole(['conditions']).info('Condition: ', left, operator || 'equals', right, condition);\n\n\t\t\tif (_.isFunction(operator)){\n\t\t\t\treturn !! operator.apply(context,[left, right, context]);\n\t\t\t}\n\n\t\t\tswitch(operator){\n\t\t\t\tcase 'greaterThan':\n\t\t\t\t\tif (_.isNumber(left) && _.isNumber(right)){\n\t\t\t\t\t\treturn +left > +right;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\n\t\t\t\tcase 'greaterThanOrEqual':\n\t\t\t\t\tif (_.isNumber(left) && _.isNumber(right)){\n\t\t\t\t\t\treturn +left >= +right;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\n\t\t\t\tcase 'in':\n\t\t\t\t\tif (_.isArray(right)){\n\t\t\t\t\t\t// binary operator to turn indexOf into binary.\n\t\t\t\t\t\treturn ~_.indexOf(right, left);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\n\t\t\t\tcase 'exactly':\n\t\t\t\t\treturn left === right;\n\n\t\t\t\tcase 'equals':\n\t\t\t\t\t/* falls through */\n\t\t\t\tdefault:\n\t\t\t\t\tif (_.isUndefined(right)){\n\t\t\t\t\t\treturn !!left;\n\t\t\t\t\t}\n\t\t\t\t\treturn _.isEqual(left, right);\n\t\t\t}\n\n\t\t\treturn operator;\n\t\t}\n\n\t\treturn mixerCondition;\n\t}\n\n\treturn mixerConditionProvider;\n});\n","define('utils/database/mixer/branching/mixerEvaluateProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tevaluateProvider.$inject = ['mixerCondition'];\n\tfunction evaluateProvider(condition){\n\t\t/**\n\t\t * Checks if a conditions set is true\n\t\t * @param  {Array} conditions [an array of conditions]\n\t\t * @param  {Object} context   [A context for the condition checker]\n\t\t * @return {Boolean}          [Are these conditions true]\n\t\t */\n\n\t\tfunction evaluate(conditions,context){\n\t\t\t// make && the default\n\t\t\t_.isArray(conditions) && (conditions = {and:conditions});\n\n\t\t\tfunction test(cond){return evaluate(cond,context);}\n\n\t\t\t// && objects\n\t\t\tif (conditions.and){\n\t\t\t\treturn _.every(conditions.and, test);\n\t\t\t}\n\t\t\tif (conditions.nand){\n\t\t\t\treturn !_.every(conditions.nand, test);\n\t\t\t}\n\n\t\t\t// || objects\n\t\t\tif (conditions.or){\n\t\t\t\treturn _.some(conditions.or, test);\n\t\t\t}\n\t\t\tif (conditions.nor){\n\t\t\t\treturn !_.some(conditions.nor, test);\n\t\t\t}\n\n\t\t\treturn condition(conditions, context);\n\t\t}\n\n\t\treturn evaluate;\n\t}\n\n\treturn evaluateProvider;\n});\n","/**\n * Registers the branching mixers with the mixer\n * @return {function}         [mixer decorator]\n */\ndefine('utils/database/mixer/branching/mixerBranchingDecorator',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\tmixerBranchingDecorator.$inject = ['$delegate','mixerEvaluate','mixerDefaultContext'];\n\tfunction mixerBranchingDecorator(mix, evaluate, mixerDefaultContext){\n\n\t\tmix.mixers.branch = branch;\n\t\tmix.mixers.multiBranch = multiBranch;\n\n\t\treturn mix;\n\n\t\t/**\n\t\t * Branching mixer\n\t\t * @return {Array}         [A data array with objects to continue with]\n\t\t */\n\t\tfunction branch(obj, context){\n\t\t\tcontext = _.extend(context || {}, mixerDefaultContext);\n\t\t\treturn evaluate(obj.conditions, context) ? obj.data || [] : obj.elseData || [];\n\t\t}\n\n\t\t/**\n\t\t * multiBranch mixer\n\t\t * @return {Array}         [A data array with objects to continue with]\n\t\t */\n\t\tfunction multiBranch(obj, context){\n\t\t\tcontext = _.extend(context || {}, mixerDefaultContext);\n\t\t\tvar row;\n\n\t\t\trow = _.find(obj.branches, function(branch){\n\t\t\t\treturn evaluate(branch.conditions, context);\n\t\t\t});\n\n\t\t\tif (row) {\n\t\t\t\treturn row.data || [];\n\t\t\t}\n\n\t\t\treturn obj.elseData || [];\n\t\t}\n\t}\n\n\treturn mixerBranchingDecorator;\n});\n","define('utils/database/mixer/mixerModule',['require','angular','../randomize/randomizeModule','utils/console/consoleModule','./mixer','./mixerSequential','./mixerRecursive','./mixerSequenceProvider','./branching/dotNotation','./branching/mixerDotNotationProvider','./branching/mixerConditionProvider','./branching/mixerEvaluateProvider','./branching/mixerBranchingDecorator'],function(require){\n\n\tvar angular = require('angular');\n\n\tvar module = angular.module('mixer',[\n\t\trequire('../randomize/randomizeModule').name,\n\t\trequire('utils/console/consoleModule').name\n\t]);\n\n\tmodule.service('mixer', require('./mixer'));\n\tmodule.service('mixerSequential', require('./mixerSequential')); // is this even in use?\n\tmodule.service('mixerRecursive', require('./mixerRecursive')); // is this even in use?\n\tmodule.service('MixerSequence', require('./mixerSequenceProvider'));\n\n\tmodule.value('dotNotation', require('./branching/dotNotation'));\n\tmodule.service('mixerDotNotation', require('./branching/mixerDotNotationProvider'));\n\tmodule.service('mixerCondition', require('./branching/mixerConditionProvider'));\n\tmodule.service('mixerEvaluate', require('./branching/mixerEvaluateProvider'));\n\tmodule.config(['$provide', function($provide){\n\t\t$provide.decorator('mixer', require('./branching/mixerBranchingDecorator'));\n\t}]);\n\tmodule.constant('mixerDefaultContext', {});\n\n\treturn module;\n});\n","define('utils/database/collection/collectionProvider',['underscore'],function(_){\n\t/*\n\t * The constructor for an Array wrapper\n\t */\n\n\tfunction collectionService(){\n\n\t\tfunction Collection (arr) {\n\t\t\tif (arr instanceof Collection) {\n\t\t\t\treturn arr;\n\t\t\t}\n\n\t\t\t// Make sure we are creating this array out of a valid argument\n\t\t\tif (!_.isUndefined(arr) && !_.isArray(arr) && !(arr instanceof Collection)) {\n\t\t\t\tthrow new Error('Collections can only be constructed from arrays');\n\t\t\t}\n\n\t\t\tthis.collection = arr || [];\n\t\t\tthis.length = this.collection.length;\n\n\t\t\t// pointer to the current location within the array\n\t\t\t// we start with -1 so that the initial next points to the begining of the array\n\t\t\tthis.pointer = -1;\n\t\t}\n\n\t\t_.extend(Collection.prototype,{\n\n\t\t\tfirst : function first(){\n\t\t\t\tthis.pointer = 0;\n\t\t\t\treturn this.collection[this.pointer];\n\t\t\t},\n\n\t\t\tlast : function last(){\n\t\t\t\tthis.pointer = this.collection.length - 1;\n\t\t\t\treturn this.collection[this.pointer];\n\t\t\t},\n\n\t\t\tend : function end(){\n\t\t\t\tthis.pointer = this.collection.length;\n\t\t\t\treturn undefined;\n\t\t\t},\n\n\t\t\tcurrent : function(){\n\t\t\t\treturn this.collection[this.pointer];\n\t\t\t},\n\n\t\t\tnext : function(){\n\t\t\t\treturn this.collection[++this.pointer];\n\t\t\t},\n\n\t\t\tprevious : function(){\n\t\t\t\treturn this.collection[--this.pointer];\n\t\t\t},\n\n\t\t\t// add list of items to the collection\n\t\t\tadd : function(list){\n\t\t\t\t// dont allow adding nothing\n\t\t\t\tif (!arguments.length) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t\t// make sure list is as an array\n\t\t\t\tlist = _.isArray(list) ? list : [list];\n\t\t\t\tthis.collection = this.collection.concat(list);\n\n\t\t\t\tthis.length = this.collection.length;\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// return the item at index\n\t\t\tat: function(index){\n\t\t\t\treturn this.collection[index];\n\t\t\t}\n\t\t});\n\n\n\t\t// Stuff we took out of bootstrap that can augment the collection\n\t\t// **************************************************************\n\t\tvar methods = ['where','filter'];\n\t\tvar slice = Array.prototype.slice;\n\n\t\t// Mix in each Underscore method as a proxy to `Collection#models`.\n\t\t_.each(methods, function(method) {\n\t\t\tCollection.prototype[method] = function() {\n\t\t\t\tvar args = slice.call(arguments);\n\t\t\t\targs.unshift(this.collection);\n\t\t\t\tvar coll = _[method].apply(_,args);\n\t\t\t\treturn new Collection(coll);\n\t\t\t};\n\t\t});\n\n\t\treturn Collection;\n\t}\n\n\treturn collectionService;\n\n\n});\n","define('utils/database/randomizer/randomizerProvider',['underscore'],function(_){\n\n\t// @TODO: repeat currently repeats only the last element, we need repeat = 'set' or something in order to prevent re-randomizing of exRandom...\n\n\tRandomizerProvider.$inject = ['randomizeInt', 'randomizeRange', 'Collection'];\n\tfunction RandomizerProvider(randomizeInt, randomizeRange, Collection){\n\n\t\tfunction Randomizer(){\n\t\t\tthis._cache = {\n\t\t\t\trandom : {},\n\t\t\t\texRandom : {},\n\t\t\t\tsequential : {}\n\t\t\t};\n\t\t}\n\n\t\t_.extend(Randomizer.prototype, {\n\t\t\trandom: random,\n\t\t\texRandom: exRandom,\n\t\t\tsequential: sequential\n\t\t});\n\n\t\treturn Randomizer;\n\n\t\tfunction random(length, seed, repeat){\n\t\t\tvar cache  = this._cache.random;\n\n\t\t\tif (repeat && !_.isUndefined(cache[seed])) {\n\t\t\t\treturn cache[seed];\n\t\t\t}\n\n\t\t\t// save result in cache\n\t\t\tcache[seed] = randomizeInt(length);\n\n\t\t\treturn cache[seed];\n\t\t}\n\n\t\tfunction sequential(length, seed, repeat){\n\t\t\tvar cache = this._cache.sequential;\n\t\t\tvar coll = cache[seed];\n\t\t\tvar result;\n\n\t\t\t// if needed create collection and set it in seed\n\t\t\tif (_.isUndefined(coll)){\n\t\t\t\tcoll = cache[seed] = new Collection(_.range(length));\n\t\t\t\treturn coll.first();\n\t\t\t}\n\n\t\t\tif (coll.length !== length){\n\t\t\t\tthrow new Error(\"This seed  (\"+ seed +\") points to a collection with the wrong length, you can only use a seed for sets of the same length\");\n\t\t\t}\n\n\t\t\t// if this is a repeated element:\n\t\t\tif (repeat) {\n\t\t\t\treturn coll.current();\n\t\t\t}\n\n\t\t\t// if we've reached the end\n\t\t\tresult = coll.next();\n\n\t\t\t// if we've reached the end of the collection (next)\n\t\t\tif (_.isUndefined(result)){\n\t\t\t\treturn coll.first();\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t\tfunction exRandom(length, seed, repeat){\n\t\t\tvar cache = this._cache.exRandom;\n\t\t\tvar coll = cache[seed];\n\t\t\tvar result;\n\n\t\t\t// if needed create collection and set it in seed\n\t\t\tif (_.isUndefined(coll)){\n\t\t\t\tcoll = cache[seed] = new Collection(randomizeRange(length));\n\t\t\t\treturn coll.first();\n\t\t\t}\n\n\t\t\tif (coll.length !== length){\n\t\t\t\tthrow new Error(\"This seed  (\"+ seed +\") points to a collection with the wrong length, you can only use a seed for sets of the same length\");\n\t\t\t}\n\n\t\t\t// if this is a repeated element:\n\t\t\tif (repeat) {\n\t\t\t\treturn coll.current();\n\t\t\t}\n\n\t\t\t// if we've reached the end\n\t\t\tresult = coll.next();\n\n\t\t\t// if we've reached the end of the collection (next)\n\t\t\t// we should re-randomize\n\t\t\tif (_.isUndefined(result)){\n\t\t\t\tcoll = cache[seed] = new Collection(randomizeRange(length));\n\t\t\t\treturn coll.first();\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\n\t}\n\n\treturn RandomizerProvider;\n\n});\n","define('utils/database/queryProvider',['underscore'],function(_){\n\n\tqueryProvider.$inject = ['Collection','piConsole'];\n\tfunction queryProvider(Collection, $console){\n\n\t\tfunction queryFn(query, collection, randomizer){\n\t\t\tvar coll = new Collection(collection);\n\n\t\t\t// shortcuts:\n\t\t\t// ****************************\n\n\t\t\t// use function instead of query object.\n\t\t\tif (_.isFunction(query)){\n\t\t\t\treturn query(collection);\n\t\t\t}\n\n\t\t\t// pure string query\n\t\t\tif (_.isString(query) || _.isNumber(query)){\n\t\t\t\tquery = {set:query, type:'random'};\n\t\t\t}\n\n\t\t\t// narrow down by set\n\t\t\t// ****************************\n\t\t\tif (query.set){\n\t\t\t\tcoll = coll.where({set:query.set});\n\t\t\t}\n\n\t\t\t// narrow down by data\n\t\t\t// ****************************\n\t\t\tif (_.isString(query.data)){\n\t\t\t\tcoll = coll.filter(function(q){\n\t\t\t\t\treturn q.handle === query.data || (q.data && q.data.handle === query.data);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (_.isPlainObject(query.data)){\n\t\t\t\tcoll = coll.where({data:query.data});\n\t\t\t}\n\n\t\t\tif (_.isFunction(query.data)){\n\t\t\t\tcoll = coll.filter(query.data);\n\t\t\t}\n\n\t\t\t// pick by type\n\t\t\t// ****************************\n\n\t\t\t// the default seed is namespace specific just to minimize the situations where seeds clash across namespaces\n\t\t\tvar seed = query.seed || ('$' + collection.namespace + query.set);\n\t\t\tvar length = coll.length;\n\t\t\tvar repeat = query.repeat;\n\t\t\tvar at;\n\t\t\tvar err;\n\n\t\t\tswitch (query.type){\n\t\t\t\tcase undefined:\n\t\t\t\tcase 'byData':\n\t\t\t\tcase 'random':\n\t\t\t\t\tat = randomizer.random(length,seed,repeat);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'exRandom':\n\t\t\t\t\tat = randomizer.exRandom(length,seed,repeat);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sequential':\n\t\t\t\t\tat = randomizer.sequential(length,seed,repeat);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'first':\n\t\t\t\t\tat = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'last':\n\t\t\t\t\tat = length-1;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error('Unknow query type: ' + query.type);\n\t\t\t}\n\n\t\t\tif (_.isUndefined(coll.at(at))) {\n\t\t\t\terr = new Error('Query failed, object (' + JSON.stringify(query) +\t') not found. If you are trying to apply a template, you should know that they are not supported for inheritance.');\n\t\t\t\t$console('query').error(err);\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\treturn coll.at(at);\n\t\t}\n\n\t\treturn queryFn;\n\t}\n\n\treturn queryProvider;\n});\n","/*\n * inflates an object\n * this function is responsible for inheritance\n *\n * function inflate(source,coll, randomizer, recursive, counter)\n * @param source: the object to inflate\n * @param coll: a collection to inherit from\n * @param randomizer: a randomizer object for the query\n * @param recursive: private use only, is this inside the recursion (true) or top level (false)\n * @param depth: private use only, a counter for the depth of the recursion\n */\ndefine('utils/database/inflateProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tinflateProvider.$inject = ['databaseQuery','$rootScope','piConsole'];\n\tfunction inflateProvider(query, $rootScope, $console){\n\n\t\tfunction customize(source){\n\t\t\t// check for a custom function and run it if it exists\n\t\t\tif (_.isFunction(source.customize)){\n\t\t\t\tsource.customize.apply(source, [source, $rootScope.global]);\n\t\t\t}\n\t\t\treturn source;\n\t\t}\n\n\t\t// @param source - object to inflate\n\t\t// @param type - trial stimulus or media\n\t\t// @param recursive - whether this is a recursive call or not\n\t\tfunction inflate(source, coll, randomizer, recursive, depth){\n\n\t\t\t// protection against infinte loops\n\t\t\t// ***********************************\n\t\t\tdepth = recursive ? --depth : 10;\n\n\t\t\tif (!depth) {\n\t\t\t\tthrow new Error('Inheritance loop too deep, you can only inherit up to 10 levels down');\n\t\t\t}\n\n\t\t\tif (!_.isPlainObject(source)){\n\t\t\t\tthrow new Error('You are trying to inflate a non object');\n\t\t\t}\n\n\t\t\tvar parent\n\t\t\t\t// create child\n\t\t\t\t, child = _.cloneDeep(source)\n\t\t\t\t, err\n\t\t\t\t, inheritObj = child.inherit;\n\n\n\t\t\t// no inheritance\n\t\t\t// ***********************************\n\n\t\t\t// if we do not need to inherit anything, simply return source\n\t\t\tif (!child.inherit) {\n\t\t\t\t// customize only on the last call (non recursive)\n\t\t\t\t!recursive && customize(child);\n\t\t\t\treturn child;\n\t\t\t}\n\n\t\t\t// get parent\n\t\t\t// ***********************************\n\t\t\tparent = query(inheritObj, coll, randomizer);\n\n\t\t\t// if inherit target was not found\n\t\t\tif (!parent){\n\t\t\t\terr = new Error('Query failed, object (' + JSON.stringify(inheritObj) +\t') not found.');\n\t\t\t\t$console('query').error(err);\n\t\t\t\tthrow err;\n\t\t\t}\n\n\t\t\t// inflate parent (recursively)\n\t\t\tparent = inflate(\n\t\t\t\tparent,\n\t\t\t\tcoll,\n\t\t\t\trandomizer,\n\t\t\t\ttrue,\n\t\t\t\tdepth\n\t\t\t);\n\n\t\t\t// extending the child\n\t\t\t// ***********************************\n\t\t\tif (inheritObj.merge && !_.isArray(inheritObj.merge)){\n\t\t\t\tthrow new Error('Inheritance error: inherit.merge must be an array.');\n\t\t\t}\n\n\t\t\t// start inflating child (we have to extend selectively...)\n\t\t\t_.each(parent, function(value, key){\n\t\t\t\tvar childProp, parentProp;\n\t\t\t\t// if this key is not set yet, copy it out of the parent\n\t\t\t\tif (!(key in child)){\n\t\t\t\t\tchild[key] = _.isFunction(value) ? value : _.cloneDeep(value);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// if we have a merge array,\n\t\t\t\tif (_.indexOf(inheritObj.merge, key) != -1){\n\t\t\t\t\tchildProp = child[key];\n\t\t\t\t\tparentProp = value;\n\n\t\t\t\t\tif (_.isArray(childProp)){\n\t\t\t\t\t\tif (!_.isArray(parentProp)){\n\t\t\t\t\t\t\tthrow new Error('Inheritance error: You tried merging an array with an non array (for \"' + key + '\")');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tchild[key] = childProp.concat(parentProp);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (_.isPlainObject(childProp)){\n\t\t\t\t\t\tif (!_.isPlainObject(parentProp)){\n\t\t\t\t\t\t\tthrow new Error('Inheritance error: You tried merging an object with an non object (for \"' + key + '\")');\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_.extend(childProp, parentProp);\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// we want to extend the childs data even if it already exists\n\t\t\t// its ok to shallow extend here (because by definition parent was created for this inflation)\n\t\t\tif (parent.data){\n\t\t\t\tchild.data = _.extend(parent.data, child.data || {});\n\t\t\t}\n\n\t\t\t// Personal customization functions - only if this is the last iteration of inflate\n\t\t\t// This way the customize function gets called only once.\n\t\t\t!recursive && customize(child);\n\n\t\t\t// return inflated trial\n\t\t\treturn child;\n\t\t}\n\n\t\treturn inflate;\n\t}\n\n\treturn inflateProvider;\n});\n","/*\n *\tThe store is a collection of collection devided into namespaces.\n *\tYou can think of every namespace/collection as a table.\n */\ndefine('utils/database/store/storeProvider',['underscore'],function(_){\n\n\tstoreProvider.$inject = ['Collection'];\n\tfunction storeProvider(Collection){\n\n\t\tfunction Store(){\n\t\t\tthis.store = {};\n\t\t}\n\n\t\t_.extend(Store.prototype, {\n\t\t\tcreate: function create(nameSpace){\n\t\t\t\tif (this.store[nameSpace]){\n\t\t\t\t\tthrow new Error('The name space ' + nameSpace + ' already exists');\n\t\t\t\t}\n\t\t\t\tthis.store[nameSpace] = new Collection();\n\t\t\t\tthis.store[nameSpace].namespace = nameSpace;\n\t\t\t},\n\n\t\t\tread: function read(nameSpace){\n\t\t\t\tif (!this.store[nameSpace]){\n\t\t\t\t\tthrow new Error('The name space ' + nameSpace + ' does not exist');\n\t\t\t\t}\n\t\t\t\treturn this.store[nameSpace];\n\t\t\t},\n\n\t\t\tupdate: function update(nameSpace, data){\n\t\t\t\tvar coll = this.read(nameSpace);\n\t\t\t\tcoll.add(data);\n\t\t\t},\n\n\t\t\tdel: function del(nameSpace){\n\t\t\t\tthis.store[nameSpace] = undefined;\n\t\t\t}\n\t\t});\n\n\t\treturn Store;\n\t}\n\n\treturn storeProvider;\n});\n","define('utils/database/databaseProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tDatabaseProvider.$inject = ['DatabaseStore', 'DatabaseRandomizer', 'databaseInflate', 'templateObj', 'databaseSequence'];\n\tfunction DatabaseProvider(Store, Randomizer, inflate, templateObj, DatabaseSequence){\n\n\t\tfunction Database(){\n\t\t\tthis.store = new Store();\n\t\t\tthis.randomizer = new Randomizer();\n\t\t}\n\n\t\t_.extend(Database.prototype, {\n\t\t\tcreateColl: function(namespace){\n\t\t\t\tthis.store.create(namespace);\n\t\t\t},\n\n\t\t\tgetColl: function(namespace){\n\t\t\t\treturn this.store.read(namespace);\n\t\t\t},\n\n\t\t\tadd: function(namespace, query){\n\t\t\t\tvar coll = this.store.read(namespace);\n\t\t\t\tcoll.add(query);\n\t\t\t},\n\n\t\t\tinflate: function(namespace, query, context){\n\t\t\t\tvar coll = this.getColl(namespace);\n\n\t\t\t\t// inflate\n\t\t\t\tif (!query.$inflated || query.reinflate) {\n\t\t\t\t\tquery.$inflated = inflate(query, coll, this.randomizer);\n\t\t\t\t}\n\n\t\t\t\t// interpolate\n\t\t\t\tif (!query.$templated || query.regenerateTemplate){\n\t\t\t\t\tcontext[namespace + 'Data'] = query.$inflated.data || {};\n\t\t\t\t\tcontext[namespace + 'Meta'] = query.$meta;\n\t\t\t\t\tquery.$templated = templateObj(query.$inflated, context);\n\t\t\t\t}\n\n\t\t\t\treturn query.$templated;\n\t\t\t},\n\n\t\t\tsequence: function(namespace, arr){\n\t\t\t\tif (!_.isArray(arr)){\n\t\t\t\t\tthrow new Error('Sequence must be an array.');\n\t\t\t\t}\n\t\t\t\treturn new DatabaseSequence(namespace, arr, this);\n\t\t\t}\n\t\t});\n\n\t\treturn Database;\n\t}\n\n\treturn DatabaseProvider;\n});\n","define('utils/database/databaseSequenceProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tSequenceProvider.$inject = ['MixerSequence'];\n\tfunction SequenceProvider(MixerSequence){\n\n\t\t/**\n\t\t * Sequence Constructor:\n\t\t * Manage the progression of a sequence, including parsing (mixing, inheritance and templating).\n\t\t * @param  {String  } namespace [pages or questions (the type of db.Store)]\n\t\t * @param  {Array   } arr       [a sequence to manage]\n\t\t * @param  {Database} db        [the db itself]\n\t\t */\n\n\t\tfunction Sequence(namespace, arr,db){\n\t\t\tthis.namespace = namespace;\n\t\t\tthis.mixerSequence = new MixerSequence(arr);\n\t\t\tthis.db = db;\n\t\t}\n\n\t\t_.extend(Sequence.prototype, {\n\t\t\t// only mix\n\t\t\tnext: function(context){\n\t\t\t\tthis.mixerSequence.next(context);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t// anti mix\n\t\t\tprev: function(context){\n\t\t\t\tthis.mixerSequence.prev(context);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Return the element currently in focus.\n\t\t\t * It always returns either an element or undefined (mixers are abstrcted away)\n\t\t\t * @param  {[type]} context [description]\n\t\t\t * @return {[type]}         [description]\n\t\t\t */\n\t\t\tcurrent: function(context){\n\t\t\t\tcontext || (context = {});\n\t\t\t\t// must returned an element or undefined\n\t\t\t\tvar obj = this.mixerSequence.current(context);\n\n\t\t\t\t// in case this is the end of the sequence\n\t\t\t\tif (!obj){\n\t\t\t\t\treturn obj;\n\t\t\t\t}\n\n\t\t\t\treturn this.db.inflate(this.namespace, obj, context);\n\t\t\t},\n\n\t\t\t/**\n\t\t\t * Returns an array of elements, created by proceeding through the whole sequence.\n\t\t\t * @return {[type]} [description]\n\t\t\t */\n\t\t\tall: function(context){\n\t\t\t\tvar sequence = [];\n\n\t\t\t\tvar el = this.next().current(context);\n\t\t\t\twhile (el){\n\t\t\t\t\tsequence.push(el);\n\t\t\t\t\tel = this.next().current(context);\n\t\t\t\t}\n\n\t\t\t\treturn sequence;\n\t\t\t}\n\t\t});\n\n\t\treturn Sequence;\n\t}\n\n\treturn SequenceProvider;\n});\n","define('utils/database/databaseModule',['require','angular','./mixer/mixerModule','./template/templateModule','utils/console/consoleModule','./collection/collectionProvider','./randomizer/randomizerProvider','./queryProvider','./inflateProvider','./store/storeProvider','./databaseProvider','./databaseSequenceProvider'],function(require){\n\n\tvar angular = require('angular');\n\n\tvar module = angular.module('database',[\n\t\t\trequire('./mixer/mixerModule').name,\n\t\t\trequire('./template/templateModule').name,\n\t\t\trequire('utils/console/consoleModule').name\n\t\t])\n\t\t.service('Collection', require('./collection/collectionProvider'))\n\t\t.service('DatabaseRandomizer', require('./randomizer/randomizerProvider'))\n\t\t.service('databaseQuery', require('./queryProvider'))\n\t\t.service('databaseInflate', require('./inflateProvider'))\n\t\t.service('DatabaseStore', require('./store/storeProvider'))\n\t\t.service('Database', require('./databaseProvider'))\n\t\t//.value('Database', require('./main')) // tests the use of the non angular variation\n\t\t.service('databaseSequence', require('./databaseSequenceProvider'));\n\n\treturn module;\n});\n","define('quest/task/questSequenceProvider',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tfunction SequenceProvider(){\n\n\t\tfunction Sequence(arr, db){\n\t\t\tif (!db){\n\t\t\t\tthrow new Error('Sequences need to take a db as the second argument');\n\t\t\t}\n\n\t\t\tthis.sequence = db.sequence('pages', arr);\n\t\t\tthis.db = db;\n\t\t}\n\n\t\t_.extend(Sequence.prototype, {\n\t\t\tnext: function(context){\n\t\t\t\tthis.sequence.next(context);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tprev: function(context){\n\t\t\t\tthis.sequence.prev(context);\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tcurrent: function(context){\n\t\t\t\tvar questionsArr,\n\t\t\t\t\tpage = this.sequence.current(context);\n\n\t\t\t\tif (!page){\n\t\t\t\t\treturn page;\n\t\t\t\t}\n\n\t\t\t\tif (page.questions){\n\t\t\t\t\tquestionsArr = _.isArray(page.questions) ? page.questions : [page.questions];\n\t\t\t\t} else {\n\t\t\t\t\tquestionsArr = [];\n\t\t\t\t}\n\n\t\t\t\tvar questions = this.db.sequence('questions', questionsArr).all({\n\t\t\t\t\tpagesData: page.data,\n\t\t\t\t\tpagesMeta: page.$meta\n\t\t\t\t});\n\n\t\t\t\t// make sure we don't lose any thing in the orginal page\n\t\t\t\t// @TODO: this seems extremely expensive. Is this really neccesary?\n\t\t\t\tpage = _.clone(page, true);\n\t\t\t\tpage.questions = questions;\n\n\t\t\t\treturn page;\n\t\t\t}\n\t\t});\n\n\t\treturn Sequence;\n\t}\n\n\treturn SequenceProvider;\n});\n","define('quest/task/taskProvider',['underscore', 'angular'], function(_, angular){\n\n\tTaskProvider.$inject = ['$q','Database','Logger','QuestSequence','taskParse', 'dfltQuestLogger', '$rootScope'];\n\tfunction TaskProvider($q, Database, Logger, QuestSequence, parse, dfltQuestLogger,$rootScope){\n\t\tfunction Task(script){\n\t\t\tvar self = this;\n\t\t\tvar settings = script.settings || {};\n\n\t\t\t// save script for later use...\n\t\t\tthis.script = script;\n\t\t\tthis.db = new Database();\n\t\t\tthis.logger = new Logger(dfltQuestLogger);\n\t\t\tthis.logger.setSettings(settings.logger || {});\n\t\t\tthis.q = $q.defer();\n\n\t\t\tif (!_.isArray(script.sequence)){\n\t\t\t\tthrow new Error('Task: no sequence was defined');\n\t\t\t}\n\n\t\t\tthis.sequence = new QuestSequence(script.sequence, this.db);\n\n\t\t\tthis.promise = this.q.promise\n\t\t\t\t.then(function(){\n\t\t\t\t\t// check if there are unlogged questions and log them\n\t\t\t\t\tself.logger.suppressPulse(); // this is the end of the task, we want to post all the logs at once.\n\t\t\t\t\t_.each($rootScope.current.questions, function(quest){\n\t\t\t\t\t\tif(quest.$logged){\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t/**\n\t\t\t\t\t\t * logs to server\n\t\t\t\t\t\t * @param {Object} log : the actual data regarding this log\n\t\t\t\t\t\t * @param {Object} pageData : General inforamtion about this page\n\t\t\t\t\t\t * @param {Object} global : The global object\n\t\t\t\t\t\t */\n\t\t\t\t\t\tself.log(quest, {}, $rootScope.global);\n\t\t\t\t\t\tquest.$logged = true;\n\t\t\t\t\t});\n\t\t\t\t\tself.logger.suppressPulse(false); // turn suppress off\n\t\t\t\t\treturn self.logger.send();\n\t\t\t\t})\n\t\t\t\t['finally'](settings.onEnd || angular.noop); // end only after logging has finished (regardless of success)\n\n\t\t\tparse(script, this.db);\n\t\t}\n\n\t\t_.extend(Task.prototype, {\n\t\t\tlog: function(){\n\t\t\t\tthis.logger.log.apply(this.logger, arguments);\n\t\t\t},\n\t\t\tcurrent: function(){\n\t\t\t\tvar nextObj = this.sequence.current();\n\n\t\t\t\tif (!nextObj){\n\t\t\t\t\tthis.q.resolve();\n\t\t\t\t}\n\n\t\t\t\treturn nextObj;\n\t\t\t},\n\t\t\tnext: function(){\n\t\t\t\treturn this.sequence.next();\n\t\t\t},\n\t\t\tprev: function(){\n\t\t\t\treturn this.sequence.prev();\n\t\t\t}\n\t\t});\n\n\t\treturn Task;\n\t}\n\n\treturn TaskProvider;\n});\n","define('quest/task/parseProvider',[],function(){\n\n\tparseProvider.$inject = ['piConsole'];\n\tfunction parseProvider(piConsole){\n\t\tfunction parse(script, db){\n\t\t\tdb.createColl('pages');\n\t\t\tdb.createColl('questions');\n\n\t\t\tdb.add('pages', script.pagesSets || []);\n\t\t\tdb.add('questions', script.questionsSets || []);\n\n\t\t\tscript.settings || (script.settings = {});\n\n\t\t\tpiConsole.setSettings(script.settings.DEBUG || {});\n\t\t}\n\n\t\treturn parse;\n\t}\n\n\treturn parseProvider;\n});\n","define('quest/task/dfltQuestLogger',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tfunction dfltQuestLogger(log, pageData, global){\n\t\tglobal;\n\t\tvar logObj = _.extend({},pageData,log);\n\t\tif (logObj.declined) {\n\t\t\tlogObj.response = log.responseObj = undefined;\n\t\t}\n\t\treturn logObj;\n\t}\n\n\treturn dfltQuestLogger;\n\n});\n","define('quest/task/task-module',['require','angular','utils/logger/logger-module','utils/database/databaseModule','utils/console/consoleModule','./questSequenceProvider','./taskProvider','./parseProvider','./dfltQuestLogger'],function(require){\n\n\tvar angular = require('angular');\n\tvar module = angular.module('task', [\n\t\trequire('utils/logger/logger-module').name,\n\t\trequire('utils/database/databaseModule').name,\n\t\trequire('utils/console/consoleModule').name\n\t]);\n\n\tmodule.service('QuestSequence', require('./questSequenceProvider'));\n\tmodule.service('Task', require('./taskProvider'));\n\tmodule.service('taskParse', require('./parseProvider'));\n\n\tmodule.value('dfltQuestLogger', require('./dfltQuestLogger'));\n\n\treturn module;\n});\n","/*\n *\tOne module to rule them all.\n *\tThis module is responsible to pull together all the piquest components.\n *\tCalling it should suffice to activate the whole piquest stuff.\n */\ndefine('quest/questModule',['require','quest/directives/questDirectivesModule','quest/task/task-module'],function(require){\n\n\trequire('quest/directives/questDirectivesModule');\n\trequire('quest/task/task-module');\n\n\tvar module = angular.module('piQuest', ['questDirectives','task']);\n\n\treturn module;\n});\n","/*\n * @name: piMessage Directive\n */\ndefine('message/messageDirective',['require','underscore'],function (require) {\n\n\tvar _ = require('underscore');\n\n\tdirective.$inject = ['$compile', '$rootScope', '$document', 'piConsole'];\n\tfunction directive($compile, $rootScope, $document, $console){\n\t\treturn {\n\t\t\tlink: function($scope, $element) {\n\t\t\t\tvar events = 'keydown';\n\t\t\t\tvar script = $scope.script;\n\t\t\t\tvar newScope = $scope.newScope = $scope.$new();\n\t\t\t\tvar template;\n\t\t\t\tvar context = {\n\t\t\t\t\tglobal : $rootScope.global,\n\t\t\t\t\tcurrent : $rootScope.current,\n\t\t\t\t\ttask: script\n\t\t\t\t};\n\n\t\t\t\t// try to render template\n\t\t\t\ttry {\n\t\t\t\t\ttemplate = _.template(script.$template)(context);\n\t\t\t\t} catch(e){\n\t\t\t\t\ttemplate = script.$template;\n\t\t\t\t\t$console('message').error('failed to render template', e);\n\t\t\t\t}\n\n\t\t\t\t_.extend($scope, context);\n\t\t\t\t$scope.done = done;\n\n\t\t\t\t// listen for events\n\t\t\t\t$document.on(events, onKeydown);\n\t\t\t\t$scope.$on('$destroy',function(){\n\t\t\t\t\t$document.off(events, onKeydown);\n\t\t\t\t});\n\n\t\t\t\t$element.html(template);\n\t\t\t\t$compile($element.contents())(newScope);\n\n\t\t\t\t// check if the we should proceed and if so call done\n\t\t\t\tfunction onKeydown(e){\n\t\t\t\t\t// accept both the keyCode and the key itself\n\t\t\t\t\tvar keyArr = _.isArray(script.keys) ? script.keys : [script.keys];\n\t\t\t\t\tvar keys = _.map(keyArr,function(value){\n\t\t\t\t\t\treturn _.isString(value) ? value.toUpperCase().charCodeAt(0) : value;\n\t\t\t\t\t});\n\n\t\t\t\t\t// event is in the keys array\n\t\t\t\t\t// ~ return 0 only if target was not found\n\t\t\t\t\tif (~_.indexOf(keys, e.which)){\n\t\t\t\t\t\t$scope.done();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction done(){\n\t\t\t\t\tnewScope.$destroy();\n\t\t\t\t\t$element.empty();\n\t\t\t\t\t$scope.$emit('message:done');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\n\n\n\n\treturn directive;\n});\n","/*\n * @name: messageDone Directive\n */\ndefine('message/messageDoneDirective',[],function () {\n\n\tdirective.$inject = [];\n\tfunction directive(){\n\t\treturn {\n\t\t\tlink: function($scope, $element){\n\t\t\t\t$element.on('click', function(){\n\t\t\t\t\t$scope.done();\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","define('message/messageModule',['require','angular','utils/console/consoleModule','./messageDirective','./messageDoneDirective'],function(require){\n\tvar angular = require('angular');\n\tvar module = angular.module('pi.message',[\n\t\trequire('utils/console/consoleModule').name\n\t]);\n\n\tmodule.directive('piMessage', require('./messageDirective'));\n\tmodule.directive('piMessageDone', require('./messageDoneDirective'));\n\n\treturn module;\n});\n","/**\n * @name: taskActivateProvider\n */\ndefine('taskManager/task/taskActivateProvider',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\n\tfunction provider(){\n\t\tvar activators = {};\n\n\t\tthis.$get = taskActivateProvider;\n\n\t\tthis.set = function set(name, fn){\n\t\t\tactivators[name] = fn;\n\t\t};\n\n\t\tthis.get = function(name){\n\t\t\treturn activators[name];\n\t\t};\n\t}\n\n\n\ttaskActivateProvider.$inject = ['$q', '$rootScope', '$injector'];\n\tfunction taskActivateProvider($q,$rootScope, $injector){\n\t\tvar self = this;\n\n\t\tfunction taskActivate(task, $element, $scope){\n\t\t\tvar activator;\n\t\t\tvar def = $q.defer();\n\t\t\tvar global = $rootScope.global;\n\t\t\tvar script = task.$script;\n\t\t\tvar destroy;\n\n\t\t\t// get activation function\n\t\t\tif (_.isFunction(script)){\n\t\t\t\tactivator = script;\n\t\t\t}\n\n\t\t\tif (!activator && script && _.isFunction(script.play)){\n\t\t\t\tactivator = _.bind(script.play, script);\n\t\t\t\tactivator.$inject = $injector.annotate(script.play);\n\t\t\t}\n\n\t\t\tif (!activator && script && _.isArray(script.play)){\n\t\t\t\tactivator = _.bind(script.play[script.play.length-1], script);\n\t\t\t\tactivator.$inject = $injector.annotate(script.play);\n\t\t\t}\n\n\n\t\t\tif (!activator && task.type){\n\t\t\t\tactivator = self.get(task.type);\n\t\t\t}\n\n\t\t\tif (!_.isFunction(activator)){\n\t\t\t\tthrow new Error('Activator function not found for the \"' + task.type + '\" task');\n\t\t\t}\n\n\t\t\t// activate task\n\t\t\t/**\n\t\t\t * activation function\n\t\t\t * @param {function} done calback for finishing the task\n\t\t\t * @param {obj} props an object with all the stuff we think we could need...\n\t\t\t * @type {[type]}\n\t\t\t */\n\n\t\t\tdestroy = $injector.invoke(activator, null, {\n\t\t\t\tdone: _.bind(def.resolve,def),\n\t\t\t\ttask: task,\n\t\t\t\tscript: script,\n\t\t\t\t$element: $element,\n\t\t\t\t$scope: $scope,\n\t\t\t\tglobal: global\n\t\t\t});\n\n\t\t\t// if activator returns a function use it to clean up the task\n\t\t\t_.isFunction(destroy) && def.promise['finally'](destroy);\n\n\t\t\treturn def;\n\t\t}\n\n\t\treturn taskActivate;\n\t}\n\n\treturn provider;\n});\n","/*\n * @name: taskDirective\n */\ndefine('taskManager/task/taskDirective',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\tdirective.$inject = ['taskActivate','managerCanvas','$document', '$window', '$rootScope'];\n\tfunction directive(activateTask, canvas, $document, $window, $rootScope){\n\t\treturn {\n\t\t\tscope:{\n\t\t\t\ttask: '=piTask'\n\t\t\t},\n\t\t\tlink: function($scope, $element){\n\t\t\t\tvar task = $scope.task;\n\t\t\t\tvar canvasOff, oldTitle;\n\t\t\t\tvar def;\n\t\t\t\tvar promise;\n\t\t\t\tvar proceedObject;\n\t\t\t\tvar settings = $scope.$parent.settings || {};\n\t\t\t\tvar script = task.$script || {};\n\t\t\t\tvar taskName = task.name || script.name;\n\n\t\t\t\tif (!task){\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * listen for skip events\n\t\t\t\t */\n\t\t\t\tif (settings.skip){\n\t\t\t\t\t$document.on('keydown',proceedListener);\n\t\t\t\t\t$scope.$on('$destroy', function(){\n\t\t\t\t\t\t$document.off('keydown', proceedListener);\n\t\t\t\t\t\t$document.off('keydown', skipListener);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Setup current object\n\t\t\t\t */\n\t\t\t\t$rootScope.current = $window.piGlobal.current = script.current || {};\n\t\t\t\tif (taskName){\n\t\t\t\t\t// extend current script with the piGlobal object\n\t\t\t\t\t_.extend($rootScope.current, $window.piGlobal[taskName] || {});\n\t\t\t\t\t// set the current object back into the global\n\t\t\t\t\t$window.piGlobal[taskName] = script.current;\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * Activate task\n\t\t\t\t */\n\t\t\t\tdef = activateTask(task, $element, $scope.$new());\n\t\t\t\tpromise = def.promise;\n\n\t\t\t\t/**\n\t\t\t\t * Add and remove canvas\n\t\t\t\t */\n\t\t\t\tcanvasOff = canvas(task.canvas); // apply canvas settings\n\t\t\t\tpromise['finally'](canvasOff); // remove canvas settings\n\n\t\t\t\t/**\n\t\t\t\t * Add and remove title\n\t\t\t\t * if task.title is set, set the title and remove at the end...\n\t\t\t\t */\n\t\t\t\tif (task.title){\n\t\t\t\t\toldTitle = $document[0].title;\n\t\t\t\t\t$document[0].title = task.title;\n\t\t\t\t\tpromise['finally'](function(){$document[0].title = oldTitle;});\n\t\t\t\t}\n\n\t\t\t\tpromise['finally'](function(){\n\t\t\t\t\t$scope.$emit('task:done', proceedObject);\n\t\t\t\t});\n\n\t\t\t\t/**\n\t\t\t\t * Listen for skip events\n\t\t\t\t * F5 = refresh\n\t\t\t\t * esc = set up arrows for prev/next\n\t\t\t\t * @param  {Event} e\n\t\t\t\t */\n\t\t\t\tfunction proceedListener(e){\n\t\t\t\t\tvar which = e.key || e.which || e.keyCode;\n\n\t\t\t\t\t// ctrl r ==> refresh\n\t\t\t\t\tif (which == 82 && e.ctrlKey) {\n\t\t\t\t\t\tproceed(e, 'current');\n\t\t\t\t\t}\n\n\t\t\t\t\t// esc ==> listen for skip direction (once)\n\t\t\t\t\tif(which == 27) {\n\t\t\t\t\t\t$document.one('keydown', skipListener);\n\t\t\t        }\n\t\t\t\t}\n\n\t\t\t\t// skip on left/right key codes\n\t\t\t\tfunction skipListener(e){\n\t\t\t\t\tvar which = e.which || e.keyCode;\n\t\t\t\t\tif (which == 37) {proceed(e, 'prev');}\n\t\t\t\t\tif (which == 39) {proceed(e, 'next');}\n\t\t\t\t}\n\n\t\t\t\t// end task and proceed where needed\n\t\t\t\tfunction proceed(e, target){\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tproceedObject = {type:target, bustCache:true}; // when the deferred is resolved this object is used to tell piqPage where to proceed.\n\t\t\t\t\tdef.resolve();\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","/**\n * The module responsible for the single task.\n * It knows how to load a task and activate it.\n * It also supplies the basic task directive.\n * @return {module} pi.task module.\n */\ndefine('taskManager/task/taskModule',['require','angular','underscore','./taskActivateProvider','./taskDirective'],function(require){\n\n\tvar angular = require('angular');\n\tvar module = angular.module('pi.task',[]);\n\tvar _ = require('underscore');\n\n\tmodule.provider('taskActivate', require('./taskActivateProvider'));\n\tmodule.directive('piTask', require('./taskDirective'));\n\n\t// the tasks defined here essentialy activate the default players for quest/message/pip.\n\n\tmodule.config(['taskActivateProvider', function(activateProvider){\n\n\t\tactivateQuest.$inject = ['done', '$element', '$scope', '$compile', 'script','task'];\n\t\tfunction activateQuest(done, $canvas, $scope, $compile, script, task){\n\t\t\tvar $el;\n\n\t\t\t// update script name\n\t\t\ttask.name && (script.name = task.name);\n\n\t\t\t$scope.script = script;\n\n\t\t\t$canvas.append('<div pi-quest></div>');\n\t\t\t$el = $canvas.contents();\n\t\t\t$compile($el)($scope);\n\n\t\t\t// clean up piQuest\n\t\t\t$el.controller('piQuest').task.promise['finally'](function(){\n\t\t\t\tdone();\n\t\t\t});\n\n\t\t\treturn function questDestroy(){\n\t\t\t\t$el.scope().$destroy();\n\t\t\t\t$el.remove();\n\t\t\t};\n\t\t}\n\n\t\tactivateProvider.set('quest', activateQuest);\n\t}]);\n\n\tmodule.config(['taskActivateProvider', function(activateProvider){\n\t\tactivateMessage.$inject = ['done', '$element', 'task', '$scope','$compile'];\n\t\tfunction activateMessage(done, $canvas, task, $scope, $compile){\n\t\t\tvar $el;\n\n\t\t\t$scope.script = task;\n\n\t\t\t$canvas.append('<div pi-message></div>');\n\t\t\t$el = $canvas.contents();\n\t\t\t$compile($el)($scope);\n\n\t\t\t// clean up\n\t\t\t$scope.$on('message:done', function(){\n\t\t\t\tdone();\n\t\t\t});\n\n\t\t\treturn function destroyMessage(){\n\t\t\t\t$scope.$destroy();\n\t\t\t\t$el.remove();\n\t\t\t};\n\t\t}\n\n\t\tactivateProvider.set('message', activateMessage);\n\t}]);\n\n\tmodule.config(['taskActivateProvider', function(activateProvider){\n\t\tactivatePIP.$inject = ['done', '$element', 'task', 'script'];\n\t\tfunction activatePIP(done, $canvas, task, script){\n\t\t\tvar $el, req;\n\n\t\t\t// load PIP\n\t\t\treq = requirejs.config({\n\t\t\t\tcontext: _.uniqueId(),\n\t\t\t\tbaseUrl:'../bower_components/PIPlayer/dist/js', // can't use packages yet as urls in pip aren't relative...\n\t\t\t\tpaths: {\n\t\t\t\t\t//plugins\n\t\t\t\t\ttext: ['//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.3/text.min', \"../../bower_components/requirejs-text/text\"],\n\n\t\t\t\t\t// Core Libraries\n\t\t\t\t\tjquery: [\"//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min\",\"../../bower_components/jquery/dist/jquery.min\"],\n\t\t\t\t\tunderscore: [\"//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min\",\"../../bower_components/lodash-compat/lodash.min\"],\n\t\t\t\t\tbackbone: ['//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min', \"../../bower_components/backbone/backbone\"]\n\t\t\t\t},\n\n\t\t\t\tdeps: ['jquery', 'backbone', 'underscore']\n\t\t\t});\n\n\t\t\t// update script name\n\t\t\ttask.name && (script.name = task.name);\n\n\t\t\t$canvas.append('<div pi-player></div>');\n\t\t\t$el = $canvas.contents();\n\t\t\t$el.addClass('pi-spinner');\n\n\t\t\treq(['activatePIP'], function(activate){\n\t\t\t\t$el.removeClass('pi-spinner');\n\t\t\t\tactivate(script, done);\n\t\t\t});\n\n\t\t\treturn function destroyPIP(){\n\t\t\t\t$el.remove();\n\t\t\t\treq(['app/task/main_view'], function(main){\n\t\t\t\t\tmain.deferred.resolve();\n\t\t\t\t\tmain.destroy();\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\n\t\tactivateProvider.set('pip', activatePIP);\n\t}]);\n\n\treturn module;\n});\n","define('taskManager/canvas/canvasConstructor',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\t/**\n\t * Takes a map of css rules and applies them.\n\t * Returns a function that returns the page to its former condition.\n\t *\n\t * The rule map is an object of ruleName -> ruleObject.\n\t *\n\t * var ruleObject = {\n\t * \telement : wrapped element to affect\n\t * \tproperty: css property to modify\n\t * }\n\t *\n\t * @param  {Object} map      A hash of rules.\n\t * @param  {Object} settings A hash of ruleName -> value\n\t * @return {Function}        A function that undoes all the previous changes\n\t */\n\tfunction canvasContructor(map, settings){\n\t\tvar offArr;\n\n\t\tif (!_.isPlainObject(map)){\n\t\t\tthrow new Error('canvas(map): You must set a rule map for canvas to work properly');\n\t\t}\n\n\t\t// if settings is undefined return a function that doesn't do anything\n\t\t// just so we don't need to make sure that the user modifies the canvas\n\t\tif (_.isUndefined(settings)){\n\t\t\treturn _.noop;\n\t\t}\n\n\t\tif (!_.isPlainObject(settings)){\n\t\t\tthrow new Error('canvas(settings): canvas settings must be an object');\n\t\t}\n\n\t\t// create an array of off functions to undo any changes by this action\n\t\toffArr = _.map(settings, function(value,key){\n\t\t\tvar rule = map[key];\n\t\t\tif (rule){\n\t\t\t\treturn on(rule.element, rule.property, value);\n\t\t\t} else {\n\t\t\t\tthrow new Error('canvas('+ key +'): unknow key in canvas object.');\n\t\t\t}\n\t\t});\n\n\t\treturn function off(){\n\t\t\t_.forEach(offArr, function(fn){fn.call();});\n\t\t};\n\t}\n\n\tfunction on($el, property, value){\n\t\tvar old = $el.css(property); // save old value\n\t\t$el.css(property, value); // set new value\n\t\treturn _.bind($el.css, $el, property, old); // create off function: bind $el.css(property, old)\n\t}\n\n\treturn canvasContructor;\n\n});\n","define('taskManager/canvas/managerCanvasService',['require','underscore','angular','./canvasConstructor'],function(require){\n\n\tvar _ = require('underscore');\n\tvar angular = require('angular');\n\tvar canvasConstructor = require('./canvasConstructor');\n\n\tmanagerCanvasService.$inject = ['$rootElement', '$document'];\n\tfunction managerCanvasService($rootElement, $document){\n\t\tvar $body = angular.element($document[0].body);\n\n\t\tvar map = {\n\t\t\tbackground \t\t\t: {element: $body, property: 'backgroundColor'},\n\t\t\tcanvasBackground\t: {element: $rootElement, property:'backgroundColor'},\n\t\t\tfontSize \t\t\t: {element: $rootElement, property:'fontSize'},\n\t\t\tfontColor \t\t\t: {element: $rootElement, property:'color'}\n\t\t};\n\n\t\treturn _.bind(canvasConstructor, null, map);\n\t}\n\n\treturn managerCanvasService;\n\n});\n","define('taskManager/canvas/canvasModule',['require','angular','./managerCanvasService'],function(require){\n\n\tvar angular = require('angular');\n\tvar module = angular.module('pi.canvas',[]);\n\n\tmodule.service('managerCanvas', require('./managerCanvasService'));\n\n\treturn module;\n});\n","/**\n * Swap directive\n * Enables a slide-show type interface.\n * It exposes a controller with the next/prev/refresh/empty methods.\n * Each time next is called, the content is re-compiled and animated in, and old content is animated out.\n *\n * @param  {[type]} require [description]\n * @return {[type]}         [description]\n */\ndefine('utils/helperDirectives/piSwap/piSwapDirective',['require','underscore'],function (require) {\n\t// get template\n\tvar _  = require('underscore');\n\n\tswapControler.$inject = ['$scope'];\n\tfunction swapControler($scope){\n\t\tthis.$scope = $scope;\n\t}\n\n\t_.extend(swapControler.prototype, {\n\t\tnext : function(props, options){\n\t\t\tthis.$scope.enter(props, options);\n\t\t},\n\t\tprev: function(props, options){\n\t\t\tthis.$scope.enter(props, options);\n\t\t},\n\t\trefresh: function(props){\n\t\t\tthis.$scope.refresh(props);\n\t\t},\n\t\tempty: function(options){\n\t\t\tthis.$scope.empty(options);\n\t\t}\n\t});\n\n\tswapDirective.$inject = ['$compile', '$animate'];\n\tfunction swapDirective($compile, $animate){\n\t\treturn {\n\t\t\t//replace: true,\n\t\t\ttransclude: true,\n\t\t\tcontroller: swapControler,\n\t\t\tcontrollerAs: 'ctrl',\n\t\t\tcompile: function(){\n\t\t\t\treturn {\n\t\t\t\t\tpre: this.pre,\n\t\t\t\t\tpost: function(){}\n\t\t\t\t};\n\t\t\t},\n\t\t\tpre: function($scope, $element, $attr, $ctrls, $transclude) {\n\t\t\t\t$scope.enter = enter;\n\t\t\t\t$scope.empty = cleanupLast;\n\t\t\t\t$scope.refresh = refresh;\n\n\t\t\t\tvar currentScope, // the scope of the current element\n\t\t\t\t\tcurrentElement, // an entering element (up until it leaves)\n\t\t\t\t\tpreviousElement, // an element that is currently leaving\n\t\t\t\t\tparentElement = $element;\n\n\t\t\t\tfunction cleanupLast(opts) {\n\t\t\t\t\tvar options = opts || {};\n\n\t\t\t\t\tif(previousElement) {\n\t\t\t\t\t\tpreviousElement.remove();\n\t\t\t\t\t\tpreviousElement = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(currentScope) {\n\t\t\t\t\t\tcurrentScope.$destroy();\n\t\t\t\t\t\tcurrentScope = null;\n\t\t\t\t\t}\n\t\t\t\t\tif(currentElement) {\n\t\t\t\t\t\t$animate.leave(currentElement, function() {\n\t\t\t\t\t\t\tpreviousElement = null;\n\t\t\t\t\t\t\toptions.postLeave && options.postLeave();\n\t\t\t\t\t\t});\n\t\t\t\t\t\tpreviousElement = currentElement;\n\t\t\t\t\t\tcurrentElement = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction enter(props, opts){\n\t\t\t\t\tvar options = opts || {};\n\t\t\t\t\toptions.pre && options.pre();\n\n\t\t\t\t\tif (!props){\n\t\t\t\t\t\treturn cleanupLast(options);\n\t\t\t\t\t}\n\n\t\t\t\t\t// create new scope and extend it with props\n\t\t\t\t\tvar newScope = _.extend($scope.$new(), props);\n\n\t\t\t\t\t// create new element\n\t\t\t\t\t$transclude(newScope, function(clone){\n\n\t\t\t\t\t\t// @TODO: add animation info\n\t\t\t\t\t\t// clone.addClass(direction); // maybe add this to the parent? how do we control both enter and leave with this method?\n\t\t\t\t\t\taddAnimations(clone, options.animate);\n\n\t\t\t\t\t\t// First send away the previous element (if it exists)\n\t\t\t\t\t\tcleanupLast(options);\n\n\t\t\t\t\t\t// Instantiate new element\n\t\t\t\t\t\tcurrentElement = clone;\n\n\t\t\t\t\t\tcurrentScope = newScope;\n\n\t\t\t\t\t\t// Animate it in\n\t\t\t\t\t\t$animate.enter(currentElement, parentElement, null, function(){\n\t\t\t\t\t\t\toptions.post && options.post();\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tfunction refresh(props){\n\t\t\t\t\t_.extend(currentScope, props);\n\t\t\t\t}\n\n\t\t\t\tfunction addAnimations(element, animationsStr){\n\t\t\t\t\tif (!animationsStr){\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tvar animations = animationsStr.split(\" \");\n\n\t\t\t\t\t_.each(animations, function(animation){\n\t\t\t\t\t\t// Make sure that this animation exists\n\t\t\t\t\t\tif (!$injector.has(\".\" + animation + '-animation')){\n\t\t\t\t\t\t\tpiConsole(['page','animation']).error('Unknown animation type: \"' + animation + '\"');\n\t\t\t\t\t\t}\n\n\t\t\t\t\t});\n\n\t\t\t\t\telement.addClass(animationsStr);\n\t\t\t\t}\n\n\n\t\t\t}\n\t\t};\n\t};\n\n\treturn swapDirective;\n});\n","\ndefine('text!utils/helperDirectives/piSpinner/spinner.html',[],function () { return '<div>\\n\\t<img ng-if=\"spinner\" class=\"pi-logo\" src=\"img/loader.gif\" />\\n\\t<div ng-if=\"!spinner\" ng-transclude></div>\\n</div>';});\n\n","/*\n * @name: spinner Directive\n */\ndefine('utils/helperDirectives/piSpinner/piSpinnerDirective',['require','text!./spinner.html'],function (require) {\n\t// get template\n\tvar template = require('text!./spinner.html');\n\n\tdirective.$inject = [];\n\tfunction directive(){\n\t\treturn {\n\t\t\ttransclude: true,\n\t\t\treplace: true,\n\t\t\ttemplate:template,\n\t\t\trequire: [],\n\t\t\t// controller: '',\n\t\t\t// controllerAs: 'ctrl',\n\t\t\tscope:{\n\t\t\t\tspinner: '=piSpinner'\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","define('utils/helperDirectives/helperDirectivesModule',['require','angular','./piSwap/piSwapDirective','./piSpinner/piSpinnerDirective'],function(require){\n\tvar angular = require('angular');\n\tvar module = angular.module('piHelperDirective', []);\n\n\tmodule.directive('piSwap', require('./piSwap/piSwapDirective'));\n\tmodule.directive('piSpinner', require('./piSpinner/piSpinnerDirective'));\n\n\treturn module;\n});\n","define('taskManager/managerService',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tmanagerService.$inject = ['$rootScope', '$q', 'managerSequence', 'managerTaskLoad', '$injector'];\n\tfunction managerService($rootScope, $q, ManagerSequence, taskLoad, $injector){\n\n\t\t/**\n\t\t * This is the constructor for the manager object.\n\t\t *\n\t\t * The manager is responsible for the interface between the managerDirective and the managerSequence\n\t\t * It deals with loading tasks (pulled from the sequence)\n\t\t * And notifying the directive that a new task is ready to be run.\n\t\t *\n\t\t * listens to manager:next and manager:prev ==> proceeds sequence\n\t\t *\n\t\t * emits manager:loaded <== when a script is loaded\n\t\t *\n\t\t * @param  {Scope} $scope The scope to be notified\n\t\t * @param  {Object} script The manager script to be parsed\n\t\t * @return {Object}\n\t\t */\n\t\tfunction manager($scope, script){\n\t\t\tvar self = this;\n\t\t\tvar settings = script.settings || {};\n\n\t\t\t// make sure this works without a new statement\n\t\t\tif (!(this instanceof manager)){\n\t\t\t\t// jshint newcap:false\n\t\t\t\treturn new manager($scope,script);\n\t\t\t\t// jshint newcap:true\n\t\t\t}\n\n\t\t\tthis.$scope = $scope;\n\t\t\tthis.script = script;\n\n\t\t\t// create sequence\n\t\t\tthis.sequence = new ManagerSequence(script);\n\n\t\t\t// activate all setup stuff\n\t\t\tsetup($scope, settings);\n\n\t\t\t$scope.$on('manager:next', function(event, target){\n\t\t\t\ttarget || (target = {type:'next'});\n\t\t\t\tswitch (target.type){\n\t\t\t\t\tcase 'current':\n\t\t\t\t\t\tself.load(target);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'prev':\n\t\t\t\t\t\tself.prev(target);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'next':\n\t\t\t\t\t\t/* fall through */\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tself.next(target);\n\t\t\t\t}\n\t\t\t});\n\t\t\t$scope.$on('manager:prev', function(){self.prev();});\n\n\t\t}\n\n\t\t_.extend(manager.prototype, {\n\t\t\tnext: function(target){\n\t\t\t\tthis.sequence.next();\n\t\t\t\tthis.load(target);\n\t\t\t},\n\n\t\t\tprev: function(target){\n\t\t\t\tthis.sequence.prev();\n\t\t\t\tthis.load(target);\n\t\t\t},\n\n\t\t\tcurrent: function(){\n\t\t\t\t// taskLoad sets the loaded script into $script\n\t\t\t\treturn this.sequence.current();\n\t\t\t},\n\n\t\t\tload: function(target){\n\t\t\t\tvar task = this.current();\n\t\t\t\tvar $scope = this.$scope;\n\t\t\t\tvar loadOptions = {\n\t\t\t\t\tbaseUrl: this.baseUrl,\n\t\t\t\t\tbustCache: target && target.bustCache\n\t\t\t\t};\n\n\t\t\t\tif (task){\n\t\t\t\t\ttaskLoad(task, loadOptions).then(function(){\n\t\t\t\t\t\t$scope.$emit('manager:loaded');\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// let the directive deal with the end of the sequence\n\t\t\t\t\t$scope.$emit('manager:loaded');\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tsetBaseUrl: function(baseUrl){\n\t\t\t\tthis.baseUrl = baseUrl;\n\t\t\t}\n\t\t});\n\n\t\treturn manager;\n\n\t\t// just to separate the activation of all the settings: KISS\n\t\tfunction setup($scope, settings){\n\t\t\tvar canvas = $injector.get('managerCanvas');\n\t\t\tvar $document = $injector.get('$document');\n\t\t\tvar preloader = $injector.get('piPreloader');\n\t\t\tvar canvasOff;\n\n\t\t\t// activate canvas\n\t\t\tcanvasOff = canvas(settings.canvas);\n\t\t\t$scope.$on('$destroy', canvasOff);\n\n\t\t\t// preload images\n\t\t\tpreloader.loadArr('image',settings.preloadImages || []);\n\n\t\t\t// activate titles\n\t\t\tif (settings.title){\n\t\t\t\t$document[0].title = settings.title;\n\t\t\t}\n\t\t}\n\n\t}\n\n\n\treturn managerService;\n\n});\n\n","define('taskManager/managerSequence',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\tsequenceProvider.$inject = ['Database'];\n\tfunction sequenceProvider(Database){\n\n\t\t/**\n\t\t * The sequence for the manager (essentialy the model).\n\t\t * @param  {Object} script A manager script.\n\t\t * @return {Object}\n\t\t */\n\t\tfunction sequence(script){\n\t\t\tvar db;\n\t\t\t// make sure this works without a new statement\n\t\t\tif (!(this instanceof sequence)){\n\t\t\t\t// jshint newcap:false\n\t\t\t\treturn new sequence(script);\n\t\t\t\t// jshint newcap:true\n\t\t\t}\n\n\t\t\t// setup database\n\t\t\tdb = this.db = new Database();\n\t\t\tdb.createColl('tasks');\n\t\t\tdb.add('tasks', script.tasksSets || []);\n\n\t\t\t// setup sequence\n\t\t\tthis.sequence = db.sequence('tasks', script.sequence);\n\t\t}\n\n\t\t_.extend(sequence.prototype, {\n\t\t\tnext: function(){\n\t\t\t\tthis.sequence.next();\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tprev: function(){\n\t\t\t\tthis.sequence.prev();\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\tcurrent: function(){\n\t\t\t\treturn this.sequence.current();\n\t\t\t}\n\t\t});\n\n\t\treturn sequence;\n\t}\n\n\treturn sequenceProvider;\n});\n","/**\n * @name: managerLoadService\n * @returns {$q} A $q.promise that returns the target script\n */\ndefine('taskManager/managerLoadService',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\tmanagerLoadService.$inject = ['$q', 'managerGetScript'];\n\tfunction managerLoadService($q, getScript){\n\n\t\tfunction managerLoadScript(source){\n\t\t\tvar promise = _.isString(source) ? getScript(source) : source;\n\t\t\treturn $q.when(promise);\n\t\t}\n\n\t\treturn managerLoadScript;\n\t}\n\n\treturn managerLoadService;\n});\n","define('taskManager/managerGetScriptService',['require'],function(require){\n\n\tgetScriptProvider.$inject = ['$q'];\n\tfunction getScriptProvider($q){\n\n\t\t// @TODO: separate the parsing into a different module (make this a dependency)\n\t\tfunction getScript(url, options){\n\t\t\toptions || (options = {});\n\t\t\tvar def = $q.defer(),\n\t\t\t\ttarget = \"\";\n\n\t\t\t// if url doesn't starts with / or has : then add baseUrl\n           \t/^\\/|:/.test(url) || (target += options.baseUrl ? options.baseUrl + '/' : \"\");\n\n            target += url;\n\n            options.isText && (target = 'text!' + target);\n            options.bustCache && (target += \"?bust=\" + (new Date()).getTime());\n\n\t\t\trequire([target], function(script){\n\t\t\t\tdef.resolve(script);\n\t\t\t}, function(err){\n\t\t\t\tdef.reject(err);\n\t\t\t});\n\n\t\t\treturn def.promise;\n\t\t}\n\n\t\treturn getScript;\n\t}\n\n\treturn getScriptProvider;\n\n});\n","/**\n * @name: taskLoadProvider\n * @returns {$q} A $q.promise that returns the target script\n */\ndefine('taskManager/managerTaskLoadService',['require','underscore'],function(require){\n\tvar _ = require('underscore');\n\n\ttaskLoadService.$inject = ['$q', 'managerGetScript', 'piConsole'];\n\tfunction taskLoadService($q, managerGetScript, $console){\n\n\t\tfunction getScript(url, options){\n\t\t\treturn managerGetScript(url, options)\n\t\t\t\t// make sure that the script is defined\n\t\t\t\t// and if not throw an appropriate error\n\t\t\t\t.then(function(script){\n\t\t\t\t\tvar e;\n\t\t\t\t\tif (_.isUndefined(script)){\n\t\t\t\t\t\te = new Error('Task ' + url + ' failed or has not been found. Make sure that you returned the script and that your script does not have any errors');\n\t\t\t\t\t\t$console('task').error(e);\n\t\t\t\t\t\tthrow e;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn script;\n\t\t\t\t});\n\t\t}\n\n\t\tfunction taskLoad(task, options){\n\t\t\tvar promise, script, template;\n\n\t\t\t// script def\n\t\t\tif (task.scriptUrl){\n\t\t\t\tscript = getScript(task.scriptUrl, options);\n\t\t\t} else {\n\t\t\t\tscript = task.script;\n\t\t\t}\n\n\t\t\t// template def\n\t\t\tif (task.templateUrl){\n\t\t\t\ttemplate = getScript(task.templateUrl, _.extend({isText:true},options));\n\t\t\t} else {\n\t\t\t\ttemplate = task.template;\n\t\t\t}\n\n\t\t\tif (!script && !template){\n\t\t\t\tthrow new Error('Tasks must have either a \"script\" property or a \"scriptUrl\" property (or a \"template\" property in specific cases).');\n\t\t\t}\n\n\t\t\tpromise = $q.all({script: $q.when(script), template: $q.when(template)});\n\n\t\t\tpromise.then(function(promises){\n\t\t\t\ttask.$script = promises.script;\n\t\t\t\ttask.$template = promises.template;\n\t\t\t\treturn task;\n\t\t\t}, function(e){\n\t\t\t\t$console('load').error('Failed to load task script - make sure that your URLs are all correct.',e);\n\t\t\t});\n\n\t\t\treturn promise;\n\t\t}\n\n\t\treturn taskLoad;\n\t}\n\n\treturn taskLoadService;\n});\n","/**\n * Should manage various tasks.\n * For now it should simply load and activate a questionnaire.\n * Eventually it should be able to take a sequence of tasks and run them.\n * @name  managerDirctive\n * @return {directive}\n */\ndefine('taskManager/managerDirective',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\n\tmanagerControler.$inject = ['$scope', 'managerService', 'managerLoad', 'piConsole'];\n\tfunction managerControler($scope, ManagerService, managerLoad, piConsole){\n\t\tthis.init = init;\n\n\n\t\tfunction init(source){\n\t\t\tvar ctrl = this;\n\t\t\tvar taskSource;\n\n\t\t\ttry {\n\t\t\t\ttaskSource = $scope.$eval(source); // if source is a plain string eval returns undefined so we want to load this as a url\n\t\t\t} catch(e){\n\t\t\t\t// don't do anything. This means that the source is un compilable...\n\t\t\t} finally {\n\t\t\t\ttaskSource || (taskSource = source);\n\t\t\t}\n\n\t\t\tmanagerLoad(taskSource).then(success,error);\n\n\t\t\tfunction success(script){\n\t\t\t\t// takes taskSource and returns a path or undefined\n\t\t\t\tfunction getPath(path){\n\n\t\t\t\t\tif (!_.isString(path)) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn path.substring(0, path.lastIndexOf('/'));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// keep the script on scope\n\t\t\t\t$scope.script = script;\n\t\t\t\t$scope.settings = (script && script.settings) || {};\n\n\t\t\t\t// create the manager\n\t\t\t\tctrl.manager = new ManagerService($scope, script);\n\t\t\t\tctrl.manager.setBaseUrl(getPath(taskSource));\n\n\t\t\t\t// activate first task\n\t\t\t\t$scope.$emit('manager:next');\n\t\t\t}\n\n\t\t\tfunction error(e){\n\t\t\t\tpiConsole('manager').error('Failed to load ' + taskSource, e);\n\t\t\t}\n\t\t}\n\t}\n\n\tdirective.$inject = ['$q', '$injector', 'piConsole'];\n\tfunction directive($q, $injector,piConsole){\n\t\treturn {\n\t\t\tpriority: 1000,\n\t\t\treplace:true,\n\t\t\ttemplate: '<div pi-swap><div pi-task=\"task\" ng-class=\"{\\'pi-spinner\\':loading}\"></div></div>',\n\t\t\tcontroller: managerControler,\n\t\t\trequire: ['piManager', 'piSwap'],\n\t\t\tlink:  function($scope, $element, attr, ctrl){\n\t\t\t\tvar swap = ctrl[1], thisCtrl = ctrl[0];\n\t\t\t\tvar currentTask, prevTask;\n\n\t\t\t\tthisCtrl.init(attr.piManager);\n\n\t\t\t\t$scope.$on('manager:loaded', loaded);\n\t\t\t\t$scope.$on('task:done', taskDone);\n\t\t\t\t$scope.loading = true;\n\n\t\t\t\tfunction loaded(){\n\t\t\t\t\t$scope.loading = false;\n\n\t\t\t\t\t// keep previous task\n\t\t\t\t\tprevTask = currentTask;\n\n\t\t\t\t\t// get loaded task\n\t\t\t\t\tcurrentTask = thisCtrl.manager.current();\n\t\t\t\t\tpiConsole('manager').debug('Manager:currentTask', currentTask);\n\n\t\t\t\t\t// procced or and manager\n\t\t\t\t\tcurrentTask ? proceed() : done();\n\t\t\t\t}\n\n\t\t\t\tfunction proceed(){\n\t\t\t\t\tvar locals = {prevTask: prevTask, currentTask: currentTask};\n\t\t\t\t\t$qSequence([\n\t\t\t\t\t\t$scope.settings.onPreTask,\n\t\t\t\t\t\tprevTask && prevTask.post,\n\t\t\t\t\t\tcurrentTask.pre,\n\t\t\t\t\t\t_.bind(swap.next, swap, {task:currentTask, settings:$scope.settings}),\n\t\t\t\t\t\tfunction(){\n\t\t\t\t\t\t\t$scope.loading = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t], locals);\n\t\t\t\t}\n\n\t\t\t\tfunction done(){\n\t\t\t\t\tvar locals = {prevTask: prevTask, currentTask: currentTask};\n\t\t\t\t\t$qSequence([\n\t\t\t\t\t\tprevTask && prevTask.post,\n\t\t\t\t\t\t_.bind(swap.empty, swap),\n\t\t\t\t\t\t$scope.settings.onEnd,\n\t\t\t\t\t\tfunction(){\n\t\t\t\t\t\t\t$scope.loading = false;\n\t\t\t\t\t\t\t$scope.$emit('manager:done');\n\t\t\t\t\t\t}\n\t\t\t\t\t], locals);\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * This is called uppon task:done\n\t\t\t\t * It is responsible for proceeding to the following task\n\t\t\t\t * @param  {Event} ev   The event that triggered the taskdone\n\t\t\t\t * @param  {Object} args An object that describes the direction of proceeding\n\t\t\t\t */\n\t\t\t\tfunction taskDone(ev, args){\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\t$scope.loading = true;\n\t\t\t\t\t$scope.$emit('manager:next', args);\n\t\t\t\t}\n\n\t\t\t\t/**\n\t\t\t\t * chain a series of functions/promises/undefined\n\t\t\t\t * @param  {Array} arr an array of functions etc.\n\t\t\t\t * @return {promise}\n\t\t\t\t */\n\t\t\t\tfunction $qSequence(arr, locals){\n\t\t\t\t\tvar promise = $q.when();\n\n\t\t\t\t\t_(arr)\n\t\t\t\t\t\t// map into then functions\n\t\t\t\t\t\t.map(function(value){\n\t\t\t\t\t\t\treturn function(){\n\t\t\t\t\t\t\t\tvar prms = _.isFunction(value) ? $injector.invoke(value,null,locals||{}) : value;\n\t\t\t\t\t\t\t\treturn $q.when(prms);\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.reduce(function(promise, fn){\n\t\t\t\t\t\t\treturn promise.then(fn, function(e){\n\t\t\t\t\t\t\t\tpiConsole('manager').error('There was an error in the task sequence. ',e);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}, promise);\n\t\t\t\t}\n\n\t\t\t}\n\t\t};\n\t}\n\n\n\treturn directive;\n});\n","define('taskManager/managerTaskDirective',[],function(){\n\n\tfunction directive(){\n\t\treturn {\n\t\t\tpriority: 1000,\n\t\t\ttemplate: '<div pi-manager=\"script\"></div>',\n\t\t\tcompile: function(){\n\t\t\t\treturn {\n\t\t\t\t\t// this need to be pre so that the wrapping directive gets rendered before the template\n\t\t\t\t\tpre: function($scope, $element, $attr){\n\t\t\t\t\t\tvar taskSource;\n\t\t\t\t\t\tvar source = $attr.piManagerTask;\n\t\t\t\t\t\ttry{\n\t\t\t\t\t\t\ttaskSource = $scope.$eval(source);\n\t\t\t\t\t\t} catch(e){}\n\n\t\t\t\t\t\tvar task  = taskSource ? taskSource : {scriptUrl:source};\n\n\t\t\t\t\t\t$scope.script = {\n\t\t\t\t\t\t\tsequence: [task]\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t}\n\n\treturn directive;\n});\n","define('taskManager/managerModule',['require','angular','./task/taskModule','./canvas/canvasModule','utils/utils/utilsModule','utils/helperDirectives/helperDirectivesModule','utils/console/consoleModule','./managerService','./managerSequence','./managerLoadService','./managerGetScriptService','./managerTaskLoadService','./managerDirective','./managerTaskDirective'],function(require){\n\n\tvar angular = require('angular');\n\tvar module = angular.module('taskManager',[\n\t\trequire('./task/taskModule').name,\n\t\trequire('./canvas/canvasModule').name,\n\t\trequire('utils/utils/utilsModule').name,\n\t\trequire('utils/helperDirectives/helperDirectivesModule').name,\n\t\trequire('utils/console/consoleModule').name\n\t]);\n\n\tmodule.service('managerService', require('./managerService'));\n\tmodule.service('managerSequence', require('./managerSequence'));\n\tmodule.service('managerLoad', require('./managerLoadService'));\n\tmodule.service('managerGetScript', require('./managerGetScriptService'));\n\tmodule.service('managerTaskLoad', require('./managerTaskLoadService'));\n\tmodule.directive('piManager', require('./managerDirective'));\n\tmodule.directive('piManagerTask', require('./managerTaskDirective'));\n\n\treturn module;\n});\n","// Adapted from https://gist.github.com/paulirish/1579671 which derived from\n// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n// http://my.opera.com/emoller/blog/2011/12/20/requestanimationframe-for-smart-er-animating\n\n// requestAnimationFrame polyfill by Erik Möller.\n// Fixes from Paul Irish, Tino Zijdel, Andrew Mao, Klemen Slavič, Darius Bacon\n\n// MIT license\n\ndefine('utils/animations/rafPolyfill',[],function() {\n    var vendors = ['webkit', 'moz'];\n    for (var i = 0; i < vendors.length && !window.requestAnimationFrame; ++i) {\n        var vp = vendors[i];\n        window.requestAnimationFrame = window[vp+'RequestAnimationFrame'];\n        window.cancelAnimationFrame = (window[vp+'CancelAnimationFrame'] || window[vp+'CancelRequestAnimationFrame']);\n    }\n    if (\n    \t/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent) || // iOS6 is buggy\n        !window.requestAnimationFrame || !window.cancelAnimationFrame\n    ) {\n        var lastTime = 0;\n        window.requestAnimationFrame = function(callback) {\n            var now = +new Date();\n            var nextTime = Math.max(lastTime + 16, now);\n            return setTimeout(function() { callback(lastTime = nextTime); },\n                              nextTime - now);\n        };\n        window.cancelAnimationFrame = clearTimeout;\n    }\n});\n\n","define('utils/animations/dropInAnimation',[],function(){\n\n\tfunction animation($window, now){\n\n\t\tvar topdx = 60;\n\t\tvar duration = 300;\n\t\tvar raf = $window.requestAnimationFrame;\n\t\tvar rafCancel = $window.cancelAnimationFrame;\n\n\t\treturn {\n\t\t\tenter: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// setup\n\t\t\t\telement.css({\n\t\t\t\t\ttop: -topdx +'px'\n\t\t\t\t});\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(enter);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\telement.css({top: '0px'});\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction enter(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\tel.style.top = 0;\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.top = (topdx * (proportion-1)) + 'px';\n\t\t\t\t\tcancelId = raf(enter);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tleave: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(leave);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction leave(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = 1-deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.top = (topdx * (proportion-1)) + 'px';\n\t\t\t\t\tcancelId = raf(leave);\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\t}\n\n\t// $inject doesn't seem to work??\n \treturn ['$window', 'timerNow', animation];\n});\n","define('utils/animations/fadeAnimation',[],function(){\n\n\tfunction animation($window, now){\n\n\t\tvar duration = 300;\n\t\tvar raf = $window.requestAnimationFrame;\n\t\tvar rafCancel = $window.cancelAnimationFrame;\n\n\t\treturn {\n\t\t\tenter: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// setup\n\t\t\t\tel.style.opacity = 0;\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(enter);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tel.style.opacity = 1;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction enter(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\tel.style.opacity = 1;\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.opacity = proportion;\n\t\t\t\t\tcancelId = raf(enter);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tleave: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(leave);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tel.style.opacity = 0;\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction leave(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = 1-deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\tel.style.opacity = 0;\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.opacity = proportion;\n\t\t\t\t\tcancelId = raf(leave);\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\t}\n\n\t// $inject doesn't seem to work??\n \treturn ['$window', 'timerNow', animation];\n});\n","define('utils/animations/slideAnimation',[],function(){\n\n\tfunction animation($window, now){\n\n\t\tvar duration = 300;\n\t\tvar raf = $window.requestAnimationFrame;\n\t\tvar rafCancel = $window.cancelAnimationFrame;\n\n\t\treturn {\n\t\t\tenter: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// setup\n\t\t\t\tel.style.left = '-100%';\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(enter);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tel.style.left = '0%';\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction enter(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = 1 - deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\tel.style.left = '0%';\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.left = (-proportion*100) + '%';\n\n\t\t\t\t\tcancelId = raf(enter);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tleave: function(element, done){\n\t\t\t\tvar el = element[0]; // raw element;\n\t\t\t\tvar cancelId;\n\t\t\t\tvar start = now();\n\n\t\t\t\t// activate animation\n\t\t\t\tcancelId = raf(leave);\n\n\t\t\t\treturn function(canceled){\n\t\t\t\t\tif (canceled){\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tel.style.left = '100%';\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tfunction leave(){\n\t\t\t\t\tvar deltaTime = now() - start;\n\t\t\t\t\tvar proportion = deltaTime/duration;\n\n\t\t\t\t\t// if we're out of time, finish the animation\n\t\t\t\t\tif (deltaTime > duration) {\n\t\t\t\t\t\tel.style.left = '100%';\n\t\t\t\t\t\trafCancel(cancelId);\n\t\t\t\t\t\tdone();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tel.style.left = (proportion*100) + '%';\n\t\t\t\t\tcancelId = raf(leave);\n\t\t\t\t}\n\t\t\t}\n\n\t\t};\n\t}\n\n\t// $inject doesn't seem to work??\n \treturn ['$window', 'timerNow', animation];\n});\n","define('utils/animations/animationModule',['require','angular','animate','./rafPolyfill','./dropInAnimation','./fadeAnimation','./slideAnimation'],function(require){\n\tvar angular = require('angular');\n\trequire('animate');\n\trequire('./rafPolyfill');\n\n\tvar module = angular.module('pi.animate',['ngAnimate']);\n\n\tmodule.animation('.drop-in', require('./dropInAnimation'));\n\tmodule.animation('.fade', require('./fadeAnimation'));\n\tmodule.animation('.slide', require('./slideAnimation'));\n\n\treturn module;\n});\n","/**\n *\tThe main module that ties the whole application together.\n *\tEssentially, we are creating a module with dependencies on anything interesting...\n */\ndefine('app',['require','angular','underscore','quest/questModule','message/messageModule','taskManager/managerModule','utils/animations/animationModule','utils/console/consoleModule'],function (require) {\n\n\tvar angular = require('angular');\n\tvar _ = require('underscore');\n\n\tvar submodules = [\n\t\trequire('quest/questModule').name,\n\t\trequire('message/messageModule').name,\n\t\trequire('taskManager/managerModule').name,\n\t\trequire('utils/animations/animationModule').name,\n\t\trequire('utils/console/consoleModule').name\n\t];\n\n\tvar app = angular.module('piApp', submodules);\n\n\t// setup the global variable\n\tapp.run(['$rootScope', '$rootElement', '$parse', '$window', function($rootScope, $rootElement, $parse, $window){\n\t\t// @TODO: get these out of here (app.config? app.run?)\n\t\tvar globalAttr = $rootElement.attr('pi-global');\n\t\tvar piGlobal = $parse(globalAttr)($window);\n\n\t\t// create the global object\n\t\twindow.piGlobal || (window.piGlobal = {});\n\t\t$rootScope.global = window.piGlobal;\n\n\t\tif (piGlobal){\n\t\t\t_.extend($rootScope.global, piGlobal);\n\t\t}\n\t}]);\n\n\treturn app;\n});\n","define(\"pipScorer/computeD\",[\"jquery\"],function(e){function r(){e.extend(this,{dataArray:{},AnalyzedVar:\"latency\",ErrorVar:\"error\",condVar:\"\",cond1VarValues:[],cond2VarValues:[],parcelVar:\"\",parcelValue:[],fastRT:300,maxFastTrialsRate:.1,minRT:400,maxRT:1e4,maxErrorParcelRate:.4,errorLatency:{use:\"latency\",penalty:600,useForSTD:!0},postSettings:{}})}return e.extend(r.prototype,{setComputeObject:function(r){e.extend(this,r)},setDataArray:function(){var e=window.piGlobal;this.dataArray=e.current.logs}}),r}),define(\"pipScorer/msgMan\",[\"underscore\"],function(e){function r(){this.messages=e.extend({},a)}var a={MessageDef:[],manyErrors:\"There were too many errors made to determine a result.\",tooFast:\"There were too many fast trials to determine a result.\",notEnough:\"There were not enough trials to determine a result.\"};return e.extend(r.prototype,{setMsgObject:function(r){e.extend(this.messages,r)},getScoreMsg:function(r){var a=this.messages.MessageDef;if(!a||!a.length)throw new Error('You must define a \"MessageDef\" array.');var t=parseFloat(r),n=null,o=null,s=\"error: msg was not set\",c=!1;if(e.each(a,function(e){n=parseFloat(e.cut),o=e.message,n>=t&&!c&&(s=o,c=!0)}),!c){var i=a.length,u=a[i-1];s=u.message}return s},getMessage:function(e){return this.messages[e]}}),r}),define(\"pipScorer/parcelMng\",[\"underscore\"],function(e){function r(e){this.parcelArray=[],this.scoreData={},this.msgMan=e}return e.extend(r.prototype,{Init:function(r){var a=this,t=this.msgMan,n=window.piGlobal,o=n.current.logs;a.parcelArray=[],a.scoreData={},a.msgMan=t;var s=r.AnalyzedVar,c=r.ErrorVar,i=r.parcelVar,u=r.parcelValue,l=r.minRT,g=r.maxRT,h=r.fastRT,p=0,f=0,d=0,v=0,m=parseFloat(r.maxFastTrialsRate);if(\"undefined\"==typeof u||0===u.length){d=0,p=0,f=0,v=0;var y={};y.name=\"general\",y.trialIData=[],e.each(o,function(e){e[s]>=l&&e[s]<=g?(d++,1==e.data[c]&&v++,a.validate(y,e,r)&&p++):e[s]<=h&&f++}),a.checkErrors(d,v,r),a.parcelArray[0]=y}else e.each(u,function(t,n){d=0,p=0,f=0,v=0;var u={};u.name=t,u.trialIData=[],e.each(o,function(e){var n=e.data[i];n==t&&(e[s]>=l&&e[s]<=g?(d++,1==e.data[c]&&v++,a.validate(u,e,r)&&p++):e[s]<=h&&f++)}),a.checkErrors(d,v,r),a.parcelArray[n]=u});f/p>m&&(a.scoreData.errorMessage=this.msgMan.getMessage(\"tooFast\"))},checkErrors:function(e,r,a){var t=a.maxErrorParcelRate;r/e>t&&(this.scoreData.errorMessage=this.msgMan.getMessage(\"manyErrors\"))},validate:function(e,r,a){var t=a.errorLatency,n=a.ErrorVar,o=r.data;return\"latency\"==t.use?(e.trialIData.push(r),!0):\"false\"==t.use?\"1\"==o[n]?!1:(e.trialIData.push(r),!0):\"penalty\"==t.use?(e.trialIData.push(r),!0):void 0},addPenalty:function(r,a){var t=a.errorLatency,n=this;if(\"penalty\"==t.use){var o=parseFloat(t.penalty),s=a.ErrorVar,c=a.AnalyzedVar,i=a.condVar,u=a.cond1VarValues,l=a.cond2VarValues,g=r.trialIData,h=r.avgCon1,p=r.avgCon2;e.each(g,function(e){var r=e.data,a=r[s],t=r[i],g=n.checkArray(t,u),f=n.checkArray(t,l);\"1\"==a&&(g?e[c]+=h+o:f&&(e[c]+=p+o))})}},avgAll:function(r){var a=this;e.each(a.parcelArray,function(e){a.avgParcel(e,r)})},avgParcel:function(r,a){var t=this,n=r.trialIData,o=a.condVar,s=a.cond1VarValues,c=a.cond2VarValues,i=a.AnalyzedVar,u=0,l=0,g=0,h=0,p=0,f=0;e.each(n,function(e){var r=e[i],a=e.data;g+=r,f++;var n=a[o],d=t.checkArray(n,s),v=t.checkArray(n,c);d?(h++,u+=r):v&&(p++,l+=r)}),(2>=h||2>=p)&&(t.scoreData.errorMessage=this.msgMan.getMessage(\"notEnough\")),0!==h&&(u/=h),0!==p&&(l/=p),r.avgCon1=u,r.avgCon2=l,r.diff=r.avgCon1-r.avgCon2,0!==f&&(r.avgBoth=g/f),t.addPenalty(r,a)},checkArray:function(e,r){for(var a=0;a<r.length;a++){var t=r[a];if(t==e)return!0}return!1},varianceAll:function(r){var a=this;e.each(a.parcelArray,function(e){a.varianceParcel(e,r)})},varianceParcel:function(r,a){var t=this,n=a.AnalyzedVar,o=r.trialIData,s=a.cond1VarValues,c=a.cond2VarValues,i=a.condVar,u=r.avgBoth,l=0,g=0,h=[],p=[],f=[],d=a.errorLatency,v=d.useForSTD;e.each(o,function(e){var r=e.data,o=e[n],u=a.ErrorVar,l=r[u],g=r[i],f=t.checkArray(g,s),d=t.checkArray(g,c);f?v?h.push(o):\"0\"==l&&h.push(o):d&&(v?p.push(o):\"0\"==l&&h.push(o))}),f=h.concat(p),e.each(f,function(e){var r=e;l=r-u,g+=l*l}),r.variance=g/(f.length-1)},scoreAll:function(r){var a=this,t=0;e.each(a.parcelArray,function(e){a.scoreParcel(e,r),t+=e.score});var n=t/a.parcelArray.length;a.scoreData.score=n.toFixed(2)},scoreParcel:function(e){var r=this,a=Math.sqrt(e.variance);0===a?(r.scoreData.errorMessage=this.msgMan.getMessage(\"notEnough\"),e.score=e.diff):e.score=e.diff/a}}),r}),define(\"pipScorer/Scorer\",[\"jquery\",\"./computeD\",\"./msgMan\",\"./parcelMng\"],function(e,r,a,t){function n(){this.computeData=new r,this.msgMan=new a,this.parcelMng=new t(this.msgMan)}return!!window.console||(console={log:e.noop,error:e.noop}),console.log||(console.log=function(){}),e.extend(n.prototype,{addSettings:function(e,r){switch(e){case\"compute\":this.computeData.setComputeObject(r);break;case\"message\":this.msgMan.setMsgObject(r);break;default:throw new Error('SCORER:addSettings: unknow \"type\" '+e)}},computeD:function(){var e=this.computeData,r=this.parcelMng;e.setDataArray(),r.Init(e),r.avgAll(e),r.varianceAll(e),r.scoreAll(e);var a=r.scoreData,t={};return void 0===a.errorMessage||null===a.errorMessage?(t.FBMsg=this.getFBMsg(a.score),t.DScore=a.score):(t.FBMsg=a.errorMessage,t.DScore=\"\"),t},postToServer:function(r,a,t,n){var o=this.computeData.postSettings||{},s=o.url,c={};return t||(t=o.score),n||(n=o.msg),c[t]=r,c[n]=a,e.post(s,JSON.stringify(c))},dynamicPost:function(r){var a=this.computeData.postSettings||{},t=a.url;return e.post(t,JSON.stringify(r))},getFBMsg:function(e){var r=this.msgMan.getScoreMsg(e);return r}}),n}),define(\"pipScorer\",[\"pipScorer/Scorer\"],function(e){return e});\n//# sourceMappingURL=Scorer.js.map;\ndefine('pipScorer', ['pipScorer/Scorer'], function (main) { return main; });\n\n","define('APIs/APIConstructor',['require','underscore'],function(require){\n\n\twindow.piGlobal || (window.piGlobal = {});\n\n\tvar _ = require('underscore');\n\tvar global = window.piGlobal;\n\n\t/**\n\t * Create a new API\n\t * @param {Object} options\n\t * {\n\t * \t\ttype: 'PIP',\n\t * \t\tsets: ['trial', 'stimulus', 'media']\n\t * }\n\t */\n\tfunction APIconstructor(options){\n\n\t\tfunction API(){\n\t\t\tvar script = this.script = {\n\t\t\t\tname: 'anonymous ' + options.type,\n\t\t\t\tsettings: {},\n\t\t\t\tcurrent: {}, // this is the actual namespace for this PIP\n\t\t\t\tsequence: []\n\t\t\t};\n\n\t\t\tthis.settings = script.settings;\n\n\t\t\t// create set arrays\n\t\t\t_.forEach(options.sets, function(set){\n\t\t\t\tscript[set + 'Sets'] = [];\n\t\t\t});\n\t\t}\n\n\t\t_.forEach(options.sets, function(set){\n\t\t\tAPI.prototype[_.camelCase('add-' + set + '-set')] = add_set(set);\n\t\t});\n\n\t\t_.extend(API.prototype, {\n\n\t\t\tsetName: function(name){\n\t\t\t\tthis.script.name = name;\n\t\t\t},\n\n\t\t\t// settings\n\t\t\taddSettings: function(name, settingsObj){\n\t\t\t\tvar settings;\n\n\n\n\t\t\t\tif (_.isPlainObject(settingsObj)){\n\t\t\t\t\tsettings = this.settings[name] = this.settings[name] || {};\n\t\t\t\t\t_.extend(settings, settingsObj);\n\t\t\t\t} else {\n\t\t\t\t\tthis.settings[name] = settingsObj;\n\t\t\t\t}\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\taddSequence: function(sequence){\n\t\t\t\tvar script = this.script;\n\t\t\t\t_.isArray(sequence) || (sequence = [sequence]);\n\n\t\t\t\tscript.sequence = script.sequence.concat(sequence);\n\n\t\t\t\treturn this;\n\t\t\t},\n\n\t\t\taddGlobal: function(obj){\n\t\t\t\tif (!_.isPlainObject(obj)){\n\t\t\t\t\tthrow new Error('global must be an object');\n\t\t\t\t}\n\t\t\t\treturn _.merge(global, obj);\n\t\t\t},\n\n\t\t\tgetGlobal: function(){\n\t\t\t\treturn global;\n\t\t\t},\n\n\t\t\taddCurrent: function(obj){\n\t\t\t\tif (!_.isPlainObject(obj)){\n\t\t\t\t\tthrow new Error('current must be an object');\n\t\t\t\t}\n\t\t\t\treturn _.merge(this.script.current, obj);\n\t\t\t},\n\n\t\t\tgetCurrent: function(){\n\t\t\t\treturn this.script.current;\n\t\t\t},\n\n\t\t\t// push a whole script\n\t\t\taddScript: function(obj){\n\t\t\t\treturn _.merge(this.script,obj);\n\t\t\t},\n\n\t\t\t// returns script (for debuging probably)\n\t\t\tgetScript: function(){\n\t\t\t\treturn this.script;\n\t\t\t},\n\n\t\t\t// name, response, taskName, taskNumber\n\t\t\tpost: function(url, obj){\n\t\t\t\t// just so we can use this in standalone PIP\n\t\t\t\tif (require.defined('jquery')){\n\t\t\t\t\treturn require('jquery' + '').ajax({\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t\tdata: JSON.stringify(obj),\n\t\t\t\t\t\tcontentType: \"application/json; charset=utf-8\",\n\t\t\t\t\t\tdataType: \"json\"\n\t\t\t\t\t});\n\n\t\t\t\t\t//.post(url, JSON.stringify(obj));\n\t\t\t\t} else {\n\t\t\t\t\tvar $injector = angular.injector(['ng']);\n\n\t\t\t\t\treturn $injector.invoke(['$http', function($http){\n\t\t\t\t\t\treturn $http.post(url, obj);\n\t\t\t\t\t}]);\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tshuffle: function(collection){\n\t\t\t\treturn _.shuffle(collection);\n\t\t\t}\n\t\t});\n\n\t\treturn API;\n\n\t}\n\n\n\t /**\n\t  * Create a function that adds sets of a scpecific type\n\t  * @param {String} type  \tThe type of set setter to create\n\t  * @returns {Function} \tA setter object\n\t  */\n\tfunction add_set(type){\n\n\t\t/**\n\t\t * Adds a set to the targetSet\n\t\t * @param {String, Object} set    \tEither full set object, or the name of this setArr\n\t\t * @param {Array} setArr \t\t\tAn array of objects for this set\n\t\t * @returns {Object} The API object\n\t\t *\n\t\t * use examples:\n\t\t * fn({\n\t\t *   intro: [intro1, intro2],\n\t\t *   Default: [defaultTrial]\n\t\t * })\n\t\t * fn('intro',[intro1, intro2])\n\t\t * fn('Default',defaultTrial)\n\t\t *\n\t\t */\n\t\tfunction setSetter(set, setArr){\n\n\t\t\t// get the sets we want to extend (or create them)\n\t\t\tvar targetSets = this.script[type + \"Sets\"] || (this.script[type + \"Sets\"] = []);\n\t\t\tvar list;\n\n\t\t\tif (_.isPlainObject(set)) {\n\t\t\t\tlist = _(set)\n\t\t\t\t\t// for each set of elements\n\t\t\t\t\t.map(function(value, key){\n\t\t\t\t\t\t// add the set name to each key\n\t\t\t\t\t\t_.each(value, function(v){v.set = key;});\n\t\t\t\t\t\treturn value; // return the set\n\t\t\t\t\t})\n\t\t\t\t\t.flatten() // flatten all sets to a single array\n\t\t\t\t\t.value();\n\t\t\t}\n\n\t\t\tif (_.isArray(set)){\n\t\t\t\tlist = set;\n\t\t\t}\n\n\t\t\tif (_.isString(set)){\n\t\t\t\tlist = _.isArray(setArr) ? setArr : [setArr];\n\t\t\t\tlist = _.map(list, function(value){\n\t\t\t\t\tvalue.set = set;\n\t\t\t\t\treturn value;\n\t\t\t\t});\n\n\t\t\t}\n\n\t\t\t// merge the list into the targetSet\n\t\t\ttargetSets.push.apply(targetSets, list);\n\t\t}\n\n\t\treturn setSetter;\n\t}\n\n\treturn APIconstructor;\n});\n","define('pipAPI/pipAPI',['require','APIs/APIConstructor'],function(require){\n\tvar factory = require('APIs/APIConstructor');\n\n\tvar api = factory({\n\t\ttype: 'PIP',\n\t\tsets: ['trial', 'stimulus','media']\n\t});\n\n\tapi.prototype.addTrialSets = api.prototype.addTrialSet;\n\tapi.prototype.addStimulusSets = api.prototype.addStimulusSet;\n\tapi.prototype.addMediaSets = api.prototype.addMediaSet;\n\n\tapi.prototype.getLogs = function getLogs(){\n\t\treturn this.script.current.logs;\n\t};\n\n\treturn api;\n});\n","define('APIs/pi/APIdecorator',['require','underscore'],function(require){\n\n\tvar _ = require('underscore');\n\tvar counter = 1000;\n\n\tfunction APIdecorator(constructor){\n\t\tconstructor.prototype.save = save;\n\t}\n\n\treturn APIdecorator;\n\n\tfunction save(obj){\n\t\tvar script = this.script;\n\t\tif (!_.isPlainObject(obj)){\n\t\t\tthrow new Error('API.save can send only objects.');\n\t\t}\n\n\t\tvar meta = {\n\t\t\ttaskName: script.name,\n\t\t\ttaskNumber: script.serial || 0\n\t\t};\n\n\t\tvar arr = _.map(obj, function(value, key){\n\t\t\treturn _.extend({\n\t\t\t\tname: key,\n\t\t\t\tresponse: value,\n\t\t\t\tserial: ++counter\n\t\t\t}, meta);\n\t\t});\n\n\t\treturn this.post('/implicit/PiQuest', arr);\n\t}\n\n});\n","define('pipAPI/pi/pipAPI',['require','../pipAPI','underscore','APIs/pi/APIdecorator'],function(require){\n\n\tvar Constructor = require('../pipAPI');\n\tvar _ = require('underscore');\n\tvar isDev = /^(localhost|127.0.0.1)/.test(location.host);\n\tvar decorator = require('APIs/pi/APIdecorator');\n\n\t/**\n\t * Constructor for PIPlayer script creator\n\t * @return {Object}\t\tScript creator\n\t */\n\tfunction API(name){\n\t\tConstructor.call(this, name);\n\n\t\tvar settings = this.settings;\n\t\tvar script = this.script;\n\n\t\tsettings.logger = {\n\t\t\tpulse: 20,\n\t\t\turl : '/implicit/PiPlayerApplet'\n\t\t};\n\n\t\t// the activation function\n\t\tscript.play = play;\n\n\t\t// the url builder for play\n\t\tscript.buildBaseUrl = buildBaseUrl;\n\n\t\tisDev && (script.version = 'DEV!');\n\t}\n\n\tdecorator(API);\n\n\t// create API functions\n\t_.extend(API.prototype, Constructor.prototype);\n\tAPI.prototype.setVersion = function setVersion(ver){this.script.version = ver;};\n\n\t// annotate the play function\n\tplay.$inject = ['done', '$element', 'script', 'task'];\n\n\treturn API;\n\n\t/**\n\t * The activator function for pip\n\t * (anotated up in the main code)\n\t */\n\tfunction play(done, $canvas, script, task){\n\t\tvar $el, req, baseUrl ,version = task.version || this.version;\n\n\t\tif (task.type !== 'pip'){\n\t\t\tthrow new Error('Expected task.type to be \"pip\" but found: \"' + task.type + '\".');\n\t\t}\n\n\t\tif (!version){\n\t\t\tthrow new Error('Version not defined for pip task: ' + (task.name || script.name));\n\t\t}\n\n\t\tbaseUrl = this.buildBaseUrl(version);\n\n\t\t// load PIP\n\t\treq = requirejs.config({\n\t\t\tcontext: _.uniqueId(),\n\t\t\tbaseUrl: baseUrl+ (isDev ? 'src/js' : '/dist/js/'), // can't use packages yet as urls in pip aren't relative...\n\t\t\tpaths: {\n\t\t\t\t//plugins\n\t\t\t\ttext: ['//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.3/text.min', baseUrl+\"/bower_components/requirejs-text/text\"],\n\n\t\t\t\t// Core Libraries\n\t\t\t\tjquery: [\"//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min\",baseUrl+\"/bower_components/jquery/dist/jquery.min\"],\n\t\t\t\tunderscore: [\"//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min\",baseUrl+\"/bower_components/lodash-compat/lodash.min\"],\n\t\t\t\tbackbone: ['//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min', baseUrl+\"/bower_components/backbone/backbone\"]\n\t\t\t},\n\n\t\t\tdeps: ['jquery', 'backbone', 'underscore']\n\t\t});\n\n\t\t// update script name\n\t\ttask.name && (script.name = task.name);\n\n\t\t$canvas.append('<div pi-player></div>');\n\t\t$el = $canvas.contents();\n\t\t$el.addClass('pi-spinner');\n\n\t\treq(['activatePIP'], function(activate){\n\t\t\t$el.removeClass('pi-spinner');\n\t\t\tactivate(script, done);\n\t\t});\n\n\t\treturn function destroyPIP(){\n\t\t\t$el.remove();\n\t\t\treq(['app/task/main_view'], function(main){\n\t\t\t\tmain.deferred.resolve();\n\t\t\t\tmain.destroy();\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n\t * Build BaseUrl from version\n\t * @param  {string} version pip version\n\t * @return {string}         baseUrl\n\t */\n\tfunction buildBaseUrl(version){\n\t\treturn isDev ? '/pip/' : '/implicit/common/all/js/pip/'+version;\n\t}\n\n});\n","define('questAPI/questAPI',['require','APIs/APIConstructor'],function(require){\n\tvar api = require('APIs/APIConstructor');\n\n\treturn api({\n\t\ttype: 'quest',\n\t\tsets: ['pages', 'questions']\n\t});\n});\n","define('questAPI/pi/questAPI',['require','../questAPI','APIs/pi/APIdecorator','underscore'],function(require){\n\n\tvar Constructor = require('../questAPI');\n\tvar decorator = require('APIs/pi/APIdecorator');\n\tvar _ = require('underscore');\n\n\t/**\n\t * Constructor for PIPlayer script creator\n\t * @return {Object}\t\tScript creator\n\t */\n\tfunction API(){\n\t\tConstructor.call(this);\n\n\t\tthis.settings.logger = {\n\t\t\turl: '/implicit/PiQuest'\n\t\t};\n\t}\n\n\tdecorator(API);\n\n\t// create API functions\n\t_.extend(API.prototype, Constructor.prototype);\n\n\treturn API;\n\n\n});\n","define('managerAPI/managerAPI',['require','APIs/APIConstructor'],function(require){\n\tvar api = require('APIs/APIConstructor');\n\n\treturn api({\n\t\ttype: 'manager',\n\t\tsets: ['tasks']\n\t});\n});\n","\ndefine('text!managerAPI/pi/messageTemplate.jst',[],function () { return '<div class=\"panel panel-info\" style=\"margin-top:1em\">\\n\\t<% if (task.header){ %>\\n\\t\\t<div class=\"panel-heading\">\\n\\t\\t\\t<h1 class=\"panel-title\" style=\"font-size:2em\"><%= task.header %></h1>\\n\\t\\t</div>\\n\\t<% } %>\\n\\n\\t<div class=\"panel-body\">\\n\\t\\t<%= content %>\\n\\t\\t<div class=\"text-center\" style=\"margin: 30px auto 10px;\">\\n\\t\\t\\t<button pi-message-done type=\"button\" class=\"btn btn-primary\">\\n\\t\\t\\t\\t<% if (task.buttonText){ %>\\n\\t\\t\\t\\t\\t<%= task.buttonText %>\\n\\t\\t\\t\\t<% } else { %>\\n\\t\\t\\t\\t\\tClick Here or press the space button to Proceed\\n\\t\\t\\t\\t<% } %>\\n\\t\\t\\t</button>\\n\\t\\t</div>\\n\\t</div>\\n\\n\\t<% if (task.footer){ %>\\n\\t\\t<div class=\"panel-footer\">\\n\\t\\t\\t<%= task.footer %>\\n\\t\\t</div>\\n\\t<% } %>\\n</div>\\n<div style=\"text-align:center; padding: 1em\">&middot; Project Implicit &middot;</div>';});\n\n","\ndefine('text!managerAPI/pi/messageTemplateDebrief.jst',[],function () { return '<style type=\"text/css\">\\n\\t.navbar-inverse .navbar-nav > li > a {color:#dbdbdb;font-weight: bold;}\\n</style>\\n<nav class=\"navbar navbar-inverse navbar-fixed-top\">\\n\\t<div class=\"container\">\\n\\t\\t<div class=\"navbar-header\">\\n\\t\\t\\t<button type=\"button\" class=\"navbar-toggle collapsed\" ng-click=\"showNavbar = !showNavbar\" aria-expanded=\"false\" aria-controls=\"navbar\">\\n\\t\\t\\t\\t<span class=\"sr-only\">Toggle navigation</span>\\n\\t\\t\\t\\t<span class=\"icon-bar\"></span>\\n\\t\\t\\t\\t<span class=\"icon-bar\"></span>\\n\\t\\t\\t\\t<span class=\"icon-bar\"></span>\\n\\t\\t\\t</button>\\n\\t\\t\\t<a class=\"navbar-brand\" href=\"http://www.projectimplicit.net/index.html\" >\\n\\t\\t\\t\\t<img width=\"20\" height=\"20\" title=\"\" alt=\"\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAD9klEQVR42m3T/U+TVxQH8HMvLftb5g+dZDFpzJY0mdR1CAxqEWxpq9JiW0oHzOnGQiOLGqFF12kVKuXVUkqrK1KQFx1bcFGnYS/dsizLksVfTNhUthmTGe/ZuU+BSUuTb3J77+3nOec+t8C8mfvw3txzaLsp4OhXAtq/FuC/K+CT+wJOfSegKysg8JOA7h8FnP5ewIllAZ33BHTcFvDhkoAjiwJaFgQ0X1/l7kwvgHf6OfPNImtdQPhgEaH9FoL/NkLnNwgnv0Xo+gEJzEWO5VznPdpzJ7f36CKytgVUDE/mH4CmabEB0iJ8dEs+HeE4gSeWEU6/BMrxSZo7TmDHndzezSACeDIEXkdonSfwywfQsWSEzrs7lJxa3gHdWcrPa8nm5tbXP16qoK5+lcVIg3mmCHQT6J1GOkcB79+sgbxPLBYrSU4k5pITEzdGotGd+et09ruhZV6w5hlkbgm6rgnWRKUqVU5r8/cHurqyZ4NBcSYYQBr/ptPpVJs2+GY0INttmkbmmiSwcVIosneGUgj6vE2rzR4PruWZ3+/fDLpmNMybq441fk6g46pgh0mWB7oFeMCyv8VmMf9rs1he2Mzm9oKWJUgdSoM5rhB4KCWUweE0gitdAILJX/yau0df4ggYtpkSxYVgWiNbZc6ryA4lCbRPCGVAE+BK5YF+Dq037NC28BDa5le4b7YRnL3qAlBiDSlk9gSB1rhg9nEEiTa8BJpMReCdbaZ/wAr45pS7Si/uEW/OHAN/9v9KrUmNgh1IILOOEWi+LFg9DaRuXwP9VJk77aMb8Cd46OLT+SqXlsbgmnrC3ZPHNiqVoH0NM48SWDssYP8IgiVG4KgWTIkiOJiyg+PKinxh4EwL1phGGXDSW5RzjtQj3pB0gu4LFVhjGqiPKRirHUZgpgHB9g0i1A3LSS3Ux18F2/hDqljAweQqHcXv8oyVNKQe0MMeK0dki6+ALfE61BFIBbHaISSLQOMlwff2I6sZQHXNgBZqh0qo2r/BOvaY2+OtYB8flEAu8QS3JT209gdV9UxVF3sDjEMaWRA3RZEbLxFY2St4VR8STGBEC9v8xWAZe5OyEwyhV+jpYbBcRhluHh1R1qkTlWVEJ9dVVZFSZowKXh1BXnmRwLLzgpeHkdEXdXlki3sYDfN9QyhTVDM4pTYNbM+lb7tqb7+eV/f9wt/tRV5xAXnZOQINoRf8nc+Q0Rd1eagQrI6EZSsyzNgvWFUEmeyIEFbZpxTD95xHaXBDiEB9zxO++yyytz9FtWELcM+FsFLBeiou5qrJg6TB9T1PgZcGz/Fdgb9YaQ+qdwULwbJQWPnheqiTDYSK4PozuZQGn6re6j7yHw6qbqUIb1GZAAAAAElFTkSuQmCC\" />\\n\\t\\t\\t</a>\\n\\t\\t</div>\\n\\t\\t<div id=\"navbar\" class=\"collapse navbar-collapse\" ng-class=\"{in:showNavbar}\">\\n\\t\\t\\t<ul class=\"nav navbar-nav\">\\n\\t\\t\\t\\t<li ><a href=\"/implicit/research/\">Try a study</a></li>\\n\\t\\t\\t\\t<li><a href=\"/implicit/demo/takeatest.html\" >Take a demo test</a></li>\\n\\t\\t\\t\\t<li><a href=\"/implicit/demo/background/index.jsp\">Background</a></li>\\n\\t\\t\\t\\t<li><a href=\"/implicit/demo/support/index.jsp\">Tech Support</a></li>\\n\\t\\t\\t\\t<li><a href=\"/implicit/demo/background/thescientists.html\">The Scientists</a></li>\\n\\t\\t\\t</ul>\\n\\t\\t</div><!--/.nav-collapse -->\\n\\t</div>\\n</nav>\\n\\n<div class=\"container\" style=\"margin-top:50px;\">\\n\\t<div class=\"row\">\\n\\t\\t<div class=\"col-md-12\">\\n\\t\\t\\t<h2>You have completed the study.</h2>\\n\\t\\t</div>\\n\\t</div>\\n\\n\\t<div class=\"row\">\\n\\t\\t<div class=\"col-md-12\">\\n\\t\\t\\t<%= content %>\\n\\t\\t</div>\\n\\t</div>\\n\\n\\t<div class=\"row\">\\n\\t\\t<div class=\"col-md-12 text-center\" style=\"margin: 30px auto 10px;\">\\n\\t\\t\\t<a href=\"/implicit/Assign\" class=\"btn btn-primary\">Start next study</a>\\n\\t\\t</div>\\n\\t</div>\\n\\n</div>\\n\\n<footer role=\"contentinfo\">\\n\\n\\t<style type=\"text/css\">\\n\\t\\tfooter {text-align:center;border-top: 1px solid #e5e5e5;margin-top:50px;color: #767676;padding: 30px 0;}\\n\\t\\tfooter li {display: inline;padding: 0 2px}\\n\\t</style>\\n\\n\\t<ul class=\"text-muted\">\\n\\t\\t<li><button onClick=\"window.print()\" class=\"btn btn-default\">\\n\\t\\t\\t<span aria-hidden=\"true\" class=\"glyphicon glyphicon-print\"></span>\\n\\t\\t\\tPrint Page\\n\\t\\t</button></li>\\n\\t\\t<li>·</li>\\n\\t\\t<li><a href=\"/implicit/backgroundinformation.html\">Background Information</a></li>\\n\\t\\t<li>·</li>\\n\\t\\t<li><a href=\"/implicit/privacy.html\">Privacy Information</a></li>\\n\\t\\t<li>·</li>\\n\\t\\t<li><a href=\"/implicit\">Project Implicit Home</a></li>\\n\\t</ul>\\n</footer>';});\n\n","\ndefine('text!managerAPI/pi/messageTemplatePanel.jst',[],function () { return '<div class=\"panel panel-info\" style=\"margin-top:1em\">\\n\\t<% if (header){ %>\\n\\t\\t<div class=\"panel-heading\">\\n\\t\\t\\t<h2 class=\"panel-title text-center\" style=\"font-size:1.3em\"><%= header %></h2>\\n\\t\\t</div>\\n\\t<% } %>\\n\\n\\t<div class=\"panel-body\">\\n\\t\\t<%= content %>\\n\\t</div>\\n\\n\\t<% if (footer){ %>\\n\\t\\t<div class=\"panel-footer\">\\n\\t\\t\\t<%= footer %>\\n\\t\\t</div>\\n\\t<% } %>\\n</div>';});\n\n","define('managerAPI/pi/managerAPI',['require','../managerAPI','underscore','APIs/pi/APIdecorator','text!./messageTemplate.jst','text!./messageTemplateDebrief.jst','text!./messageTemplatePanel.jst'],function(require){\n\n\tvar Constructor = require('../managerAPI');\n\tvar _ = require('underscore');\n\tvar isDev = /^(localhost|127.0.0.1)/.test(location.host);\n\tvar decorator = require('APIs/pi/APIdecorator');\n\n\tvar messageTemplate = require('text!./messageTemplate.jst');\n\tvar messageTemplateDebrief = require('text!./messageTemplateDebrief.jst');\n\tvar messageTemplatePanel = require('text!./messageTemplatePanel.jst');\n\n\t/**\n\t * Constructor for PIPlayer script creator\n\t * @return {Object}\t\tScript creator\n\t */\n\tfunction API(){\n\t\tConstructor.call(this);\n\t\tthis.settings.onPreTask = onPreTask;\n\t}\n\n\tdecorator(API);\n\n\t// create API functions\n\t_.extend(API.prototype, Constructor.prototype);\n\n\t// annotate onPreTask\n\tonPreTask.$inject = ['currentTask', '$http','$rootScope'];\n\n\treturn API;\n\n\t/**\n\t * Before each task,\n\t * \t\tpost to /implicit/PiManager\n\t * \t\tin case this is a quest/pip added logging meta\n\t *\n\t * @param  {Object} currentTask The task Object\n\t * @param  {Object} $http       The $http service\n\t * @return {Promise}            Resolved when server responds\n\t */\n\tfunction onPreTask(currentTask, $http, $rootScope){\n\n\t\tvar global = $rootScope.global;\n\t\tvar settings, context;\n\t\tvar data = {taskName: currentTask.name || 'namelessTask', taskNumber: currentTask.$meta.number};\n\n\t\t// add logging meta\n\t\tif (currentTask.type == 'quest' || currentTask.type == 'pip'){\n\t\t\tcurrentTask.$script.serial = currentTask.$meta.number;\n\t\t\tsettings = currentTask.$script.settings;\n\t\t\tsettings.logger = settings.logger || {};\n\t\t\tsettings.logger.meta = angular.extend(settings.logger.meta || {}, data);\n\t\t}\n\n\t\tif (currentTask.type == 'message' && currentTask.piTemplate){\n\t\t\tcontext = {\n\t\t\t\tcontent: currentTask.$template,\n\t\t\t\tglobal: global,\n\t\t\t\tcurrent: global.current,\n\t\t\t\ttask: currentTask\n\t\t\t};\n\n\t\t\tif (currentTask.piTemplate == 'debrief'){\n\t\t\t\t_.extend(context,{\n\t\t\t\t\tshowFeedback: _.bind(showFeedback,null,global),\n\t\t\t\t\tshowPanel: showPanel\n\t\t\t\t});\n\n\t\t\t\tcurrentTask.$template = _.template(messageTemplateDebrief)(context); // insert into meta template\n\t\t\t\tcurrentTask.$template = _.template(currentTask.$template)(context); // render secondary template with extended context\n\t\t\t} else {\n\t\t\t\tcurrentTask.$template = _.template(messageTemplate)(context); // insert into meta template\n\t\t\t}\n\t\t}\n\n\t\t// set last task flag\n\t\tif (currentTask.last){\n\t\t\tdata.sessionStatus = \"C\";\n\t\t}\n\n\t\treturn isDev ? true : $http.post('/implicit/PiManager', data);\n\t}\n\n\tfunction showPanel(content, header, footer){\n\t\treturn _.template(messageTemplatePanel, {\n\t\t\tcontent: content,\n\t\t\theader: header,\n\t\t\tfooter: footer\n\t\t});\n\t}\n\n\tfunction showFeedback(global, options){\n\t\t_.isPlainObject(options) || (options = {});\n\n\t\t_.defaults(options,{\n\t\t\tpre: '<p>',\n\t\t\tpost: '</p>',\n\t\t\twrap: true,\n\t\t\theader: '',\n\t\t\tnoFeedback: '<p>No feedback was found</p>',\n\t\t\tproperty: 'feedback',\n\t\t\texclude: []\n\t\t});\n\n\t\tvar feedback = _(global)\n\t\t\t.filter(function(task,taskName){\n\t\t\t\tif (!_.isArray(options.exclude)) { throw Error('Exclude must be an array'); }\n\t\t\t\t// make sure task is an object\n\t\t\t\t// make sure feedback is defined\n\t\t\t\t// make sure this task is not excluded\n\t\t\t\treturn _.isPlainObject(task) && !_.isUndefined(task[options.property]) && (_.indexOf(options.exclude,taskName) === -1);\n\t\t\t})\n\t\t\t.mapValues(function(task){\n\t\t\t\treturn options.pre + task[options.property] + options.post;\n\t\t\t})\n\t\t\t.reduce(function(result, feedback){\n\t\t\t\treturn result + feedback;\n\t\t\t},'') || options.noFeedback;\n\n\t\treturn options.wrap ? showPanel(feedback, options.header) : feedback;\n\t}\n});\n\n\n"]}
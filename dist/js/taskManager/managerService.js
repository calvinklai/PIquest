define(["require","underscore"],function(e){function n(e,n,r,i,s,o){function u(e,t){var n=this,i,a=t.settings||{};if(!(this instanceof u))return new u(e,t);this.$scope=e,this.script=t,this.sequence=new r(t),i=s(a.canvas),e.$on("$destroy",i),a.title&&(o[0].title=t.settings.title),e.$on("manager:next",function(e,t){t||(t={type:"next"});switch(t.type){case"current":n.load(t);break;case"prev":n.prev(t);break;case"next":default:n.next(t)}}),e.$on("manager:prev",function(){n.prev()})}return t.extend(u.prototype,{next:function(e){this.sequence.next(),this.load(e)},prev:function(e){this.sequence.prev(),this.load(e)},current:function(){return this.sequence.current()},load:function(e){var t=this.current(),n=this.$scope,r={baseUrl:this.baseUrl,bustCache:e&&e.bustCache};t?i(t,r).then(function(){n.$emit("manager:loaded")}):n.$emit("manager:loaded")},setBaseUrl:function(e){this.baseUrl=e}}),u}var t=e("underscore");return n.$inject=["$rootScope","$q","managerSequence","managerTaskLoad","managerCanvas","$document"],n});
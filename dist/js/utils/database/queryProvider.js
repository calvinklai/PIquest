define(["underscore"],function(e){function t(t){function n(n,r,i){var s=new t(r);if(e.isFunction(n))return n(r);if(e.isString(n)||e.isNumber(n))n={set:n,type:"random"};n.set&&(s=s.where({set:n.set})),e.isPlainObject(n.data)&&(s=s.where({data:n.data})),e.isFunction(n.data)&&(s=s.filter(n.data));var o=n.seed||n.set,u=s.length,a=n.repeat,f;switch(n.type){case undefined:case"byData":case"random":f=i.random(u,o,a);break;case"exRandom":f=i.exRandom(u,o,a);break;case"sequential":f=i.sequential(u,o,a);break;case"first":f=0;break;case"last":f=u-1;break;default:throw new Error("Unknow query type: "+n.type)}if(e.isUndefined(s.at(f)))throw new Error("Query failed, object ("+JSON.stringify(n)+") not found. If you are trying to apply a template, you should know that they are not supported for inheritance.");return s.at(f)}return n}return t.$inject=["Collection"],t});
define(["require","angular","underscore"],function(e){function r(e,r){function i(e){return n.isFunction(e.customize)&&e.customize.apply(e,[e,r.global]),e}var s=function(r,o,u,a,f){f=a?--f:10;if(!f)throw new Error("Inheritance loop too deep, you can only inherit up to 10 levels down");if(!n.isPlainObject(r))throw new Error("You are trying to inflate a non object");var l,c=t.copy(r);if(!c.inherit)return!a&&i(c),c;l=e(r.inherit,o,u);if(!l)throw new Error("Query failed, object ("+JSON.stringify(r.inherit)+") not found.");return l=s(l,o,u,!0,f),n.each(l,function(e,n){n in c||(c[n]=t.copy(e))}),l.data&&(c.data=t.extend(l.data,c.data||{})),!a&&i(c),c};return s}var t=e("angular"),n=e("underscore");return r.$inject=["databaseQuery","$rootScope"],r});
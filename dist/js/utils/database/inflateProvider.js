define(["require","underscore"],function(e){function n(e,n,r){function i(e){return t.isFunction(e.customize)&&e.customize.apply(e,[e,n.global]),e}function s(n,o,u,a,f){f=a?--f:10;if(!f)throw new Error("Inheritance loop too deep, you can only inherit up to 10 levels down");if(!t.isPlainObject(n))throw new Error("You are trying to inflate a non object");var l,c=t.cloneDeep(n),h;if(!c.inherit)return!a&&i(c),c;l=e(n.inherit,o,u);if(!l)throw h=new Error("Query failed, object ("+JSON.stringify(n.inherit)+") not found."),r("query").error(h),h;return l=s(l,o,u,!0,f),t.each(l,function(e,n){n in c||(c[n]=t.isFunction(e)?e:t.cloneDeep(e))}),l.data&&(c.data=t.extend(l.data,c.data||{})),!a&&i(c),c}return s}var t=e("underscore");return n.$inject=["databaseQuery","$rootScope","piConsole"],n});
define(["require","angular","underscore"],function(e){function r(e,r,i){function s(e){return n.isFunction(e.customize)&&e.customize.apply(e,[e,r.global]),e}function o(r,u,a,f,l){l=f?--l:10;if(!l)throw new Error("Inheritance loop too deep, you can only inherit up to 10 levels down");if(!n.isPlainObject(r))throw new Error("You are trying to inflate a non object");var c,h=t.copy(r),p;if(!h.inherit)return!f&&s(h),h;c=e(r.inherit,u,a);if(!c)throw p=new Error("Query failed, object ("+JSON.stringify(r.inherit)+") not found."),i("query").error(p),p;return c=o(c,u,a,!0,l),n.each(c,function(e,n){n in h||(h[n]=t.copy(e))}),c.data&&(h.data=t.extend(c.data,h.data||{})),!f&&s(h),h}return o}var t=e("angular"),n=e("underscore");return r.$inject=["databaseQuery","$rootScope","piConsole"],r});
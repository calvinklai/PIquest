define("config",[],function(){var e=function(){};window.console||(window.console={}),window.console.log||(window.console.log=e),window.console.warn||(window.console.warn=e),require.config({paths:{underscore:["//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min","../../bower_components/lodash-compat/lodash.min"],angular:["//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular.min","../../bower_components/angular/angular.min"],animate:["//ajax.googleapis.com/ajax/libs/angularjs/1.2.26/angular-animate.min","../../bower_components/angular-animate/angular-animate.min"],text:["//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.10/text.min","../../bower_components/requirejs-text/text"],jquery:["//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min","../../bower_components/jquery/dist/jquery.min"]},packages:[{name:"pipScorer",location:"../../bower_components/PIPlayer/dist/js/extensions/dscore",main:"Scorer"}],shim:{angular:{exports:"angular"},animate:{deps:["angular"],exports:"angular"}},deps:["angular","animate","underscore","text"]}),window.name="NG_DEFER_BOOTSTRAP!"}),define("bootstrap",["./config"],function(){require.config({packages:[{name:"pipAPI",location:"APIs",main:"pipAPI"},{name:"questAPI",location:"APIs",main:"questAPI"},{name:"managerAPI",location:"APIs",main:"managerAPI"}]}),require(["angular","app"],function(e,t){e.element().ready(function(){setTimeout(function(){e.resumeBootstrap([t.name])},0)})})}),define("utils/timer/timerStopper",[],function(){function e(e){function t(){this.startTime=e()}return t.prototype.now=function(){return e()-this.startTime},t}return e.$inject=["timerNow"],e}),define("utils/timer/timerDirective",["require","underscore","angular"],function(e){function t(e,t){function n(e){if(!r.isPlainObject(e))throw new Error("Timer options must be an object");u=s.getScope(),u.options=r.defaults(e,{direction:"down",template:"normal",show:!0,removeOnEnd:!0,duration:0}),s.stopper=new t,s.targetTime=1e3*u.options.duration,u.options.show&&s.show(),a()}function i(){var t=u.options||{};u=s.getScope(),e.cancel(s.timeoutId),t.removeOnEnd&&s.remove()}function a(){var t=100,n=u.options,i=s.stopper.now(),c=s.targetTime-i;if(i>=s.targetTime)return u.$emit("timer-end"),void(n.removeOnEnd&&s.remove());var l="up"===n.direction?i:c;r.extend(u,o(l)),s.timeoutId=e(a,Math.min(t,c)),u.$emit("timer-tick")}function o(e){var t=Math.floor(e/1e3),n=Math.floor(t/3600),r=t%3600,i=Math.floor(r/60),a=r%60,o=Math.ceil(a),s={current:e,hours:n,minutes:i,seconds:o,milis:e%1e3};return s}var s=this,u={};s.start=n,s.stop=i}function n(e){return{controller:t,priority:400,link:function(t,n,r,a){function o(){u=i.element(c),n.prepend(u),e(u.contents())(l)}function s(){u&&u.remove(),u=null}var u,c='<div class="pi-timer well well-sm text-center" style="font-family: monospace;">{{minutes}}:{{zeroPad(seconds)}}</div>',l=t.$new();a.show=o,a.remove=s,a.getScope=function(){return l},l.zeroPad=function(e){return 10>e?"0"+e:e},t.$on("$destroy",s)}}}var r=e("underscore"),i=e("angular");return t.$inject=["$timeout","timerStopper"],n.$inject=["$compile"],n}),define("utils/timer/timerNow",[],function(){var e;return window.performance&&(e=performance.now||performance.mozNow||performance.webkitNow||performance.msNow||performance.oNow),e?function(){return e.apply(performance)}:function(){return+new Date}}),define("utils/timer/timer-module",["require","angular","./timerStopper","./timerDirective","./timerNow"],function(e){var t=e("angular"),n=t.module("timer",[]);return n.service("timerStopper",e("./timerStopper")),n.directive("piTimer",e("./timerDirective")),n.value("timerNow",e("./timerNow")),n}),define("utils/utils/preloaderService",["require","underscore"],function(e){function t(e){this.$q=e,this.loaders={},this.loaded=[]}function n(e,t){if(!u.isFunction(t))throw new Error("Fn is not a function");this.loaders[e]=t}function r(e,t){var n,r,i=this.loaders[e];if(r=this.getObj(e,t))return r.promise;if(r={type:e,description:t},this.loaded.push(r),!u.isFunction(i))throw new Error('Loader "'+e+'" was not registered.');if(n=r.promise=i.call(this,t),!s(n))throw new Error('Loader "'+e+'" must return a promise.');return n.then(function(e){return r.promise=null,r.value=e,e}),n}function i(e,t){var n,r=this.$q;if(!u.isArray(t))throw new Error("descriptions must be an array.");return n=u.map(t,function(t){return this.load(e,t)},this),r.all(n)}function a(e,t){var n=u.find(this.loaded,function(n){return n.type===e&&n.description===t},this);return n}function o(e,t){var n=this.getObj(e,t);if(!("value"in n))throw new Error('This object has not been loaded yet: "'+t+'"');return n.value}function s(e){return u.isPlainObject(e)&&u.isFunction(e.then)}var u=e("underscore");return t.$inject=["$q"],u.extend(t.prototype,{register:n,load:r,loadArr:i,get:o,getObj:a}),t}),define("utils/utils/preloaderDecorator",["require","underscore"],function(e){function t(e){return e.register("image",n),e}function n(e){var t=this.$q.defer(),n=new Image;return n.onload=r.bind(t.resolve,t,n),n.onerror=r.bind(t.reject,t,n),n.src=e,t.promise}var r=e("underscore");return t.$inject=["$delegate"],t}),define("utils/utils/utilsModule",["require","angular","underscore","./preloaderService","./preloaderDecorator"],function(e){var t=e("angular"),n=e("underscore"),r=t.module("pi.utils",[]);return r.service("piPreloader",e("./preloaderService")),r.config(["$provide",function(t){t.decorator("piPreloader",e("./preloaderDecorator"))}]),r.service("piInvoke",["$injector",function(e){function t(t,i){var a=r.global||{};t&&e.invoke(t,null,n.extend(i,{global:a,current:a.current}))}var r=e.get("$rootScope");return t}]),r}),define("quest/directives/buttons/buttons",["require","angular"],function(e){var t=e("angular");return t.module("ui.bootstrap.buttons",[]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).controller("ButtonsController",["buttonConfig",function(e){this.activeClass=e.activeClass||"active",this.toggleEvent=e.toggleEvent||"click"}]).directive("btnRadio",function(){return{require:["btnRadio","ngModel"],controller:"ButtonsController",link:function(e,n,r,i){var a=i[0],o=i[1];o.$render=function(){n.toggleClass(a.activeClass,t.equals(o.$modelValue,e.$eval(r.btnRadio)))},n.bind(a.toggleEvent,function(){var i=n.hasClass(a.activeClass);(!i||t.isDefined(r.uncheckable))&&e.$apply(function(){o.$setViewValue(i?null:e.$eval(r.btnRadio)),o.$render()})})}}}).directive("btnCheckbox",function(){return{require:["btnCheckbox","ngModel"],controller:"ButtonsController",link:function(e,n,r,i){function a(){return s(r.btnCheckboxTrue,!0)}function o(){return s(r.btnCheckboxFalse,!1)}function s(n,r){var i=e.$eval(n);return t.isDefined(i)?i:r}var u=i[0],c=i[1];c.$render=function(){n.toggleClass(u.activeClass,t.equals(c.$modelValue,a()))},n.bind(u.toggleEvent,function(){e.$apply(function(){c.$setViewValue(n.hasClass(u.activeClass)?o():a()),c.$render()})})}}})}),define("utils/database/template/templateFilter",["require","underscore"],function(e){function t(e,t){function r(r,i){if(!~r.indexOf("<%"))return r;i=n.extend(i||{},t);try{return n.template(r)(i)}catch(a){return e.error('ERROR: "'+a.message+'" in the following template: ',r),""}}return r}var n=e("underscore");return t.$inject=["$log","templateDefaultContext"],t}),define("utils/database/template/templateObjProvider",["require","underscore"],function(e){function t(e){function t(e,t,i){i||(i={});var a=e.deepTemplate;return n.forEach(e,function(e,i,o){o[i]=r(e,t,{deep:n.includes(a,i)})}),e}function r(e,t,a){var o=a&&a.deep;return n.isString(e)?i(e,t):o&&n.isArray(e)?n.map(e,n.bind(r,null,n,t,a)):o&&n.isPlainObject(e)?n.mapValues(e,n.bind(r,null,n,t,a)):e}var i=e("template");return t}var n=e("underscore");return t.$inject=["$filter"],t}),define("utils/database/template/templateModule",["require","angular","./templateFilter","./templateObjProvider"],function(e){var t=e("angular"),n=t.module("template",[]);return n.filter("template",e("./templateFilter")),n.service("templateObj",e("./templateObjProvider")),n.constant("templateDefaultContext",{}),n}),define("utils/console/consoleProvider",["require","underscore"],function(e){function t(e){function t(t,r){var i=n.create(e);return n.extend(i,{tags:n.isArray(t)?t:[t],force:!!r}),i}function r(t){e.settings=t}return t.setSettings=r,t}var n=e("underscore");return t.$inject=["piConsolePrototype"],t}),define("utils/console/consolePrototypeProvider",["require","underscore"],function(e){function t(e,t){function a(e){var t=this.settings.level||"error",a=this.settings.tags||"all",o=this.tags,s=this.force;return s?!0:~n.indexOf(r,t)?i[e]>i[t]?!1:"all"===a||n.intersection(o,n.isArray(a)?a:[a]).length?!0:!1:(this.settings.level="error",this.error('Unknow DEBUG level: "'+t+'". The valid levels are debug>info>warn>error>none'),!1)}function o(n){return function(){var r,i=this.settings,a=[];if(this.shouldLog(n)){for(r=0;r<arguments.length;r++)a[r]=arguments[r];if(e[n].apply(null,a),i.hideConsole)return;t.$emit("console:log",{time:new Date,type:n,args:a,tags:this.tags})}}}var s={};return n.each(r,function(e){s[e]=o(e)}),s.settings={},s.shouldLog=a,s}var n=e("underscore"),r=["log","info","warn","error","debug"],i={none:9,error:1,warn:2,info:3,log:4,debug:4};return t.$inject=["$log","$rootScope"],t}),define("text!utils/console/console.html",[],function(){return'<div>\n	<div\n		ng-repeat="log in logs | orderBy:\'time\':true"\n		class="alert"\n		ng-class="{\n			\'alert-warning\':log.type == \'warn\',\n			\'alert-danger\':log.type == \'error\',\n			\'alert-info\':log.type == \'info\',\n			\'alert-success\':log.type == \'log\',\n			\'alert-success\':log.type == \'debug\'\n\n		}"\n		role="alert"\n	>\n		<button ng-click="remove(log)" type="button" class="close" data-dismiss="alert"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>\n		<strong>{{ log.type | uppercase}}:</strong> <i class="text-danger">{{log.time | date : \'HH:mm:ss:sss\'}}</i> - <strong>{{log.tags.join(\' \')}}</strong>:</br>\n		<span\n			ng-repeat="arg in log.args track by $index"\n			ng-click="pre = !pre"\n			ng-class="{pre:pre}"\n			ng-bind-html="arg | stringify:pre"\n		></span>\n\n	</div>\n</div>'}),define("utils/console/consoleDirective",["require","text!./console.html","underscore"],function(e){function t(e){return{replace:!0,template:n,link:function(t){function n(e){var t=r.indexOf(i,e);t>-1&&i.splice(t,1)}var i=t.logs=[];t.remove=n,t.reverse=!0,e.$on("console:log",function(e,t){i.push(t)})}}}var n=e("text!./console.html"),r=e("underscore");return t.$inject=["$rootScope"],t}),define("utils/console/consoleModule",["require","angular","./consoleProvider","./consolePrototypeProvider","./consoleDirective"],function(e){function t(e,t){if(null==e)return'<i class="text-muted">undefined</i>';if(""===e)return'<i class="text-muted">an empty string</i>';switch(typeof e){case"string":break;case"number":e=""+e;break;case"object":if(e instanceof Error){e=e.message;break}default:e='<a href="javascript:void(0)">'+n.toJson(e,!!t)+"</a>"}return e}var n=e("angular"),r=n.module("piConsole",[]);return r.service("piConsole",e("./consoleProvider")),r.service("piConsolePrototype",e("./consolePrototypeProvider")),r.directive("piConsole",e("./consoleDirective")),r.filter("stringify",function(){return t}),r}),define("text!utils/modal/modal.html",[],function(){return'<div class="modal in" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">\n	<div class="modal-dialog">\n		<div class="modal-content">\n			<div class="modal-header" ng-ifs="header">\n				<button type="button" class="close" data-dismiss="modal" aria-label="Close" ng-click="close()"><span aria-hidden="true">&times;</span></button>\n				<h4 class="modal-title" id="myModalLabel">{{ header || "Heads Up!" }}</h4>\n			</div>\n			<div class="modal-body">{{body}}</div>\n			<div class="modal-footer">\n				<button type="button" class="btn btn-default" ng-click="close()">{{button || "Close"}}</button>\n			</div>\n		</div>\n	</div>\n</div>'}),define("utils/modal/modalService",["require","underscore","text!./modal.html","angular"],function(e){function t(e,t,a,o,s){function u(){l&&l.remove(),d&&d.$destroy(),p&&p.resolve(),m.remove(),s.off("keydown",u),t.removeClass("modal-open")}function c(c){var f=c.context||{};return u(),p=o.defer(),d=(c.$scope||e).$new(),d.close=u,s.on("keydown",u),d.header=n.template(c.header)(f),d.body=n.template(c.body)(f),d.button=n.template(c.button)(f),l=i.element(r),t.addClass("modal-open"),t.prepend(m),t.prepend(l),a(l.contents())(d),d.$digest(),p.promise}var l,d,p,m=i.element('<div class="modal-backdrop in"/>');this.open=c,this.close=u}var n=e("underscore"),r=e("text!./modal.html"),i=e("angular");return t.$inject=["$rootScope","$rootElement","$compile","$q","$document"],t}),define("utils/modal/modalModule",["require","angular","./modalService"],function(e){var t=e("angular"),n=t.module("pi.modal",[]);return n.service("piModal",e("./modalService")),n}),define("quest/directives/questController",["require","underscore"],function(e){function t(e,t,r,i,a,o,s){function u(t,u){function m(e){var r=e.response,i=l.correctValue;return n.isNumber(i)&&(i+=""),n.isNumber(r)&&(r+=""),n.isEqual(i,r)?t.$setValidity("correct",!0):t.$setValidity("correct",!1),e}u=n.defaults(u||{},p),l=u.data;var f=r(i.ngModel),g=l.hasOwnProperty("dflt")?l.dflt:u.dflt;e.model=t,c=f(e.$parent),n.isUndefined(c)?(c={},f.assign(e.$parent,c)):a(["question"]).warn('This question has already been in use: "'+c.name+'"'),d.log=t.$modelValue=c,n.defaults(c,{name:l.name,response:g,serial:n.size(s.current&&s.current.questions)}),e.response=t.$viewValue=c.response,t.$formatters.push(function(e){return e.response}),t.$parsers.push(function(e){if(n.isUndefined(e))return c;var t=d.stopper.now();return c.response=e,c.latency=t,c.pristineLatency||(c.pristineLatency=t),c}),e.$watch("response",function(e,r){n.isEqual(e,r)||(t.$setViewValue(e),o(l.onChange,{log:c}))}),e.$on("$destroy",function(){o(l.onDestroy,{log:c})}),l.correct&&(t.$parsers.push(m),l.response=m(this.log)),o(l.onCreate,{log:c})}var c,l,d=this,p={dflt:0/0,data:e.data};this.scope=e,this.stopper=new t,this.registerModel=u,e.$on("quest:submit",function(e){e.preventDefault(),c.declined=void 0,c.submitLatency=d.stopper.now(),o(l.onSubmit,{log:c})}),e.$on("quest:decline",function(e){e.preventDefault(),c.declined=!0,c.submitLatency=d.stopper.now(),o(l.onDecline,{log:c})}),e.$on("quest:timeout",function(e){e.preventDefault(),c.timeout=!0,o(l.onTimeout,{log:c})})}var n=e("underscore");return t.$inject=["$scope","timerStopper","$parse","$attrs","piConsole","piInvoke","$rootScope"],t}),define("text!quest/directives/piQuest/piQuest.html",[],function(){return'<div piq-page ng-module="page"></div>'}),define("quest/directives/piQuest/piQuest-directive",["require","underscore","text!./piQuest.html","angular"],function(e){function t(e,t,n,i,a){function o(t,n){l.next(n),e.$emit("quest:newPage")}function s(t,n){l.prev(n),e.$emit("quest:newPage")}var u,c=this,l=c.task=new n(e.script),d=t.global,p=t.current||{};p.questions={},u={global:d,current:p,questions:p.questions},r.extend(i,u),r.extend(a,u),l.next(),e.$on("quest:next",o),e.$on("quest:prev",s),e.$on("quest:log",function(t,n,r){l.log(n,r,e.global)})}function n(e,n,o,s){return{controller:t,terminal:!0,priority:500,link:function(t,u,c,l){function d(){h&&(h.remove(),h=null),g&&(g.$destroy(),g=null),v&&(n.leave(v,function(){h=null}),h=v,v=null)}function p(){var r=b.current();if(r){var o=t.$new(),s=a(i);o.page=r,f(s,r.animate),d(),v=e(s)(o),n.enter(v,u),g=o,g.$emit("quest:updated")}else d()}function m(){g.page=b.current()}function f(e,t){if(t){var n=t.split(" ");r.each(n,function(e){o.has("."+e+"-animation")||s(["page","animation"]).error('Unknown animation type: "'+e+'"')}),e.addClass(t)}}var g,v,h,b=l.task;t.$on("quest:refresh",m),t.$on("quest:newPage",p),p()}}}var r=e("underscore"),i=e("text!./piQuest.html"),a=e("angular").element;return t.$inject=["$scope","$rootScope","Task","templateDefaultContext","mixerDefaultContext"],n.$inject=["$compile","$animate","$injector","piConsole"],n}),define("text!quest/directives/piQuest/piqPage.html",[],function(){return'<div ng-form name="pageForm" pi-timer>\n	<div pi-timer="page.timer"></div>\n	<div ng-if="page.progressBar" class="text-center" ng-bind-html="page.progressBar"></div>\n	<h3 ng-if="page.header" ng-bind-html="page.header" ng-style="page.headerStyle"></h3>\n	<div ng-bind-html="page.text"></div>\n	<ol ng-class="{\'list-unstyled\':!page.numbered}" start="{{page.numberStart}}">\n		<li ng-repeat="quest in page.questions">\n			<div quest-wrapper quest-data="quest" quest-current="current"></div>\n		</li>\n	</ol>\n\n	<div class="pull-right" ng-class="{\'btn-group\': !page.v1style, \'btn-toolbar\': page.v1style}">\n		<button\n			ng-click="prev()"\n			data-role="submit"\n			class="btn"\n			ng-if="page.prev && page.$meta.number > 1"\n		>{{page.prevText || "Go Back"}}</button>\n\n		<button\n			ng-click="submit()"\n			data-role="submit"\n			class="btn btn-primary"\n			ng-if="!page.noSubmit"\n		>{{page.submitText || "Submit"}}</button>\n\n		<button\n			ng-click="decline($event)"\n			data-role="submit"\n			class="btn btn-warning"\n			ng-class="{\'btn-active-accented\':page.v1style}"\n			ng-if="page.decline"\n		>{{page.declineText || "Decline to Answer"}}</button>\n	</div>\n</div>'}),define("quest/directives/piQuest/piqPage-directive",["require","text!./piqPage.html","underscore","angular"],function(e){function t(e,t,n,r){function o(){e.$emit("quest:refresh")}function s(t){function a(){var t,a=s.timer.message;u.log.timeout=!0,e.$broadcast("quest:timeout"),a?(t={pagesMeta:s.$meta,pagesData:s.data,global:n.global,current:n.current},i.isString(a)&&(a={body:a}),i.defaults(a,{header:"Timer Done",$context:t,$scope:e}),r.open(a).then(o)):o()}function o(){var t=s.timer.submitOnEnd||i.isUndefined(s.timer.submitOnEnd);t&&e.submit(!0)}var s=e.page;u.timer=t,u.log={name:s.name,startTime:+new Date},s.timer&&(t.start(s.timer),t.getScope().$on("timer-end",a))}var u=this;e.global=n.global,e.current=n.current,this.harvest=function(t){var n=e.current.questions;i.each(e.page.questions,function(r){if(r.name&&(t||r.lognow)){var i=n[r.name];i.$logged||(e.$emit("quest:log",i,u.log),i.$logged=!0)}})},e.submit=function(t){var n=e.pageForm.$valid;return e.submitAttempt=!0,n||t===!0?(e.$broadcast("quest:submit"),u.proceed(),void e.$emit("quest:next")):!0},e.decline=function(t){var n=a.element(t.target),r="double"!==this.page.decline;r||n.hasClass("active")?(e.$broadcast("quest:decline"),u.proceed(),e.$emit("quest:next")):n.addClass("active")},e.prev=function(){u.proceed(),e.$broadcast("quest:prev")},this.proceed=function(){u.timer.stop(),u.harvest(e.page.lognow)},this.setup=s,e.$watch("current.questions",o,!0),e.$on("quest:submit:now",function(){e.submit()})}function n(){return{replace:!0,controller:t,template:r,require:["piqPage","piTimer"],link:function(e,t,n,r){r[0].setup(r[1])}}}var r=e("text!./piqPage.html"),i=e("underscore"),a=e("angular");return t.$inject=["$scope","$timeout","$rootScope","piModal"],n}),define("text!quest/directives/wrapper/wrapper.html",[],function(){return'<div class="form-group">\n	<label ng-hide="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n	<div ng-bind-html="data.description"></div>\n	<div quest-data="data" ng-model="current.questions[data.name]" ng-style="{\'max-width\':data.maxWidth}"></div>\n	<p class="help-block" ng-if="data.help" ng-bind-html="data.helpText"></p>\n</div>'}),define("quest/directives/wrapper/wrapper-directive",["require","text!./wrapper.html","underscore"],function(e){function t(e){return e.charAt(0).toUpperCase()+e.slice(1)}function n(e,n){return{replace:!0,template:i,priority:5,scope:{data:"=questData",current:"=questCurrent"},link:function(i,o){var s=i.data.type||"text",u=o.children().eq(2),c=r+t(s);if(!n.has(c+"Directive"))throw new Error('Unknown question type: "'+s+'"');c=a.kebabCase(c),u.attr(c,!0),e(u)(i)}}}var r="quest",i=e("text!./wrapper.html"),a=e("underscore");return n.$inject=["$compile","$injector"],n}),define("text!quest/directives/text/text.html",[],function(){return'<div ng-form ng-class="{\'form-inline\':data.inline}">\n	<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n	<input\n	 	type="text"\n		ng-model="response"\n		ng-minlength="{{data.minLength || data.minlength}}"\n		ng-maxlength="{{data.maxlength}}"\n		ng-pattern="data.pattern | toRegex"\n		ng-required="{{data.required}}"\n		class="form-control"\n		ng-attr-style="width:{{data.width | dfltUnits}}"\n\n		ng-keydown="data.maxlengthLimit && maxlengthLimit($event)"\n		ng-keyup="data.maxlengthLimit && maxlengthLimit($event)"\n	/>\n	<div pi-quest-validation="form.$error.minlength">{{data.errorMsg.minLength || data.errorMsg.minlength || "Too short!"}}</div>\n	<div pi-quest-validation="form.$error.maxlength">{{data.errorMsg.maxlength || "Too long!"}}</div>\n	<div pi-quest-validation="form.$error.pattern">{{data.errorMsg.pattern || "wrong pattern!"}}</div>\n	<div pi-quest-validation="form.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("text!quest/directives/text/textarea.html",[],function(){return'<div ng-form ng-class="{\'form-inline\':data.inline}">\n	<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n	<textarea\n	 	type="text"\n		ng-model="response"\n		ng-minlength="{{data.minLength || data.minlength}}"\n		ng-maxlength="{{data.maxlength}}"\n		ng-pattern="data.pattern | toRegex"\n		ng-required="{{data.required}}"\n		class="form-control"\n\n		ng-attr-style="resize:none;width:{{data.columns? \'auto\' : data.width | dfltUnits}};"\n		cols="{{data.columns}}"\n		rows="{{data.rows}}"\n\n		ng-keydown="data.maxlengthLimit && maxlengthLimit($event)"\n		ng-keyup="data.maxlengthLimit && maxlengthLimit($event)"\n	/>\n	<div pi-quest-validation="form.$error.minlength">{{data.errorMsg.minLength || data.errorMsg.minlength || "Too short!"}}</div>\n	<div pi-quest-validation="form.$error.maxlength">{{data.errorMsg.maxlength || "Too long!"}}</div>\n	<div pi-quest-validation="form.$error.pattern">{{data.errorMsg.pattern || "wrong pattern!"}}</div>\n	<div pi-quest-validation="form.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("quest/directives/text/textDirective",["require","text!./text.html","text!./textarea.html","angular"],function(e){function t(){return{replace:!0,template:function(e,t){return"questText"in t?n:r},require:["form","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){function a(t){var n=i.element(t.target),r=n.val(),a=c.maxlength||r.length;e.response=r.slice(0,a)}var o=r[0],s=r[1],u=e.ctrl,c=e.data;e.form=o,e.maxlengthLimit=a,u.registerModel(s,{dflt:""}),c.autoSubmit&&t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$emit("quest:submit:now")}),t.preventDefault())})}}}var n=e("text!./text.html"),r=e("text!./textarea.html"),i=e("angular");return t}),define("text!quest/directives/text/text-number.html",[],function(){return'<div ng-form ng-class="{\'form-inline\':data.inline}">\n	<label ng-show="data.inline" for="{{data.name}}" ng-bind-html="data.stem" ng-style="data.stemCss"></label>\n	<input\n	 	type="number"\n		ng-model="response"\n		ng-required="{{data.required}}"\n		class="form-control"\n		ng-attr-style="width:{{data.width | dfltUnits}}"\n	>\n	<div pi-quest-validation="form.$error.number">{{data.errorMsg.number || "Must be a number!"}}</div>\n	<div pi-quest-validation="form.$error.qstMin">{{data.errorMsg.min || "Too small!"}}</div>\n	<div pi-quest-validation="form.$error.qstMax">{{data.errorMsg.max || "Too big!"}}</div>\n	<div pi-quest-validation="form.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("quest/directives/text/text-number-directive",["require","text!./text-number.html"],function(e){var t=e("text!./text-number.html"),n=function(){return{replace:!0,template:t,require:["form","ngModel","^?piqPage"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],a=t.find("input"),o=a.eq(0).controller("ngModel");e.form=i,e.ctrl.registerModel(r[1],{dflt:""}),e.data.autoSubmit&&t.bind("keydown keypress",function(t){13===t.which&&(e.$apply(function(){e.$emit("quest:submit:now")}),t.preventDefault())});var s=function(t){var n=parseFloat(e.data.min);return!isNaN(n)&&n>t?void o.$setValidity("qstMin",!1):(o.$setValidity("qstMin",!0),t)};o.$parsers.push(s),o.$formatters.push(s);var u=function(t){var n=parseFloat(e.data.max);return!isNaN(n)&&t>n?void o.$setValidity("qstMax",!1):(o.$setValidity("qstMax",!0),t)};o.$parsers.push(u),o.$formatters.push(u)}}};return n}),define("quest/directives/select/selectMixerProvider",["require","underscore"],function(e){function t(e,t){function r(r,i){var a=t(r);return a=n.map(a,function(e,t){return n.isPlainObject(e)||(e={text:e}),n.isUndefined(e.value)&&(e.value=i.numericValues?t+1:e.text),e}),i.reverse&&(a=n(a).reverse().value()),i.randomize&&(a=e(a)),n.each(a,function(e,t){e.order=t}),a}return r}var n=e("underscore");return t.$inject=["randomizeShuffle","mixerRecursive"],t}),define("text!quest/directives/select/dropdown.html",[],function(){return'<div ng-form>\n	<select\n		ng-model="response"\n		ng-options="answer.value as answer.text group by answer.group for answer in quest.answers"\n		ng-required="data.required"\n		ng-change="data.autoSubmit && autoSubmit($event)"\n		class="form-control"\n		>\n		<option value="">{{chooseText || "-- Choose an option --"}}</option>\n	</select>\n	<div pi-quest-validation="model.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("quest/directives/select/dropdownDirective",["require","text!./dropdown.html"],function(e){function t(e,t){return{replace:!0,template:n,require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(n,r,i,a){var o=a[0],s=n.ctrl;s.registerModel(o,{dflt:0/0}),n.quest={answers:e(n.data.answers||[],n.data)},n.chooseText="chooseText"in n.data&&n.data.chooseText,n.autoSubmit=function(){t(function(){n.$emit("quest:submit:now")})}}}}var n=e("text!./dropdown.html");return t.$inject=["questSelectMixer","$timeout"],t}),define("text!quest/directives/select/selectOne.html",[],function(){return'<div>\n	<div ng-class="listClass" ng-style="listCss">\n		<!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\'t add a $$hashkey property -->\n		<!-- using interpolation within class, so that we can keep the style info separate within the directive -->\n		<a\n			tabindex="-1"\n			ng-repeat="answer in quest.answers track by answer.order"\n			ng-model="$parent.responseObj"\n			btn-radio="answer"\n			ng-class="$parent.listItemClass"\n			ng-style="listItemCss"\n			class="{{ $parent.response == answer.value ? \'active\' : \'\' }}"\n			uncheckable\n			ng-click="data.autoSubmit && autoSubmit($event)"\n			ng-bind-html="answer.text"\n			unselectable="on"\n		></a>\n	</div>\n	<div pi-quest-validation="model.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("quest/directives/select/selectOneDirective",["require","angular","underscore","text!./selectOne.html"],function(e){function t(e,t,i){return{replace:!0,require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(a,o,s,u){function c(e){var t=l;return t.$isEmpty(e)?void t.$setValidity("required",!1):(t.$setValidity("required",!0),e)}var l=u[0],d=a.ctrl,p=a.data;switch(o.html(r),i(o.contents())(a),d.registerModel(l,{dflt:0/0}),a.quest={answers:e(a.data.answers||[],a.data)},a.$watch("responseObj",function(e,t){e!==t&&(a.response=e&&e.value)}),a.data.required&&(l.$formatters.push(c),l.$parsers.unshift(c),c(a.response)),a.data.buttons?a.data.style="horizontal":"horizontal"==a.data.style&&(a.data.buttons=!0),a.listCss={},a.listItemCss={},p.style){case"horizontal":a.listClass="btn-group btn-group-justified btn-group-lg",a.listItemClass="btn btn-select";break;case"multiButtons":a.listClass="btn-toolbar",a.listItemClass="btn  btn-select",a.listCss.lineHeight=2.8;break;case"list":default:a.listClass="list-group",a.listItemClass="list-group-item"}p.minWidth&&(a.listItemCss.minWidth=p.minWidth),a.autoSubmit=function(e){if(a.data.autoSubmit){var r=n.element(e.target).hasClass(t.activeClass);r&&a.$emit("quest:submit:now")}}}}}var n=e("angular"),r=(e("underscore"),e("text!./selectOne.html"));return t.$inject=["questSelectMixer","buttonConfig","$compile"],t}),define("text!quest/directives/select/selectMulti.html",[],function(){return'<div required="{{data.required}}">\n	<div ng-class="listClass" ng-style="listCss">\n		<!-- track by in the ng-repeat allows us to keep the repeated object clean so that angular doesn\'t add a $$hashkey property -->\n		<a\n			href="javascript:void(0);"\n			ng-repeat="answer in quest.answers track by answer.order"\n			ng-model="answer.chosen"\n			btn-checkbox\n			ng-class="$parent.listItemClass"\n			ng-style="listItemCss"\n			class="{{ answer.chosen ? \'active\' : \'\' }}"\n			uncheckable\n			ng-bind-html="answer.text"\n			unselectable="on"\n		>\n		</a>\n	</div>\n	<div pi-quest-validation="model.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n	<div pi-quest-validation="model.$error.correct">{{data.errorMsg.correct || "You must answer the correct answer!"}}</div>\n</div>'}),define("quest/directives/select/selectMultiDirective",["require","underscore","text!./selectMulti.html"],function(e){function t(e){return{replace:!0,template:r,require:["^?piqPage","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(t,r,i,a){var o=t.ctrl,s=a[1],u=t.data;switch(o.registerModel(s,{dflt:[]}),s.$isEmpty=function(){return n.isEmpty(s.$viewValue)},t.quest={answers:e(t.data.answers||[],t.data)},n.each(t.quest.answers,function(e){~n.indexOf(t.response,e.value)&&(e.chosen=!0)}),t.data.buttons?t.data.style="horizontal":"horizontal"==t.data.style&&(t.data.buttons=!0),t.listCss={},t.listItemCss={},u.style){case"horizontal":t.listClass="btn-group btn-group-justified btn-group-lg",t.listItemClass="btn btn-select";break;case"multiButtons":t.listClass="btn-toolbar",t.listItemClass="btn  btn-select",t.listCss.lineHeight=2.8;break;case"list":default:t.listClass="list-group",t.listItemClass="list-group-item"}u.minWidth&&(t.listItemCss.minWidth=u.minWidth),t.$watch("quest.answers",function(e,r){e!==r&&(t.response=n(e).filter(function(e){return e.chosen}).pluck("value").value())},!0)}}}var n=e("underscore"),r=e("text!./selectMulti.html");return t.$inject=["questSelectMixer"],t}),define("text!quest/directives/grid/grid.html",[],function(){return'<div ng-form class="table-responsive" ng-class="{\'pi-page-submitted\':$parent.$parent.submitAttempt}">\n	<table class="table table-hover">\n		<thead ng-if="!data.columnStemHide">\n			<tr>\n				<th ng-style="data.columnStemCss"></th>\n				<th\n					ng-repeat="column in columns"\n					ng-bind-html="column.stem"\n					ng-style="data.columnStemCss"\n				></th>\n			</tr>\n		</thead>\n		<tbody>\n			<tr\n				ng-repeat="row in rows"\n				quest-grid-row="row"\n				quest-grid-data="data"\n				ng-model="$parent.$parent.current.questions[row.name]"\n				ng-required="{{data.required || row.required}}"\n			></tr>\n		</tbody>\n	</table>\n	<div pi-quest-validation="form.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n</div>'
}),define("quest/directives/grid/gridDirective",["require","underscore","text!./grid.html"],function(e){function t(t){function r(e){return n(e||[]).map(a).each(function(e,t){e.hasOwnProperty("value")||(e.value=t+1),e.hasOwnProperty("type")||(e.type="checkbox")}).tap(function(e){n(e).filter(function(e){return!e.noReverse}).each(function(e,t,n){e.reverseValue=n[n.length-t-1].value}).commit()}).value()}function i(e,r){return n(e||[]).map(a).each(function(e,t){e.hasOwnProperty("name")||(e.name=r.name+o(t+1,3))}).thru(r.shuffle?t:n.identity).value()}function a(e){return n.isPlainObject(e)?e:{stem:e}}function o(e,t){var n=Math.abs(e),r=1+Math.floor(Math.log(n)/Math.LN10);if(r>=t)return e;var i=Math.pow(10,t-r).toString().substr(1);return 0>e?"-"+i+n:i+n}return{replace:!0,template:e("text!./grid.html"),require:["ngModel","form"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData",current:"=questCurrent"},link:function(e,t,a,o){var s=o[0],u=e.ctrl,c=e.data;e.form=o[1],e.columns=r(c.columns),e.rows=i(c.rows,c),e.$watchCollection(function(){return n.pluck(e.rows,"$response")},function(t){e.response=n.reduce(t,function(e,t){return n.isFinite(t)?e+t:e},0)}),u.registerModel(s,{dflt:0})}}}var n=e("underscore");return t.$inject=["questShuffle"],t}),define("text!quest/directives/grid/gridRow.html",[],function(){return'<th\n	scope="row"\n	ng-if="!data.rowStemHide"\n	ng-bind-html="row.stem"\n	ng-style="data.rowStemCss"\n></th>\n<td ng-repeat="column in $parent.columns" ng-switch="column.type">\n	<button\n		ng-switch-when="checkbox"\n		btn-radio="row.reverse && !column.noReverse ? column.reverseValue : column.value"\n		ng-model="$parent.$parent.response"\n		class="btn btn-default"\n		uncheckable\n	></button>\n	<div\n		class="text"\n		ng-switch-when="text"\n		ng-bind-html="row[column.textProperty]"\n	></div>\n\n	<div\n		class="cell-labels"\n		ng-if="data.cellLabels"\n		ng-bind-html="column.stem"\n	></div>\n</td>\n'}),define("quest/directives/grid/gridRowDirective",["require","text!./gridRow.html"],function(e){function t(){return{template:e("text!./gridRow.html"),require:["ngModel"],controller:"questController",controllerAs:"ctrl",scope:{row:"=questGridRow",data:"=questGridData"},link:function(e,t,n,r){var i=r[0],a=e.ctrl;e.model=i,e.$watch("response",function(t){e.row.$response=t}),a.registerModel(i,{data:e.row})}}}return t}),define("text!quest/directives/slider/slider.html",[],function(){return'<div ng-form>\n	<div\n		pi-slider\n		ng-model="response"\n		pi-slider-options="data"\n		ng-required="{{data.required}}"\n	></div>\n	<h4 ng-if="data.displayValue" class="text-center"><span class="label label-info">{{ response | number }}</span></h4>\n	<div pi-quest-validation="form.$error.required && $parent.$parent.submitAttempt">{{data.errorMsg.required || "This field is required!"}}</div>\n</div>'}),define("quest/directives/slider/sliderDirective",["require","underscore","text!./slider.html"],function(e){function t(){return{replace:!0,template:e("text!./slider.html"),require:["form","ngModel"],controller:"questController",controllerAs:"ctrl",scope:{data:"=questData"},link:function(e,t,n,r){var i=r[0],a=r[1],o=e.ctrl,s=e.data;e.form=i,o.registerModel(a,{dflt:void 0}),s.autoSubmit&&e.$on("slider:change",function(){e.$emit("quest:submit:now")})}}}e("underscore");return t.$inject=[],t}),function(e,t){if("function"==typeof define&&define.amd)define("quest/directives/slider/slider",[],t);else{var n=angular.module("pi",[]);n.directive("piSlider",t(e.angular))}}(this,function(){function e(e){return{scope:{options:"=piSliderOptions"},replace:!0,require:"ngModel",template:['<div class="slider" ng-mousedown="onSliderMouseDown($event)">','<div class="slider-label-left">{{options.leftLabel}}</div>','<div class="slider-label-right">{{options.rightLabel}}</div>','<div class="slider-container">','<div class="slider-bar">','<div class="slider-bar-highlight" ng-style="highlightStyle"></div>',"</div>",'<div class="slider-handle" ng-mousedown="onHandleMousedown($event)" ng-style="handleStyle"></div>',"</div>",'<ul class="slider-pips" ng-if="!options.hidePips">','<li ng-repeat="i in getNumber(steps) track by $index" ng-style="{width: pipWidth + \'%\'}" ng-class="{last:$last}"></li>',"</ul>",'<ul class="slider-labels">','<li ng-repeat="label in labels track by $index" ng-style="{width: labelsWidth + \'%\'}" ng-class="{first:$first, last:$last}">{{label}}</li>',"</ul>","</div>"].join("\n"),link:function(i,a,o,s){function u(e){s.$setViewValue(e),s.$render()}function c(e){return!i.steps||s.$isEmpty(e)?e:Math.round(e*i.steps)/i.steps}function l(){var e=c(s.$viewValue),t=!isNaN(e),n=t?"block":"none",r=t&&v.highlight?"block":"none";i.highlightStyle={right:100-100*e+"%",display:r},i.handleStyle={left:100*e+"%",display:n}}function d(e){return s.$isEmpty(e)?0/0:(e=Math.min(Math.max(e,i.min),i.max),(e-i.min)/i.range)}function p(e){return+(i.min+c(e)*i.range).toFixed(4)}function m(n){function o(e){t(e),e.preventDefault();var n=l+(e.pageX-d)/(a.prop("clientWidth")-g);n=Math.min(n,1),n=Math.max(n,0),i.$apply(function(){u(n)})}function c(){e.off("mousemove",o),e.off("mouseup",c),i.$emit(r,s.$viewValue)}t(n);var l,d;n.preventDefault(),n.stopPropagation(),d=n.pageX,l=s.$viewValue,e.on("mousemove",o),e.on("mouseup",c)}function f(e){t(e),e.preventDefault();var n=a.prop("clientWidth"),o=a[0].getBoundingClientRect().left,c=(e.pageX-o-g/2)/(n-g);c=Math.min(c,1),c=Math.max(c,0),u(c),i.$emit(r,s.$viewValue)}var g,v=i.options||{};g=a[0].querySelector(".slider-handle").clientWidth,i.ngModel=s,i.min=v.min||0,i.max=v.max||i.min+100,i.range=i.max-i.min,i.steps=v.steps?v.steps-1:0,i.pipWidth=v.steps&&100/i.steps,i.labels=v.labels,i.labelsWidth=v.labels&&100/v.labels.length,s.$isEmpty=n,s.$render=l,s.$formatters.push(d),s.$parsers.push(p),i.onHandleMousedown=m,i.onSliderMouseDown=f,i.getNumber=function(e){return new Array(e)}}}}function t(e){var t,n,r;null==e.pageX&&null!=e.clientX&&(t=e.target.ownerDocument||document,n=t.documentElement,r=t.body,e.pageX=e.clientX+(n&&n.scrollLeft||r&&r.scrollLeft||0)-(n&&n.clientLeft||r&&r.clientLeft||0),e.pageY=e.clientY+(n&&n.scrollTop||r&&r.scrollTop||0)-(n&&n.clientTop||r&&r.clientTop||0))}function n(e){return isNaN(parseFloat(e))||!isFinite(e)}var r="slider:change";return e.$inject=["$document","$sce"],e}),define("quest/directives/toRegexFilter",["require","underscore"],function(e){function t(e){function t(t){var r;if(n.isUndefined(t))return/(?:)/;if(n.isRegExp(t)||n.isString(t))return new RegExp(t);throw r=new Error("Question pattern is not a valid regular expression"),e("text").error(r,t),r}return t}var n=e("underscore");return t.$inject=["piConsole"],t}),define("quest/directives/dfltUnitsFilter",["require","underscore"],function(e){function t(e,t){var i;return e||0===e||"0"===e?n(e)?(i=r.isUndefined(t)?"px":String(t),e+i):e:""}function n(e){return!r.isArray(e)&&e-parseFloat(e)+1>=0}var r=e("underscore");return function(){return t}}),define("quest/directives/questDirectivesModule",["require","angular","underscore","utils/timer/timer-module","utils/utils/utilsModule","./buttons/buttons","utils/database/template/templateModule","utils/console/consoleModule","utils/modal/modalModule","./questController","./piQuest/piQuest-directive","./piQuest/piqPage-directive","./wrapper/wrapper-directive","./text/textDirective","./text/textDirective","./text/text-number-directive","./select/selectMixerProvider","./select/dropdownDirective","./select/selectOneDirective","./select/selectMultiDirective","./grid/gridDirective","./grid/gridRowDirective","./slider/sliderDirective","./slider/slider","./toRegexFilter","./dfltUnitsFilter"],function(e){var t=e("angular"),n=e("underscore"),r=t.module("questDirectives",[e("utils/timer/timer-module").name,e("utils/utils/utilsModule").name,e("./buttons/buttons").name,e("utils/database/template/templateModule").name,e("utils/console/consoleModule").name,e("utils/modal/modalModule").name]);return r.controller("questController",e("./questController")),r.directive("piQuest",e("./piQuest/piQuest-directive")),r.directive("piqPage",e("./piQuest/piqPage-directive")),r.directive("questWrapper",e("./wrapper/wrapper-directive")),r.directive("questText",e("./text/textDirective")),r.directive("questTextarea",e("./text/textDirective")),r.directive("questTextNumber",e("./text/text-number-directive")),r.service("questSelectMixer",e("./select/selectMixerProvider")),r.directive("questDropdown",e("./select/dropdownDirective")),r.directive("questSelectOne",e("./select/selectOneDirective")),r.directive("questSelectMulti",e("./select/selectMultiDirective")),r.value("questShuffle",n.shuffle),r.directive("questGrid",e("./grid/gridDirective")),r.directive("questGridRow",e("./grid/gridRowDirective")),r.directive("questSlider",e("./slider/sliderDirective")),r.directive("piSlider",e("./slider/slider")),r.config(["$sceProvider",function(e){e.enabled(!1)}]),r.directive("piQuestValidation",function(){return{replace:!0,transclude:!0,scope:{unvalid:"=piQuestValidation"},template:['<div class="alert alert-danger" role="alert" ng-show="unvalid">','<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>',"<span ng-transclude></span>","</div>"].join("")}}),r.filter("toRegex",e("./toRegexFilter")),r.filter("dfltUnits",e("./dfltUnitsFilter")),r}),define("utils/logger/LoggerProvider",["require","underscore"],function(e){function t(e,t,r){function i(e){this.pending=[],this.sent=[],this.settings={},this.meta={},this.suppress=!1,this.dfltLogFn=e||function(e){return e}}var a=this;return n.extend(i.prototype,{log:function(){var e=this.settings,t=(e.logFn||this.dfltLogFn).apply(e,arguments);if(!n.isEmpty(this.meta)&&!n.isPlainObject(t))throw r(["logger"]).debug(t),new Error('Logger: in order to use "meta" the log must be an object.');n.extend(t,this.meta),r(["logger"]).debug("Logged: ",t),this.pending.push(t),a.logCounter++,e.pulse&&!this.suppress&&this.pending.length>=e.pulse&&this.send()},send:function(){function i(){c.resolve()}function a(){return e.post(s.url,u).then(i,function(){r(["logger"]).error('Failed to send data, it seems the backend is not responding. (sending to: "'+s.url+'")'),c.reject()})}var o,s=this.settings,u=this.pending,c=t.defer();if(0===u.length)return c.resolve(),c.promise;if(n.isUndefined(s.url))return r("logger").warn("The logger url is not set."),c.resolve(),c.promise;for(this.pending=[],e.post(s.url,u).then(i,a),o=0;o<u.length;o++)this.sent.push(u[o]);return c.promise},suppressPulse:function(e){this.suppress=n.isUndefined(e)?!0:e},getCount:function(){return a.logCounter},setSettings:function(e){if(0===arguments.length)return this.settings;if(this.settings=n.defaults({},e,a.settings),!n.isUndefined(e.meta)&&!n.isPlainObject(e.meta))throw new Error('Logger: "meta" must be an object.');this.meta=n.defaults({},e.meta,a.meta)}}),i}var n=e("underscore");return t.$inject=["$http","$q","piConsole"],function(){this.$get=t,this.settings={},this.meta={},this.logCounter=0}}),define("utils/logger/logger-module",["require","angular","./LoggerProvider","utils/console/consoleModule"],function(e){var t=e("angular"),n=e("./LoggerProvider"),r=t.module("logger",[e("utils/console/consoleModule").name]);return r.provider("Logger",n),r}),define("utils/database/randomize/randomizeModule",["require","angular","underscore"],function(e){var t=e("angular"),n=e("underscore"),r=t.module("randomize",[]);return r.value("randomizeRandom",Math.random),r.value("randomizeShuffle",n.shuffle),r.value("randomizeInt",function(e){return Math.floor(Math.random()*e)}),r.value("randomizeRange",function(e){return n.shuffle(n.range(e))}),r}),define("utils/database/mixer/mixer",["underscore"],function(e){function t(t,n){function r(t){var n=t.mixer;if(!(e.isPlainObject(t)&&"mixer"in t))return[t];if(e.isUndefined(r.mixers[n]))throw new Error("Mixer: unknow mixer type = "+n);return!t.remix&&t.$parsed?t.$parsed:(t.$parsed=r.mixers[n].apply(null,arguments),t.$parsed)}return r.mixers={wrapper:function(e){return e.data},repeat:function(t){var n,r=t.data||[],i=[];for(n=0;n<t.times;n++)i=i.concat(e.clone(r,!0));return i},random:function(n,i){function a(t){return e.reduce(t,function(t,n){if(e.isPlainObject(n)&&"mixer"in n&&"wrapper"!=n.mixer){var a=r(n,i);return t.concat(a)}return t.concat([n])},[])}var o=n.data||[];return t(a(o))},choose:function(n){var r=n.data||[];return e.take(t(r),n.n?n.n:1)},weightedRandom:function(t){var r,i=t.data||[],a=e.reduce(t.weights,function(e,t){return e+t}),o=n()*a,s=0;for(r=0;r<i.length;r++)if(s+=t.weights[r],s=+s.toFixed(3),s>=o)return[t.data[r]];throw new Error("Mixer: something went wrong with weightedRandom")}},r}return t.$inject=["randomizeShuffle","randomizeRandom"],t}),define("utils/database/mixer/mixerSequential",["require","underscore"],function(e){function t(e){function t(r,i,a){var o,s=r[0];if(a=a||0,a++>=10)throw new Error("Mixer: the mixer allows a maximum depth of 10");return n.isUndefined(s.mixer)?r:(o=e(s,i),r.shift(),o=o.concat(r),n.isUndefined(o[0])||n.isUndefined(o[0].mixer)?o:t(o,i,a))}return t}var n=e("underscore");return t.$inject=["mixer"],t}),define("utils/database/mixer/mixerRecursive",["require","underscore"],function(e){function t(e){function t(r,i,a){var o=[];if(a=a||0,a++>=10)throw new Error("Mixer: the mixer allows a maximum depth of 10");return o=n(r).map(function(r){return n.isUndefined(r.mixer)?r:t(e(r,i),i,a)}).flatten().value()}return t}var n=e("underscore");return t.$inject=["mixer"],t}),define("utils/database/mixer/mixerSequenceProvider",["require","underscore"],function(e){function t(e){function t(e){this.sequence=e,this.stack=[],this.add(e),this.pointer=0}return n.extend(t.prototype,{add:function(e,t){this.stack.push({pointer:t?e.length:-1,sequence:e})},proceed:function(t,r){var i=this.stack[this.stack.length-1],a="next"===t;if(!i)throw new Error("mixerSequence: subSequence not found");i.pointer+=a?1:-1;var o=i.sequence[i.pointer];return n.isUndefined(o)&&this.stack.length>1?(this.stack.pop(),this.proceed.call(this,t,r)):o&&o.mixer?(this.add(e(o,r),!a),this.proceed.call(this,t,r)):this},next:function(e){return this.pointer++,this.proceed.call(this,"next",e)},prev:function(e){return this.pointer--,this.proceed.call(this,"prev",e)},current:function(){var e=this.stack[this.stack.length-1];if(!e)throw new Error("mixerSequence: subSequence not found");var t=e.sequence[e.pointer];return t?(t.$meta=this.meta(),t):void 0},meta:function(){return{number:this.pointer,outOf:n.reduce(this.stack,function(e,t){return e+t.sequence.length-1},0)+1}}}),t}var n=e("underscore");return t.$inject=["mixer"],t}),define("utils/database/mixer/branching/dotNotation",["require","underscore"],function(e){function t(e,t){return n.isString(e)&&(e=e.split(".")),n.reduce(e,function(e,t){return n.isPlainObject(e)||n.isArray(e)?e[t]:void 0},t)}var n=e("underscore");return t}),define("utils/database/mixer/branching/mixerDotNotationProvider",["require","underscore"],function(e){function t(e){function t(t,r){var i=/[^\/]\./;return n.isString(t)?i.test(t)?e(t,r):t.replace("/.","."):t}return t}var n=e("underscore");return t.$inject=["dotNotation"],t}),define("utils/database/mixer/branching/mixerConditionProvider",["require","underscore"],function(e){function t(e,t){function r(r,i){var a,o,s;if(n.isFunction(r)?s=r:(a=e(r.compare,i),o=e(r.to,i),s=r.operator),t(["conditions"]).info("Condition: ",a,s||"equals",o,r),n.isFunction(s))return!!s.apply(i,[a,o,i]);switch(s){case"greaterThan":return n.isNumber(a)&&n.isNumber(o)?+a>+o:!1;case"greaterThanOrEqual":return n.isNumber(a)&&n.isNumber(o)?+a>=+o:!1;case"in":return n.isArray(o)?~n.indexOf(o,a):!1;case"exactly":return a===o;case"equals":default:return n.isUndefined(o)?!!a:n.isEqual(a,o)}return s}return r}var n=e("underscore");return t.$inject=["mixerDotNotation","piConsole"],t}),define("utils/database/mixer/branching/mixerEvaluateProvider",["require","underscore"],function(e){function t(e){function t(r,i){function a(e){return t(e,i)}return n.isArray(r)&&(r={and:r}),r.and?n.every(r.and,a):r.nand?!n.every(r.nand,a):r.or?n.some(r.or,a):r.nor?!n.some(r.nor,a):e(r,i)}return t}var n=e("underscore");return t.$inject=["mixerCondition"],t}),define("utils/database/mixer/branching/mixerBranchingDecorator",["require","underscore"],function(e){function t(e,t,r){function i(e,i){return i=n.extend(i||{},r),t(e.conditions,i)?e.data||[]:e.elseData||[]}function a(e,i){i=n.extend(i||{},r);var a;return a=n.find(e.branches,function(e){return t(e.conditions,i)}),a?a.data||[]:e.elseData||[]}return e.mixers.branch=i,e.mixers.multiBranch=a,e}var n=e("underscore");return t.$inject=["$delegate","mixerEvaluate","mixerDefaultContext"],t}),define("utils/database/mixer/mixerModule",["require","angular","../randomize/randomizeModule","utils/console/consoleModule","./mixer","./mixerSequential","./mixerRecursive","./mixerSequenceProvider","./branching/dotNotation","./branching/mixerDotNotationProvider","./branching/mixerConditionProvider","./branching/mixerEvaluateProvider","./branching/mixerBranchingDecorator"],function(e){var t=e("angular"),n=t.module("mixer",[e("../randomize/randomizeModule").name,e("utils/console/consoleModule").name]);return n.service("mixer",e("./mixer")),n.service("mixerSequential",e("./mixerSequential")),n.service("mixerRecursive",e("./mixerRecursive")),n.service("MixerSequence",e("./mixerSequenceProvider")),n.value("dotNotation",e("./branching/dotNotation")),n.service("mixerDotNotation",e("./branching/mixerDotNotationProvider")),n.service("mixerCondition",e("./branching/mixerConditionProvider")),n.service("mixerEvaluate",e("./branching/mixerEvaluateProvider")),n.config(["$provide",function(t){t.decorator("mixer",e("./branching/mixerBranchingDecorator"))}]),n.constant("mixerDefaultContext",{}),n}),define("utils/database/collection/collectionProvider",["underscore"],function(e){function t(){function t(n){if(n instanceof t)return n;if(!(e.isUndefined(n)||e.isArray(n)||n instanceof t))throw new Error("Collections can only be constructed from arrays");this.collection=n||[],this.length=this.collection.length,this.pointer=-1}e.extend(t.prototype,{first:function(){return this.pointer=0,this.collection[this.pointer]},last:function(){return this.pointer=this.collection.length-1,this.collection[this.pointer]},end:function(){return void(this.pointer=this.collection.length)},current:function(){return this.collection[this.pointer]},next:function(){return this.collection[++this.pointer]},previous:function(){return this.collection[--this.pointer]},add:function(t){return arguments.length?(t=e.isArray(t)?t:[t],this.collection=this.collection.concat(t),this.length=this.collection.length,this):this},at:function(e){return this.collection[e]}});var n=["where","filter"],r=Array.prototype.slice;return e.each(n,function(n){t.prototype[n]=function(){var i=r.call(arguments);i.unshift(this.collection);var a=e[n].apply(e,i);return new t(a)}}),t}return t}),define("utils/database/randomizer/randomizerProvider",["underscore"],function(e){function t(t,n,r){function i(){this._cache={random:{},exRandom:{},sequential:{}}}function a(n,r,i){var a=this._cache.random;return i&&!e.isUndefined(a[r])?a[r]:(a[r]=t(n),a[r])}function o(t,n,i){var a,o=this._cache.sequential,s=o[n];if(e.isUndefined(s))return s=o[n]=new r(e.range(t)),s.first();if(s.length!==t)throw new Error("This seed  ("+n+") points to a collection with the wrong length, you can only use a seed for sets of the same length");return i?s.current():(a=s.next(),e.isUndefined(a)?s.first():a)}function s(t,i,a){var o,s=this._cache.exRandom,u=s[i];if(e.isUndefined(u))return u=s[i]=new r(n(t)),u.first();if(u.length!==t)throw new Error("This seed  ("+i+") points to a collection with the wrong length, you can only use a seed for sets of the same length");return a?u.current():(o=u.next(),e.isUndefined(o)?(u=s[i]=new r(n(t)),u.first()):o)}return e.extend(i.prototype,{random:a,exRandom:s,sequential:o}),i}return t.$inject=["randomizeInt","randomizeRange","Collection"],t}),define("utils/database/queryProvider",["underscore"],function(e){function t(t,n){function r(r,i,a){var o=new t(i);if(e.isFunction(r))return r(i);(e.isString(r)||e.isNumber(r))&&(r={set:r,type:"random"}),r.set&&(o=o.where({set:r.set})),e.isString(r.data)&&(o=o.filter(function(e){return e.handle===r.data||e.data&&e.data.handle===r.data})),e.isPlainObject(r.data)&&(o=o.where({data:r.data})),e.isFunction(r.data)&&(o=o.filter(r.data));var s,u,c=r.seed||"$"+i.namespace+r.set,l=o.length,d=r.repeat;switch(r.type){case void 0:case"byData":case"random":s=a.random(l,c,d);break;case"exRandom":s=a.exRandom(l,c,d);break;case"sequential":s=a.sequential(l,c,d);break;case"first":s=0;break;case"last":s=l-1;break;default:throw new Error("Unknow query type: "+r.type)}if(e.isUndefined(o.at(s)))throw u=new Error("Query failed, object ("+JSON.stringify(r)+") not found. If you are trying to apply a template, you should know that they are not supported for inheritance."),n("query").error(u),u;return o.at(s)}return r}return t.$inject=["Collection","piConsole"],t}),define("utils/database/inflateProvider",["require","underscore"],function(e){function t(e,t,r){function i(e){return n.isFunction(e.customize)&&e.customize.apply(e,[e,t.global]),e}function a(t,o,s,u,c){if(c=u?--c:10,!c)throw new Error("Inheritance loop too deep, you can only inherit up to 10 levels down");if(!n.isPlainObject(t))throw new Error("You are trying to inflate a non object");var l,d,p=n.cloneDeep(t),m=p.inherit;if(!p.inherit)return!u&&i(p),p;if(l=e(m,o,s),!l)throw d=new Error("Query failed, object ("+JSON.stringify(m)+") not found."),r("query").error(d),d;if(l=a(l,o,s,!0,c),m.merge&&!n.isArray(m.merge))throw new Error("Inheritance error: inherit.merge must be an array.");return n.each(l,function(e,t){var r,i;if(!(t in p))return void(p[t]=n.isFunction(e)?e:n.cloneDeep(e));if(-1!=n.indexOf(m.merge,t)){if(r=p[t],i=e,n.isArray(r)){if(!n.isArray(i))throw new Error('Inheritance error: You tried merging an array with an non array (for "'+t+'")');p[t]=r.concat(i)}if(n.isPlainObject(r)){if(!n.isPlainObject(i))throw new Error('Inheritance error: You tried merging an object with an non object (for "'+t+'")');n.extend(r,i)}}}),l.data&&(p.data=n.extend(l.data,p.data||{})),!u&&i(p),p}return a}var n=e("underscore");return t.$inject=["databaseQuery","$rootScope","piConsole"],t}),define("utils/database/store/storeProvider",["underscore"],function(e){function t(t){function n(){this.store={}}return e.extend(n.prototype,{create:function(e){if(this.store[e])throw new Error("The name space "+e+" already exists");this.store[e]=new t,this.store[e].namespace=e},read:function(e){if(!this.store[e])throw new Error("The name space "+e+" does not exist");return this.store[e]},update:function(e,t){var n=this.read(e);n.add(t)},del:function(e){this.store[e]=void 0}}),n}return t.$inject=["Collection"],t}),define("utils/database/databaseProvider",["require","underscore"],function(e){function t(e,t,r,i,a){function o(){this.store=new e,this.randomizer=new t}return n.extend(o.prototype,{createColl:function(e){this.store.create(e)},getColl:function(e){return this.store.read(e)},add:function(e,t){var n=this.store.read(e);n.add(t)},inflate:function(e,t,n){var a=this.getColl(e);return(!t.$inflated||t.reinflate)&&(t.$inflated=r(t,a,this.randomizer)),(!t.$templated||t.regenerateTemplate)&&(n[e+"Data"]=t.$inflated.data||{},n[e+"Meta"]=t.$meta,t.$templated=i(t.$inflated,n)),t.$templated},sequence:function(e,t){if(!n.isArray(t))throw new Error("Sequence must be an array.");return new a(e,t,this)}}),o}var n=e("underscore");return t.$inject=["DatabaseStore","DatabaseRandomizer","databaseInflate","templateObj","databaseSequence"],t}),define("utils/database/databaseSequenceProvider",["require","underscore"],function(e){function t(e){function t(t,n,r){this.namespace=t,this.mixerSequence=new e(n),this.db=r}return n.extend(t.prototype,{next:function(e){return this.mixerSequence.next(e),this},prev:function(e){return this.mixerSequence.prev(e),this},current:function(e){e||(e={});var t=this.mixerSequence.current(e);return t?this.db.inflate(this.namespace,t,e):t},all:function(e){for(var t=[],n=this.next().current(e);n;)t.push(n),n=this.next().current(e);return t}}),t}var n=e("underscore");return t.$inject=["MixerSequence"],t}),define("utils/database/databaseModule",["require","angular","./mixer/mixerModule","./template/templateModule","utils/console/consoleModule","./collection/collectionProvider","./randomizer/randomizerProvider","./queryProvider","./inflateProvider","./store/storeProvider","./databaseProvider","./databaseSequenceProvider"],function(e){var t=e("angular"),n=t.module("database",[e("./mixer/mixerModule").name,e("./template/templateModule").name,e("utils/console/consoleModule").name]).service("Collection",e("./collection/collectionProvider")).service("DatabaseRandomizer",e("./randomizer/randomizerProvider")).service("databaseQuery",e("./queryProvider")).service("databaseInflate",e("./inflateProvider")).service("DatabaseStore",e("./store/storeProvider")).service("Database",e("./databaseProvider")).service("databaseSequence",e("./databaseSequenceProvider"));return n}),define("quest/task/questSequenceProvider",["require","underscore"],function(e){function t(){function e(e,t){if(!t)throw new Error("Sequences need to take a db as the second argument");this.sequence=t.sequence("pages",e),this.db=t}return n.extend(e.prototype,{next:function(e){return this.sequence.next(e),this},prev:function(e){return this.sequence.prev(e),this},current:function(e){var t,r=this.sequence.current(e);if(!r)return r;t=r.questions?n.isArray(r.questions)?r.questions:[r.questions]:[];var i=this.db.sequence("questions",t).all({pagesData:r.data,pagesMeta:r.$meta});return r=n.clone(r,!0),r.questions=i,r}}),e}var n=e("underscore");return t}),define("quest/task/taskProvider",["underscore","angular"],function(e,t){function n(n,r,i,a,o,s,u){function c(c){var l=this,d=c.settings||{};if(this.script=c,this.db=new r,this.logger=new i(s),this.logger.setSettings(d.logger||{}),this.q=n.defer(),!e.isArray(c.sequence))throw new Error("Task: no sequence was defined");this.sequence=new a(c.sequence,this.db),this.promise=this.q.promise.then(function(){return l.logger.suppressPulse(),e.each(u.current.questions,function(e){return e.$logged?!0:(l.log(e,{},u.global),void(e.$logged=!0))}),l.logger.suppressPulse(!1),l.logger.send()})["finally"](d.onEnd||t.noop),o(c,this.db)}return e.extend(c.prototype,{log:function(){this.logger.log.apply(this.logger,arguments)},current:function(){var e=this.sequence.current();return e||this.q.resolve(),e},next:function(){return this.sequence.next()},prev:function(){return this.sequence.prev()}}),c}return n.$inject=["$q","Database","Logger","QuestSequence","taskParse","dfltQuestLogger","$rootScope"],n}),define("quest/task/parseProvider",[],function(){function e(e){function t(t,n){n.createColl("pages"),n.createColl("questions"),n.add("pages",t.pagesSets||[]),n.add("questions",t.questionsSets||[]),t.settings||(t.settings={}),e.setSettings(t.settings.DEBUG||{})}return t}return e.$inject=["piConsole"],e}),define("quest/task/dfltQuestLogger",["require","underscore"],function(e){function t(e,t,r){var i=n.extend({},t,e);return i.declined&&(i.response=e.responseObj=void 0),i}var n=e("underscore");return t}),define("quest/task/task-module",["require","angular","utils/logger/logger-module","utils/database/databaseModule","utils/console/consoleModule","./questSequenceProvider","./taskProvider","./parseProvider","./dfltQuestLogger"],function(e){var t=e("angular"),n=t.module("task",[e("utils/logger/logger-module").name,e("utils/database/databaseModule").name,e("utils/console/consoleModule").name]);return n.service("QuestSequence",e("./questSequenceProvider")),n.service("Task",e("./taskProvider")),n.service("taskParse",e("./parseProvider")),n.value("dfltQuestLogger",e("./dfltQuestLogger")),n}),define("quest/questModule",["require","quest/directives/questDirectivesModule","quest/task/task-module"],function(e){e("quest/directives/questDirectivesModule"),e("quest/task/task-module");var t=angular.module("piQuest",["questDirectives","task"]);return t}),define("message/messageDirective",["require","underscore"],function(e){function t(e,t,r,i){return{link:function(a,o){function s(e){var t=n.isArray(d.keys)?d.keys:[d.keys],r=n.map(t,function(e){return n.isString(e)?e.toUpperCase().charCodeAt(0):e});~n.indexOf(r,e.which)&&a.done()}function u(){p.$destroy(),o.empty(),a.$emit("message:done")}var c,l="keydown",d=a.script,p=a.newScope=a.$new(),m={global:t.global,current:t.current,task:d};try{c=n.template(d.$template)(m)}catch(f){c=d.$template,i("message").error("failed to render template",f)}n.extend(a,m),a.done=u,r.on(l,s),a.$on("$destroy",function(){r.off(l,s)}),o.html(c),e(o.contents())(p)}}}var n=e("underscore");return t.$inject=["$compile","$rootScope","$document","piConsole"],t}),define("message/messageDoneDirective",[],function(){function e(){return{link:function(e,t){t.on("click",function(){e.done()})}}}return e.$inject=[],e}),define("message/messageModule",["require","angular","utils/console/consoleModule","./messageDirective","./messageDoneDirective"],function(e){var t=e("angular"),n=t.module("pi.message",[e("utils/console/consoleModule").name]);return n.directive("piMessage",e("./messageDirective")),n.directive("piMessageDone",e("./messageDoneDirective")),n}),define("taskManager/task/taskActivateProvider",["require","underscore"],function(e){function t(){var e={};this.$get=n,this.set=function(t,n){e[t]=n},this.get=function(t){return e[t]}}function n(e,t,n){function i(i,o,s){var u,c,l=e.defer(),d=t.global,p=i.$script;if(r.isFunction(p)&&(u=p),!u&&p&&r.isFunction(p.play)&&(u=r.bind(p.play,p),u.$inject=n.annotate(p.play)),!u&&p&&r.isArray(p.play)&&(u=r.bind(p.play[p.play.length-1],p),u.$inject=n.annotate(p.play)),!u&&i.type&&(u=a.get(i.type)),!r.isFunction(u))throw new Error('Activator function not found for the "'+i.type+'" task');return c=n.invoke(u,null,{done:r.bind(l.resolve,l),task:i,script:p,$element:o,$scope:s,global:d}),r.isFunction(c)&&l.promise["finally"](c),l}var a=this;return i}var r=e("underscore");return n.$inject=["$q","$rootScope","$injector"],t}),define("taskManager/task/taskDirective",["require","underscore"],function(e){function t(e,t,r,i,a){return{scope:{task:"=piTask"},link:function(o,s){function u(e){var t=e.key||e.which||e.keyCode;82==t&&e.ctrlKey&&l(e,"current"),27==t&&r.one("keydown",c)}function c(e){var t=e.which||e.keyCode;37==t&&l(e,"prev"),39==t&&l(e,"next")}function l(e,t){e.preventDefault(),g={type:t,bustCache:!0},m.resolve()}var d,p,m,f,g,v=o.task,h=o.$parent.settings||{},b=v.$script||{},q=v.name||b.name;v&&(h.skip&&(r.on("keydown",u),o.$on("$destroy",function(){r.off("keydown",u),r.off("keydown",c)})),a.current=i.piGlobal.current=b.current||{},q&&(n.extend(a.current,i.piGlobal[q]||{}),i.piGlobal[q]=b.current),m=e(v,s,o.$new()),f=m.promise,d=t(v.canvas),f["finally"](d),v.title&&(p=r[0].title,r[0].title=v.title,f["finally"](function(){r[0].title=p})),f["finally"](function(){o.$emit("task:done",g)}))}}}var n=e("underscore");return t.$inject=["taskActivate","managerCanvas","$document","$window","$rootScope"],t}),define("taskManager/task/taskModule",["require","angular","underscore","./taskActivateProvider","./taskDirective"],function(e){var t=e("angular"),n=t.module("pi.task",[]),r=e("underscore");return n.provider("taskActivate",e("./taskActivateProvider")),n.directive("piTask",e("./taskDirective")),n.config(["taskActivateProvider",function(e){function t(e,t,n,r,i,a){var o;return a.name&&(i.name=a.name),n.script=i,t.append("<div pi-quest></div>"),o=t.contents(),r(o)(n),o.controller("piQuest").task.promise["finally"](function(){e()}),function(){o.scope().$destroy(),o.remove()}}t.$inject=["done","$element","$scope","$compile","script","task"],e.set("quest",t)}]),n.config(["taskActivateProvider",function(e){function t(e,t,n,r,i){var a;return r.script=n,t.append("<div pi-message></div>"),a=t.contents(),i(a)(r),r.$on("message:done",function(){e()
}),function(){r.$destroy(),a.remove()}}t.$inject=["done","$element","task","$scope","$compile"],e.set("message",t)}]),n.config(["taskActivateProvider",function(e){function t(e,t,n,i){var a,o;return o=requirejs.config({context:r.uniqueId(),baseUrl:"../bower_components/PIPlayer/dist/js",paths:{text:["//cdnjs.cloudflare.com/ajax/libs/require-text/2.0.3/text.min","../../bower_components/requirejs-text/text"],jquery:["//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min","../../bower_components/jquery/dist/jquery.min"],underscore:["//cdnjs.cloudflare.com/ajax/libs/lodash.js/3.5.0/lodash.min","../../bower_components/lodash-compat/lodash.min"],backbone:["//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min","../../bower_components/backbone/backbone"]},deps:["jquery","backbone","underscore"]}),n.name&&(i.name=n.name),t.append("<div pi-player></div>"),a=t.contents(),a.addClass("pi-spinner"),o(["activatePIP"],function(t){a.removeClass("pi-spinner"),t(i,e)}),function(){a.remove(),o(["app/task/main_view"],function(e){e.deferred.resolve(),e.destroy()})}}t.$inject=["done","$element","task","script"],e.set("pip",t)}]),n}),define("taskManager/canvas/canvasConstructor",["require","underscore"],function(e){function t(e,t){var i;if(!r.isPlainObject(e))throw new Error("canvas(map): You must set a rule map for canvas to work properly");if(r.isUndefined(t))return r.noop;if(!r.isPlainObject(t))throw new Error("canvas(settings): canvas settings must be an object");return i=r.map(t,function(t,r){var i=e[r];if(i)return n(i.element,i.property,t);throw new Error("canvas("+r+"): unknow key in canvas object.")}),function(){r.forEach(i,function(e){e.call()})}}function n(e,t,n){var i=e.css(t);return e.css(t,n),r.bind(e.css,e,t,i)}var r=e("underscore");return t}),define("taskManager/canvas/managerCanvasService",["require","underscore","angular","./canvasConstructor"],function(e){function t(e,t){var a=r.element(t[0].body),o={background:{element:a,property:"backgroundColor"},canvasBackground:{element:e,property:"backgroundColor"},fontSize:{element:e,property:"fontSize"},fontColor:{element:e,property:"color"}};return n.bind(i,null,o)}var n=e("underscore"),r=e("angular"),i=e("./canvasConstructor");return t.$inject=["$rootElement","$document"],t}),define("taskManager/canvas/canvasModule",["require","angular","./managerCanvasService"],function(e){var t=e("angular"),n=t.module("pi.canvas",[]);return n.service("managerCanvas",e("./managerCanvasService")),n}),define("utils/helperDirectives/piSwap/piSwapDirective",["require","underscore"],function(e){function t(e){this.$scope=e}function n(e,n){return{transclude:!0,controller:t,controllerAs:"ctrl",compile:function(){return{pre:this.pre,post:function(){}}},pre:function(e,t,i,a,o){function s(e){var t=e||{};m&&(m.remove(),m=null),d&&(d.$destroy(),d=null),p&&(n.leave(p,function(){m=null,t.postLeave&&t.postLeave()}),m=p,p=null)}function u(t,i){var a=i||{};if(a.pre&&a.pre(),!t)return s(a);var u=r.extend(e.$new(),t);o(u,function(e){l(e,a.animate),s(a),p=e,d=u,n.enter(p,f,null,function(){a.post&&a.post()})})}function c(e){r.extend(d,e)}function l(e,t){if(t){var n=t.split(" ");r.each(n,function(e){$injector.has("."+e+"-animation")||piConsole(["page","animation"]).error('Unknown animation type: "'+e+'"')}),e.addClass(t)}}e.enter=u,e.empty=s,e.refresh=c;var d,p,m,f=t}}}var r=e("underscore");return t.$inject=["$scope"],r.extend(t.prototype,{next:function(e,t){this.$scope.enter(e,t)},prev:function(e,t){this.$scope.enter(e,t)},refresh:function(e){this.$scope.refresh(e)},empty:function(e){this.$scope.empty(e)}}),n.$inject=["$compile","$animate"],n}),define("text!utils/helperDirectives/piSpinner/spinner.html",[],function(){return'<div>\n	<img ng-if="spinner" class="pi-logo" src="img/loader.gif" />\n	<div ng-if="!spinner" ng-transclude></div>\n</div>'}),define("utils/helperDirectives/piSpinner/piSpinnerDirective",["require","text!./spinner.html"],function(e){function t(){return{transclude:!0,replace:!0,template:n,require:[],scope:{spinner:"=piSpinner"}}}var n=e("text!./spinner.html");return t.$inject=[],t}),define("utils/helperDirectives/helperDirectivesModule",["require","angular","./piSwap/piSwapDirective","./piSpinner/piSpinnerDirective"],function(e){var t=e("angular"),n=t.module("piHelperDirective",[]);return n.directive("piSwap",e("./piSwap/piSwapDirective")),n.directive("piSpinner",e("./piSpinner/piSpinnerDirective")),n}),define("taskManager/managerService",["require","underscore"],function(e){function t(e,t,r,i,a){function o(e,t){var n=this,i=t.settings||{};return this instanceof o?(this.$scope=e,this.script=t,this.sequence=new r(t),s(e,i),e.$on("manager:next",function(e,t){switch(t||(t={type:"next"}),t.type){case"current":n.load(t);break;case"prev":n.prev(t);break;case"next":default:n.next(t)}}),void e.$on("manager:prev",function(){n.prev()})):new o(e,t)}function s(e,t){var n,r=a.get("managerCanvas"),i=a.get("$document"),o=a.get("piPreloader");n=r(t.canvas),e.$on("$destroy",n),o.loadArr("image",t.preloadImages||[]),t.title&&(i[0].title=t.title)}return n.extend(o.prototype,{next:function(e){this.sequence.next(),this.load(e)},prev:function(e){this.sequence.prev(),this.load(e)},current:function(){return this.sequence.current()},load:function(e){var t=this.current(),n=this.$scope,r={baseUrl:this.baseUrl,bustCache:e&&e.bustCache};t?i(t,r).then(function(){n.$emit("manager:loaded")}):n.$emit("manager:loaded")},setBaseUrl:function(e){this.baseUrl=e}}),o}var n=e("underscore");return t.$inject=["$rootScope","$q","managerSequence","managerTaskLoad","$injector"],t}),define("taskManager/managerSequence",["require","underscore"],function(e){function t(e){function t(n){var r;return this instanceof t?(r=this.db=new e,r.createColl("tasks"),r.add("tasks",n.tasksSets||[]),void(this.sequence=r.sequence("tasks",n.sequence))):new t(n)}return n.extend(t.prototype,{next:function(){return this.sequence.next(),this},prev:function(){return this.sequence.prev(),this},current:function(){return this.sequence.current()}}),t}var n=e("underscore");return t.$inject=["Database"],t}),define("taskManager/managerLoadService",["require","underscore"],function(e){function t(e,t){function r(r){var i=n.isString(r)?t(r):r;return e.when(i)}return r}var n=e("underscore");return t.$inject=["$q","managerGetScript"],t}),define("taskManager/managerGetScriptService",["require"],function(e){function t(t){function n(n,r){r||(r={});var i=t.defer(),a="";return/^\/|:/.test(n)||(a+=r.baseUrl?r.baseUrl+"/":""),a+=n,r.isText&&(a="text!"+a),r.bustCache&&(a+="?bust="+(new Date).getTime()),e([a],function(e){i.resolve(e)},function(e){i.reject(e)}),i.promise}return n}return t.$inject=["$q"],t}),define("taskManager/managerTaskLoadService",["require","underscore"],function(e){function t(e,t,r){function i(e,i){return t(e,i).then(function(t){var i;if(n.isUndefined(t))throw i=new Error("Task "+e+" failed or has not been found. Make sure that you returned the script and that your script does not have any errors"),r("task").error(i),i;return t})}function a(t,a){var o,s,u;if(s=t.scriptUrl?i(t.scriptUrl,a):t.script,u=t.templateUrl?i(t.templateUrl,n.extend({isText:!0},a)):t.template,!s&&!u)throw new Error('Tasks must have either a "script" property or a "scriptUrl" property (or a "template" property in specific cases).');return o=e.all({script:e.when(s),template:e.when(u)}),o.then(function(e){return t.$script=e.script,t.$template=e.template,t},function(e){r("load").error("Failed to load task script - make sure that your URLs are all correct.",e)}),o}return a}var n=e("underscore");return t.$inject=["$q","managerGetScript","piConsole"],t}),define("taskManager/managerDirective",["require","underscore"],function(e){function t(e,t,n,i){function a(a){function o(n){function i(e){return r.isString(e)?e.substring(0,e.lastIndexOf("/")):void 0}e.script=n,e.settings=n&&n.settings||{},c.manager=new t(e,n),c.manager.setBaseUrl(i(u)),e.$emit("manager:next")}function s(e){i("manager").error("Failed to load "+u,e)}var u,c=this;try{u=e.$eval(a)}catch(l){}finally{u||(u=a)}n(u).then(o,s)}this.init=a}function n(e,n,i){return{priority:1e3,replace:!0,template:'<div pi-swap><div pi-task="task" ng-class="{\'pi-spinner\':loading}"></div></div>',controller:t,require:["piManager","piSwap"],link:function(t,a,o,s){function u(){t.loading=!1,f=m,m=v.manager.current(),i("manager").debug("Manager:currentTask",m),m?c():l()}function c(){var e={prevTask:f,currentTask:m};p([t.settings.onPreTask,f&&f.post,m.pre,r.bind(g.next,g,{task:m,settings:t.settings}),function(){t.loading=!1}],e)}function l(){var e={prevTask:f,currentTask:m};p([f&&f.post,r.bind(g.empty,g),t.settings.onEnd,function(){t.loading=!1,t.$emit("manager:done")}],e)}function d(e,n){e.stopPropagation(),t.loading=!0,t.$emit("manager:next",n)}function p(t,a){var o=e.when();r(t).map(function(t){return function(){var i=r.isFunction(t)?n.invoke(t,null,a||{}):t;return e.when(i)}}).reduce(function(e,t){return e.then(t,function(e){i("manager").error("There was an error in the task sequence. ",e)})},o)}var m,f,g=s[1],v=s[0];v.init(o.piManager),t.$on("manager:loaded",u),t.$on("task:done",d),t.loading=!0}}}var r=e("underscore");return t.$inject=["$scope","managerService","managerLoad","piConsole"],n.$inject=["$q","$injector","piConsole"],n}),define("taskManager/managerTaskDirective",[],function(){function e(){return{priority:1e3,template:'<div pi-manager="script"></div>',compile:function(){return{pre:function(e,t,n){var r,i=n.piManagerTask;try{r=e.$eval(i)}catch(a){}var o=r?r:{scriptUrl:i};e.script={sequence:[o]}}}}}}return e}),define("taskManager/managerModule",["require","angular","./task/taskModule","./canvas/canvasModule","utils/utils/utilsModule","utils/helperDirectives/helperDirectivesModule","utils/console/consoleModule","./managerService","./managerSequence","./managerLoadService","./managerGetScriptService","./managerTaskLoadService","./managerDirective","./managerTaskDirective"],function(e){var t=e("angular"),n=t.module("taskManager",[e("./task/taskModule").name,e("./canvas/canvasModule").name,e("utils/utils/utilsModule").name,e("utils/helperDirectives/helperDirectivesModule").name,e("utils/console/consoleModule").name]);return n.service("managerService",e("./managerService")),n.service("managerSequence",e("./managerSequence")),n.service("managerLoad",e("./managerLoadService")),n.service("managerGetScript",e("./managerGetScriptService")),n.service("managerTaskLoad",e("./managerTaskLoadService")),n.directive("piManager",e("./managerDirective")),n.directive("piManagerTask",e("./managerTaskDirective")),n}),define("utils/animations/rafPolyfill",[],function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var r=0;window.requestAnimationFrame=function(e){var t=+new Date,n=Math.max(r+16,t);return setTimeout(function(){e(r=n)},n-t)},window.cancelAnimationFrame=clearTimeout}}),define("utils/animations/dropInAnimation",[],function(){function e(e,t){var n=60,r=300,i=e.requestAnimationFrame,a=e.cancelAnimationFrame;return{enter:function(e,o){function s(){var e=t()-l,d=e/r;return e>r?(c.style.top=0,a(u),void o()):(c.style.top=n*(d-1)+"px",void(u=i(s)))}var u,c=e[0],l=t();return e.css({top:-n+"px"}),u=i(s),function(t){t&&(a(u),e.css({top:"0px"}))}},leave:function(e,o){function s(){var e=t()-l,d=1-e/r;return e>r?(a(u),void o()):(c.style.top=n*(d-1)+"px",void(u=i(s)))}var u,c=e[0],l=t();return u=i(s),function(e){e&&a(u)}}}}return["$window","timerNow",e]}),define("utils/animations/fadeAnimation",[],function(){function e(e,t){var n=300,r=e.requestAnimationFrame,i=e.cancelAnimationFrame;return{enter:function(e,a){function o(){var e=t()-c,l=e/n;return e>n?(u.style.opacity=1,i(s),void a()):(u.style.opacity=l,void(s=r(o)))}var s,u=e[0],c=t();return u.style.opacity=0,s=r(o),function(e){e&&(i(s),u.style.opacity=1)}},leave:function(e,a){function o(){var e=t()-c,l=1-e/n;return e>n?(u.style.opacity=0,i(s),void a()):(u.style.opacity=l,void(s=r(o)))}var s,u=e[0],c=t();return s=r(o),function(e){e&&(i(s),u.style.opacity=0)}}}}return["$window","timerNow",e]}),define("utils/animations/slideAnimation",[],function(){function e(e,t){var n=300,r=e.requestAnimationFrame,i=e.cancelAnimationFrame;return{enter:function(e,a){function o(){var e=t()-c,l=1-e/n;return e>n?(u.style.left="0%",i(s),void a()):(u.style.left=100*-l+"%",void(s=r(o)))}var s,u=e[0],c=t();return u.style.left="-100%",s=r(o),function(e){e&&(i(s),u.style.left="0%")}},leave:function(e,a){function o(){var e=t()-c,l=e/n;return e>n?(u.style.left="100%",i(s),void a()):(u.style.left=100*l+"%",void(s=r(o)))}var s,u=e[0],c=t();return s=r(o),function(e){e&&(i(s),u.style.left="100%")}}}}return["$window","timerNow",e]}),define("utils/animations/animationModule",["require","angular","animate","./rafPolyfill","./dropInAnimation","./fadeAnimation","./slideAnimation"],function(e){var t=e("angular");e("animate"),e("./rafPolyfill");var n=t.module("pi.animate",["ngAnimate"]);return n.animation(".drop-in",e("./dropInAnimation")),n.animation(".fade",e("./fadeAnimation")),n.animation(".slide",e("./slideAnimation")),n}),define("app",["require","angular","underscore","quest/questModule","message/messageModule","taskManager/managerModule","utils/animations/animationModule","utils/console/consoleModule"],function(e){var t=e("angular"),n=e("underscore"),r=[e("quest/questModule").name,e("message/messageModule").name,e("taskManager/managerModule").name,e("utils/animations/animationModule").name,e("utils/console/consoleModule").name],i=t.module("piApp",r);return i.run(["$rootScope","$rootElement","$parse","$window",function(e,t,r,i){var a=t.attr("pi-global"),o=r(a)(i);window.piGlobal||(window.piGlobal={}),e.global=window.piGlobal,o&&n.extend(e.global,o)}]),i.config(["$provide",function(e){var t="$$watchers",n="$$nextSibling",r="$$childHead",i="$$childTail",a="$$listeners",o="$$listenerCount",s="$id",u="$$childScopeClass",c="$parent",l="$$prevSibling";e.decorator("$rootScope",["$delegate",function(e){function d(){return++e.$id}var p=Object.getPrototypeOf(e);return p.$new=function(e){var m;return e?(m=new p.constructor,m.$root=this.$root,m.$$asyncQueue=this.$$asyncQueue,m.$$postDigestQueue=this.$$postDigestQueue):(this.$$childScopeClass||(this.$$childScopeClass=function(){this[t]=this[n]=this[r]=this[i]=null,this[a]={},this[o]={},this[s]=d(),this[u]=null},this.$$childScopeClass.prototype=this),m=new this.$$childScopeClass),m["this"]=m,m[c]=this,m[l]=this.$$childTail,this.$$childHead?(this.$$childTail.$$nextSibling=m,this.$$childTail=m):this.$$childHead=this.$$childTail=m,m},e.$new=p.$new,e}])}]),i}),define("pipScorer/computeD",["jquery"],function(e){function t(){e.extend(this,{dataArray:{},AnalyzedVar:"latency",ErrorVar:"error",condVar:"",cond1VarValues:[],cond2VarValues:[],parcelVar:"",parcelValue:[],fastRT:300,maxFastTrialsRate:.1,minRT:400,maxRT:1e4,maxErrorParcelRate:.4,errorLatency:{use:"latency",penalty:600,useForSTD:!0},postSettings:{}})}return e.extend(t.prototype,{setComputeObject:function(t){e.extend(this,t)},setDataArray:function(){var e=window.piGlobal;this.dataArray=e.current.logs}}),t}),define("pipScorer/msgMan",["underscore"],function(e){function t(){this.messages=e.extend({},n)}var n={MessageDef:[],manyErrors:"There were too many errors made to determine a result.",tooFast:"There were too many fast trials to determine a result.",notEnough:"There were not enough trials to determine a result."};return e.extend(t.prototype,{setMsgObject:function(t){e.extend(this.messages,t)},getScoreMsg:function(t){var n=this.messages.MessageDef;if(!n||!n.length)throw new Error('You must define a "MessageDef" array.');var r=parseFloat(t),i=null,a=null,o="error: msg was not set",s=!1;if(e.each(n,function(e){i=parseFloat(e.cut),a=e.message,i>=r&&!s&&(o=a,s=!0)}),!s){var u=n.length,c=n[u-1];o=c.message}return o},getMessage:function(e){return this.messages[e]}}),t}),define("pipScorer/parcelMng",["underscore"],function(e){function t(e){this.parcelArray=[],this.scoreData={},this.msgMan=e}return e.extend(t.prototype,{Init:function(t){var n=this,r=this.msgMan,i=window.piGlobal,a=i.current.logs;n.parcelArray=[],n.scoreData={},n.msgMan=r;var o=t.AnalyzedVar,s=t.ErrorVar,u=t.parcelVar,c=t.parcelValue,l=t.minRT,d=t.maxRT,p=t.fastRT,m=0,f=0,g=0,v=0,h=parseFloat(t.maxFastTrialsRate);if("undefined"==typeof c||0===c.length){g=0,m=0,f=0,v=0;var b={};b.name="general",b.trialIData=[],e.each(a,function(e){e[o]>=l&&e[o]<=d?(g++,1==e.data[s]&&v++,n.validate(b,e,t)&&m++):e[o]<=p&&f++}),n.checkErrors(g,v,t),n.parcelArray[0]=b}else e.each(c,function(r,i){g=0,m=0,f=0,v=0;var c={};c.name=r,c.trialIData=[],e.each(a,function(e){var i=e.data[u];i==r&&(e[o]>=l&&e[o]<=d?(g++,1==e.data[s]&&v++,n.validate(c,e,t)&&m++):e[o]<=p&&f++)}),n.checkErrors(g,v,t),n.parcelArray[i]=c});f/m>h&&(n.scoreData.errorMessage=this.msgMan.getMessage("tooFast"))},checkErrors:function(e,t,n){var r=n.maxErrorParcelRate;t/e>r&&(this.scoreData.errorMessage=this.msgMan.getMessage("manyErrors"))},validate:function(e,t,n){var r=n.errorLatency,i=n.ErrorVar,a=t.data;return"latency"==r.use?(e.trialIData.push(t),!0):"false"==r.use?"1"==a[i]?!1:(e.trialIData.push(t),!0):"penalty"==r.use?(e.trialIData.push(t),!0):void 0},addPenalty:function(t,n){var r=n.errorLatency,i=this;if("penalty"==r.use){var a=parseFloat(r.penalty),o=n.ErrorVar,s=n.AnalyzedVar,u=n.condVar,c=n.cond1VarValues,l=n.cond2VarValues,d=t.trialIData,p=t.avgCon1,m=t.avgCon2;e.each(d,function(e){var t=e.data,n=t[o],r=t[u],d=i.checkArray(r,c),f=i.checkArray(r,l);"1"==n&&(d?e[s]+=p+a:f&&(e[s]+=m+a))})}},avgAll:function(t){var n=this;e.each(n.parcelArray,function(e){n.avgParcel(e,t)})},avgParcel:function(t,n){var r=this,i=t.trialIData,a=n.condVar,o=n.cond1VarValues,s=n.cond2VarValues,u=n.AnalyzedVar,c=0,l=0,d=0,p=0,m=0,f=0;e.each(i,function(e){var t=e[u],n=e.data;d+=t,f++;var i=n[a],g=r.checkArray(i,o),v=r.checkArray(i,s);g?(p++,c+=t):v&&(m++,l+=t)}),(2>=p||2>=m)&&(r.scoreData.errorMessage=this.msgMan.getMessage("notEnough")),0!==p&&(c/=p),0!==m&&(l/=m),t.avgCon1=c,t.avgCon2=l,t.diff=t.avgCon1-t.avgCon2,0!==f&&(t.avgBoth=d/f),r.addPenalty(t,n)},checkArray:function(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(r==e)return!0}return!1},varianceAll:function(t){var n=this;e.each(n.parcelArray,function(e){n.varianceParcel(e,t)})},varianceParcel:function(t,n){var r=this,i=n.AnalyzedVar,a=t.trialIData,o=n.cond1VarValues,s=n.cond2VarValues,u=n.condVar,c=t.avgBoth,l=0,d=0,p=[],m=[],f=[],g=n.errorLatency,v=g.useForSTD;e.each(a,function(e){var t=e.data,a=e[i],c=n.ErrorVar,l=t[c],d=t[u],f=r.checkArray(d,o),g=r.checkArray(d,s);f?v?p.push(a):"0"==l&&p.push(a):g&&(v?m.push(a):"0"==l&&p.push(a))}),f=p.concat(m),e.each(f,function(e){var t=e;l=t-c,d+=l*l}),t.variance=d/(f.length-1)},scoreAll:function(t){var n=this,r=0;e.each(n.parcelArray,function(e){n.scoreParcel(e,t),r+=e.score});var i=r/n.parcelArray.length;n.scoreData.score=i.toFixed(2)},scoreParcel:function(e){var t=this,n=Math.sqrt(e.variance);0===n?(t.scoreData.errorMessage=this.msgMan.getMessage("notEnough"),e.score=e.diff):e.score=e.diff/n}}),t}),define("pipScorer/Scorer",["jquery","./computeD","./msgMan","./parcelMng"],function(e,t,n,r){function i(){this.computeData=new t,this.msgMan=new n,this.parcelMng=new r(this.msgMan)}return!!window.console||(console={log:e.noop,error:e.noop}),console.log||(console.log=function(){}),e.extend(i.prototype,{addSettings:function(e,t){switch(e){case"compute":this.computeData.setComputeObject(t);break;case"message":this.msgMan.setMsgObject(t);break;default:throw new Error('SCORER:addSettings: unknow "type" '+e)}},computeD:function(){var e=this.computeData,t=this.parcelMng;e.setDataArray(),t.Init(e),t.avgAll(e),t.varianceAll(e),t.scoreAll(e);var n=t.scoreData,r={};return void 0===n.errorMessage||null===n.errorMessage?(r.FBMsg=this.getFBMsg(n.score),r.DScore=n.score):(r.FBMsg=n.errorMessage,r.DScore=""),r},postToServer:function(t,n,r,i){var a=this.computeData.postSettings||{},o=a.url,s={};return r||(r=a.score),i||(i=a.msg),s[r]=t,s[i]=n,e.post(o,JSON.stringify(s))},dynamicPost:function(t){var n=this.computeData.postSettings||{},r=n.url;return e.post(r,JSON.stringify(t))},getFBMsg:function(e){var t=this.msgMan.getScoreMsg(e);return t}}),i}),define("pipScorer",["pipScorer/Scorer"],function(e){return e}),define("pipScorer",["pipScorer/Scorer"],function(e){return e}),define("APIs/APIConstructor",["require","underscore"],function(e){function t(t){function a(){var e=this.script={name:"anonymous "+t.type,settings:{},current:{},sequence:[]};this.settings=e.settings,r.forEach(t.sets,function(t){e[t+"Sets"]=[]})}return r.forEach(t.sets,function(e){a.prototype[r.camelCase("add-"+e+"-set")]=n(e)}),r.extend(a.prototype,{setName:function(e){this.script.name=e},addSettings:function(e,t){var n;return r.isPlainObject(t)?(n=this.settings[e]=this.settings[e]||{},r.extend(n,t)):this.settings[e]=t,this},addSequence:function(e){var t=this.script;return r.isArray(e)||(e=[e]),t.sequence=t.sequence.concat(e),this},addGlobal:function(e){if(!r.isPlainObject(e))throw new Error("global must be an object");return r.merge(i,e)},getGlobal:function(){return i},addCurrent:function(e){if(!r.isPlainObject(e))throw new Error("current must be an object");return r.merge(this.script.current,e)},getCurrent:function(){return this.script.current},addScript:function(e){return r.merge(this.script,e)},getScript:function(){return this.script},post:function(t,n){if(e.defined("jquery"))return e("jquery").ajax({type:"POST",url:t,data:JSON.stringify(n),contentType:"application/json; charset=utf-8",dataType:"json"});var r=angular.injector(["ng"]);return r.invoke(["$http",function(e){return e.post(t,n)}])},shuffle:function(e){return r.shuffle(e)}}),a}function n(e){function t(t,n){var i,a=this.script[e+"Sets"]||(this.script[e+"Sets"]=[]);r.isPlainObject(t)&&(i=r(t).map(function(e,t){return r.each(e,function(e){e.set=t}),e}).flatten().value()),r.isArray(t)&&(i=t),r.isString(t)&&(i=r.isArray(n)?n:[n],i=r.map(i,function(e){return e.set=t,e})),a.push.apply(a,i)}return t}window.piGlobal||(window.piGlobal={});var r=e("underscore"),i=window.piGlobal;return t}),define("pipAPI/pipAPI",["require","APIs/APIConstructor"],function(e){var t=e("APIs/APIConstructor"),n=t({type:"PIP",sets:["trial","stimulus","media"]});return n.prototype.addTrialSets=n.prototype.addTrialSet,n.prototype.addStimulusSets=n.prototype.addStimulusSet,n.prototype.addMediaSets=n.prototype.addMediaSet,n.prototype.getLogs=function(){return this.script.current.logs},n}),define("questAPI/questAPI",["require","APIs/APIConstructor"],function(e){var t=e("APIs/APIConstructor");return t({type:"quest",sets:["pages","questions"]})}),define("managerAPI/managerAPI",["require","APIs/APIConstructor"],function(e){var t=e("APIs/APIConstructor");return t({type:"manager",sets:["tasks"]})});
//# sourceMappingURL=bootstrap.js
//# sourceMappingURL=bootstrap.js.map
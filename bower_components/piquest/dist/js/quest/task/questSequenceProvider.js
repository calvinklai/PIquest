define(["require","underscore"],function(e){function n(e){function n(t,n){if(!n)throw new Error("Sequences need to take a db as the second argument");this.sequence=new e("pages",t,n),this.db=n}return t.extend(n.prototype,{next:function(e){return this.sequence.next(e),this},prev:function(e){return this.sequence.prev(e),this},current:function(n){var r,i=this.sequence.current(n);if(!i)return i;i.questions?r=t.isArray(i.questions)?i.questions:[i.questions]:r=[];var s=(new e("questions",r,this.db)).all({pagesData:i.data,pagesMeta:i.$meta});return i=t.clone(i,!0),i.questions=s,i}}),n}var t=e("underscore");return n.$inject=["TaskSequence"],n});
define(["require","underscore"],function(e){function n(e,n,r){function i(e,i,s){return n(e,i,s).then(function(n){var i;if(t.isUndefined(n))throw i=new Error("Task "+e+" failed or has not been found. Make sure that you returned the script and that your script does not have any errors"),r("task").error(i),i;return n})}function s(t,n){var s,o,u;o=t.scriptUrl?i(t.scriptUrl,n):t.script,u=t.templateUrl?i(t.templateUrl,n,!0):t.template;if(!o&&!u)throw new Error('Tasks must have either a "script" property or a "scriptUrl" property (or a "template" property in specific cases).');return s=e.all({script:e.when(o),template:e.when(u)}),s.then(function(e){return t.$script=e.script,t.$template=e.template,t},function(e){r("load").error("Failed to load task script - make sure that your URLs are all correct.",e)}),s}return s}var t=e("underscore");return n.$inject=["$q","managerGetScript","piConsole"],n});
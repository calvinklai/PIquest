define(["require","underscore"],function(e){function n(e,n,r,i,s){function o(e,t){var n=this,i=t.settings||{};if(!(this instanceof o))return new o(e,t);this.$scope=e,this.script=t,this.sequence=new r(t),u(e,i),e.$on("manager:next",function(e,t){t||(t={type:"next"});switch(t.type){case"current":n.load(t);break;case"prev":n.prev(t);break;case"next":default:n.next(t)}}),e.$on("manager:prev",function(){n.prev()})}function u(e,t){var n=s.get("managerCanvas"),r=s.get("$document"),i=s.get("piPreloader"),o;o=n(t.canvas),e.$on("$destroy",o),i.loadArr("image",t.preloadImages||[]),t.title&&(r[0].title=t.title)}return t.extend(o.prototype,{next:function(e){this.sequence.next(),this.load(e)},prev:function(e){this.sequence.prev(),this.load(e)},current:function(){return this.sequence.current()},load:function(e){var t=this.current(),n=this.$scope,r={baseUrl:this.baseUrl,bustCache:e&&e.bustCache};t?i(t,r).then(function(){n.$emit("manager:loaded")}):n.$emit("manager:loaded")},setBaseUrl:function(e){this.baseUrl=e}}),o}var t=e("underscore");return n.$inject=["$rootScope","$q","managerSequence","managerTaskLoad","$injector"],n});
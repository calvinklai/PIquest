<!DOCTYPE html>
<html lang="en">
	<head>

		<!-- Meta, title, CSS, favicons, etc. -->
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Bootstrap, a sleek, intuitive, and powerful mobile first front-end framework for faster and easier web development.">
		<meta name="keywords" content="HTML, CSS, JS, JavaScript, framework, bootstrap, front-end, frontend, web development">
		<meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">

		<title>
			 piQuest 
			&middot; V0.0
		</title>

		
		<!-- Bootstrap core CSS -->
		<link href="../../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
		<link href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/sunburst.min.css" rel="stylesheet">
		<link href="../css/style.css" rel="stylesheet">
		<style type="text/css">
			pre {display:block;overflow-x:auto;padding:0.5em;background:#000;color:#f8f8f8;-webkit-text-size-adjust:none}
			table {padding: 0;}
			table tr {border-top: 1px solid #cccccc;background-color: white;margin: 0;padding: 0;}
			table tr:nth-child(2n) {background-color: #f8f8f8;}
			table tr th {font-weight: bold;border: 1px solid #cccccc;text-align: left;margin: 0;padding: 6px 13px;}
			table tr td {border: 1px solid #cccccc;text-align: left;margin: 0;padding: 6px 13px;}
			table tr th :first-child, table tr td :first-child {margin-top: 0;}
			table tr th :last-child, table tr td :last-child {margin-bottom: 0;}
		</style>
		

		<!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
		<!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->

		<!-- Favicons -->
		<link rel="apple-touch-icon" href="../apple-touch-icon.png">
		<link rel="icon" href="../favicon.ico">

	</head>

	<body>
		<a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>

		<!-- Docs master nav -->
		<header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
			<div class="container">
				<div class="navbar-header">
					<button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a href="../../" class="navbar-brand">Project Implicit</a>
				</div>
				<nav class="collapse navbar-collapse bs-navbar-collapse">
					<ul class="nav navbar-nav">
						<li class=" active ">
							<a href="../quest/overview.html">piQuest</a>
						</li>
						<li class="">
							<a href="../manager/overview.html">piManager</a>
						</li>
						<li>
							<a href="/PIPlayer">piPlayer</a>
						</li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li><a href="https://github.com/ProjectImplicit/PIquest">Github</a></li>
					</ul>
				</nav>
			</div>
		</header>

		<div id="content" class="bs-docs-header">
			<div class="container">
				
	<h1>API</h1>
	<p>All the little details...</p>

			</div>
		</div>

		<div class="container bs-docs-container">
			<div class="row">
				<div class="col-md-9" role="main">
					
	<h3 id="table-of-contents">Table of contents</h3>
<ul>
<li><a href="#pages">Pages</a>    </li>
<li><a href="#questions">Questions</a><ul>
<li><a href="#text-textarea">text &amp; textarea</a></li>
<li><a href="#textnumber">textNumber</a></li>
<li><a href="#dropdown">dropdown</a></li>
<li><a href="#selectone-selectmulti">selectOne &amp; selectMulti</a></li>
<li><a href="#grid">grid</a></li>
<li><a href="#slider">slider</a></li>
</ul>
</li>
<li><a href="#settings">Settings</a><ul>
<li><a href="#onend">onEnd</a></li>
<li><a href="#logger">logger</a></li>
<li><a href="#debugging">Debugging</a></li>
</ul>
</li>
<li><a href="#making-your-questionnaire-dynamic">Making your questionnaire Dynamic</a><ul>
<li><a href="#mixer">The mixer </a><ul>
<li><a href="#mixer-types">Mixer types</a></li>
<li><a href="#conditions">Conditions</a></li>
<li><a href="#operators">Operators</a></li>
<li><a href="#aggregation">Aggregation</a></li>
</ul>
</li>
<li><a href="#variables">Variables</a></li>
<li><a href="#templates">Templates</a></li>
<li><a href="#inheritance">Inheritance </a></li>
</ul>
</li>
<li><a href="#development">Development</a>    </li>
</ul>
<h3 id="pages">Pages</h3>
<p>The basic unit in PIquest is the <strong>page</strong>. A page is usually one screen in your questionnaire. If your questionnaire presents all its questions in one screen, it will probably have only one page. The properties within a page manage how the question(s) is(are) displayed and how the participants interact with it (e.g., select an answer and then click a submit button).</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>name</td>
<td>(text) The identifier for this page, is used mainly for logging</td>
</tr>
<tr>
<td>decline</td>
<td>(true, false, ‘double’. default:false) Whether to allow participants decline to answer the questions on this page. This option displays a “decline” button that proceeds to the next page without validation and marks this response as “declined”. If decline is set to ‘double’ then two click are required in order to decline answering.</td>
</tr>
<tr>
<td>declineText</td>
<td>(text) The text for the decline button (default value: “Decline to answer”)</td>
</tr>
<tr>
<td>prev</td>
<td>(true or false) Whether to allow users to return to the previous page. The previous button does not appear on the first page (default value: false).</td>
</tr>
<tr>
<td>prevText</td>
<td>(text) The text for the previous button (default value: “Go Back”)</td>
</tr>
<tr>
<td>noSubmit</td>
<td>(true of false) remove submit button (useful when using the ‘autoSubmit’ function of some questions; default value: false).</td>
</tr>
<tr>
<td>submitText</td>
<td>(text) The text of the submit button (default: “Submit”).</td>
</tr>
<tr>
<td>header</td>
<td>(text) Text for the page header.</td>
</tr>
<tr>
<td>headerStyle</td>
<td>(Object) A A <a href="#http://api.jquery.com/css/#css-properties">css object</a>  to set the style of the header (see examples below).</td>
</tr>
<tr>
<td>progressBar</td>
<td>(text) Text for the progress bar (You might want to use a template for this, maybe something like: <code>&lt;%= pagesMeta.number %&gt; out of &lt;%= pagesMeta.outOf%&gt;</code>.).</td>
</tr>
<tr>
<td>numbered</td>
<td>(true of false) Whether to  display the number of each question (default value: false).</td>
</tr>
<tr>
<td>numberStart</td>
<td>(Number) The number for the first question in the page (default: 1).</td>
</tr>
<tr>
<td>timer</td>
<td>(Object) This property controls the page timer, its properties are documented right <a href="#page-timer">here</a>.</td>
</tr>
<tr>
<td>questions</td>
<td>(Array or Object) an array of <a href="#questions">questions</a> to be displayed in the page. Note that the questions may be randomized and chosen conditionally using a <a href="#mixer">mixer</a>. This property also accepts a single question object if you want to present only a single question per page.</td>
</tr>
<tr>
<td>lognow</td>
<td>(true or false) Whether to log the questions on this page. This option is useful when you know that the page will not be accessed any more. It allows you to use the <code>pulse</code> option from the <a href="#logger">logger</a> to send questions as they are being answered instead of sending only at the end of the task. (default: false)</td>
</tr>
<tr>
<td>animate</td>
<td>(text) What types of animation to use when this page enters and leaves the screen. We currently support three animations: fade, slide, and drop-in. You can use any and all of them by adding them to the string (for example: “slide fade” will activate both of these animations).</td>
</tr>
<tr>
<td>v1style</td>
<td>(true or false) Activate in order to use the version 0.1 style. Currently this only affects the way that the submit/decline buttons are presented.</td>
</tr>
</tbody>
</table>
<p>For example, a page can look something like this:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> page = {
    header: <span class="hljs-string">'Personal information:'</span>,
    headerStyle: {<span class="hljs-string">'background-color'</span>:<span class="hljs-string">'red'</span>,color:<span class="hljs-string">'blue'</span>},
    decline: <span class="hljs-literal">true</span>,
    declineText: <span class="hljs-string">'I prefer to keep this information to myself'</span>,
    questions: [
        {type:<span class="hljs-string">'text'</span>, stem:<span class="hljs-string">'What is your name?'</span>},
        {type:<span class="hljs-string">'text'</span>, stem:<span class="hljs-string">'Where do you live?'</span>}
    ]
}
</code></pre>
<h4 id="page-timer">Page Timer</h4>
<p>The page timer allows you to constrain the time that users have to answer their questions. In order to control it, you may use the following properties.</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>duration</td>
<td>(number) How long (in seconds) before the timer ends.</td>
</tr>
<tr>
<td>submitOnEnd</td>
<td>(true or false) Whether to submit when the timer ends (true by default).</td>
</tr>
<tr>
<td>show</td>
<td>(true or false) Whether to display a visual countdown (true by default).</td>
</tr>
<tr>
<td>direction</td>
<td>(“up” or “down”) Whether to use a countdown or to count up (“down” by default).</td>
</tr>
<tr>
<td>removeOnEnd</td>
<td>(true or false) Whether to remove the visual timer when the countdown ends (if you don’t auto proceed when the timer ends. ).        </td>
</tr>
<tr>
<td>message</td>
<td>(String or Object) Display a message at the end the timer duration. You can imput a simple string here, but if you want finer control over the content of the message you can use the <a href="#page-messages">object API</a>.</td>
</tr>
</tbody>
</table>
<h4 id="page-messages">Page Messages</h4>
<p>You may want to display a message to the users when they run out of time at the end of a timer. Messages can be simple strings, or if you want finer control over the content of the message you can use the object API, that may be used as follows:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>header</td>
<td>The header text for the message (defaults to “Timer Done”).</td>
</tr>
<tr>
<td>body</td>
<td>The body of the message.</td>
</tr>
<tr>
<td>button</td>
<td>The close button (defaults to “close”).</td>
</tr>
</tbody>
</table>
<p>All these strings may use templates, and have access to the following objects: <code>global</code>, <code>current</code>, <code>pageData</code>, <code>pageMeta</code>.</p>
<h3 id="questions">Questions</h3>
<p>Here are the types of questions PIQuest currently supports:</p>
<ul>
<li><a href="#text-textarea">text &amp; textarea</a></li>
<li><a href="#textnumber">textNumber</a></li>
<li><a href="#dropdown">dropdown</a></li>
<li><a href="#selectone-selectmulti">selectOne &amp; selectMulti</a></li>
<li><a href="#slider">slider</a></li>
</ul>
<p>All question types share some basic properties:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>(text; default: ‘text’) Controls the question type. See the possible types below. </td>
</tr>
<tr>
<td>name</td>
<td>(text) The name that this question is marked with when it is logged. Also allows you to refer to the question from within PIquest.</td>
</tr>
<tr>
<td>stem</td>
<td>(text; default: ‘’) The text for the question itself..</td>
</tr>
<tr>
<td>stemCss</td>
<td>A <a href="#http://api.jquery.com/css/#css-properties">css object</a> to be applied to the stem.</td>
</tr>
<tr>
<td>description</td>
<td>(text; default: ‘’) Any additional text you want in order to extend the question description.</td>
</tr>
<tr>
<td>maxWidth</td>
<td>Force question inputs to have this maximum width.</td>
</tr>
<tr>
<td>help</td>
<td>(true or false;  (default: false)) Whether to display the question help text.</td>
</tr>
<tr>
<td>helpText</td>
<td>(text) The question help text. (Some questions have default help texts, some don’t).</td>
</tr>
<tr>
<td>lognow</td>
<td>(true or false) Whether to log this questions when the page is submitted. This option is useful when you know that the question will not be accessed any more. It allows you to use the <code>pulse</code> option from the <a href="#logger">logger</a> to send questions as they are being answered instead of sending only at the end of the task. (default: false)</td>
</tr>
</tbody>
</table>
<p>You may want to debug questions by <a href="#debugging">activating the <code>question</code> DEBUG setting</a>. You will then be warned in the console if a question name is reused (note: sometimes a question is supposed to be reused, if this warning pops up just make sure the use case is correct).</p>
<h4 id="hooks">Hooks</h4>
<p>Questions have hooks that allow you to respond to many events in the life time of the question. Each hook is invoked with <code>global</code>, <code>current</code> and the question <code>log</code>. </p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>onCreate</td>
<td>At the creation of the question.</td>
</tr>
<tr>
<td>onChange</td>
<td>At each change of the question response (note that this hook may be called many times for each question).</td>
</tr>
<tr>
<td>onSubmit</td>
<td>When the question is submitted.</td>
</tr>
<tr>
<td>onDecline</td>
<td>When the question is declined.</td>
</tr>
<tr>
<td>onTimeout</td>
<td>When the timer finishes.</td>
</tr>
<tr>
<td>onDestroy</td>
<td>When the question is removed from the screen (either decline or submit).</td>
</tr>
</tbody>
</table>
<p>For example, in case the participant made an error you can mark it on the current object:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> questions = {
    stem: <span class="hljs-string">'Please write "Hello"'</span>,
    onSubmit: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(log, current)</span></span>{
        <span class="hljs-comment">// if the question response is not correct</span>
        <span class="hljs-keyword">if</span> (log.response !== <span class="hljs-string">'Hello'</span>){
            <span class="hljs-comment">// mark an arbitrary flag so that it may be accessed somewhere else</span>
            current.error = <span class="hljs-literal">true</span>;
        }
    }
}
</code></pre>
<h4 id="text-textarea">Text &amp; Textarea</h4>
<p>The <code>text</code> and <code>textarea</code> questions consist of a simple text input in which the users can type in text. The difference between them is that text questions consist of a single line, whereas textareas are multiline. There are also several properties that are unique to textareas.
Both types of questions support the following properties.</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dflt</td>
<td>(test; default value: “”) The default value for this question.</td>
</tr>
<tr>
<td>inline</td>
<td>Show the stem in the same line as the input box (this will make the input box narrower as well).</td>
</tr>
<tr>
<td>width</td>
<td>(Number or text) The width of the input box (By default numbers are translated to pixels, but you can use text to use other units).</td>
</tr>
<tr>
<td>autoSubmit</td>
<td>(true or false; default: false) If this property is set to true typing <code>Enter</code> while this input is focused will submit the page.</td>
</tr>
<tr>
<td>minLength</td>
<td>(Number) Validation: force at least this number of characters.</td>
</tr>
<tr>
<td>minlength</td>
<td>@DEPRECATED see minLength. (Number) Validation: force at least this number of characters.</td>
</tr>
<tr>
<td>maxlength</td>
<td>(Number) Validation: force at most this number of characters.</td>
</tr>
<tr>
<td>maxlengthLimit</td>
<td>(true or false) Do not allow the user to input more characters than defined by <code>maxlength</code> (if maxlength is not defined, any number of characters will be allowed).</td>
</tr>
<tr>
<td>required</td>
<td>(true of false; default: false) Validation: require a non-empty string as a response.</td>
</tr>
<tr>
<td>pattern</td>
<td>(text [supports regex]) Validation: require the response to match the regular expression set in pattern (takes either a string <code>“a&#124;b”</code> or a regular expression <code>/a&#124;b/</code>).</td>
</tr>
<tr>
<td>correct</td>
<td>(true or false; default: false) Validation: require the response to be correct (set the target value using <code>correctValue</code>)</td>
</tr>
<tr>
<td>correctValue</td>
<td>(*) Set the correct response value for the correct validation.</td>
</tr>
<tr>
<td>errorMsg</td>
<td>(Object: {}) This object has a property for each validation type. Setting the appropriate type changes the validation message. For instance setting the <code>required</code> property will change the validation message for instances where no response was given.</td>
</tr>
</tbody>
</table>
<p>The following properties are supported only by <code>textarea</code>s:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>rows</td>
<td>The number of visible text lines.</td>
</tr>
<tr>
<td>columns</td>
<td>The visible width of the textarea, in average character widths (this setting overrides the width setting).</td>
</tr>
</tbody>
</table>
<p>For example, this is a text question that requires a valid email address (although there are better <em>patterns</em> out there for this purpose):</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> quest = {
    stem: <span class="hljs-string">"Please type your email address"</span>,
    dflt: <span class="hljs-string">"my@email.com"</span>,
    required: <span class="hljs-literal">true</span>,
    pattern: <span class="hljs-regexp">/[A-Z0-9._%+-]+@[A-Z0-9.-]+.[A-Z]{2,4}/igm</span>,
    errorMsg: {
        required: <span class="hljs-string">"You must enter a valid email address."</span>,
        pattern: <span class="hljs-string">"This is not a valid email address"</span>
    }
}
</code></pre>
<h4 id="textnumber">textNumber</h4>
<p>The <code>textNumber</code> questions consist of a simple text input that limits the participant to numeric responses only. This type of questions have the following parameters:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dflt</td>
<td>(Number; default: null) The default value for this question.</td>
</tr>
<tr>
<td>inline</td>
<td>Show the stem in the same line as the input box (this will make the input box narrower as well).</td>
</tr>
<tr>
<td>autoSubmit</td>
<td>(true or false; default: false) If this property is set to true typing <code>Enter</code> while this input is focused will submit the form.</td>
</tr>
<tr>
<td>min</td>
<td>(Number) Validation: minimum valid number.</td>
</tr>
<tr>
<td>max</td>
<td>(Number) Validation: maximum valid number.</td>
</tr>
<tr>
<td>required</td>
<td>(true or false; default: false) Validation: require a non empty string as a response.</td>
</tr>
<tr>
<td>correct</td>
<td>(true or false; default: false) Validation: require the response to be correct (set the target value using <code>correctValue</code>)</td>
</tr>
<tr>
<td>correctValue</td>
<td>(*) Set the correct response value for the correct validation.</td>
</tr>
<tr>
<td>errorMsg</td>
<td>(Object: {}) This object has a property for each validation type. Setting the appropriate type changes the validation message. For instance setting the <code>required</code> property will change the validation message for instances where no response was given. Note that their is a special property <code>number</code> that is triggered whenever the response is not a valid number.</td>
</tr>
</tbody>
</table>
<p>For example, this is a text question that asks for a number under 273:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> quest = {
    type: <span class="hljs-string">'textNumber'</span>,
    stem: <span class="hljs-string">"Please enter your height in cm"</span>,
    max: <span class="hljs-number">273</span>,
    required: <span class="hljs-literal">true</span>,
    errorMsg: {
        max: <span class="hljs-string">"That is a bit too much to believe... - even Robert Wadlow wasn't this tall!"</span>,
        number: <span class="hljs-string">"Your height has to be a number"</span>
    }
}
</code></pre>
<h4 id="dropdown">dropdown</h4>
<p>The <code>dropdown</code> question presents a dropdown that the user can use to select a single response. It has the following parameters: </p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dflt</td>
<td>The default <em>value</em> for this question.</td>
</tr>
<tr>
<td>autoSubmit</td>
<td>(true or false; default: false) If this property is set to true, selecting a response will submit the form.</td>
</tr>
<tr>
<td>randomize</td>
<td>(true or false; default: false) Shuffle response options after mixing them (the mixer is activated regardless of this parameter, this serves as a shortcut)</td>
</tr>
<tr>
<td>reverse</td>
<td>(true or false; default: false) Reverses the order of response options in this question. It is useful when you inherit a question and only wants to change the order of the response options. Or, if you want to have a between-participant condition that reverses the response scale for half of the participants.</td>
</tr>
<tr>
<td>numericValues</td>
<td>(true or false; default: false) If <code>numericValues</code> is true, default numeric values are set for each answer, they are set <em>before</em> randomization, but <em>after</em> the mixer is activated.</td>
</tr>
<tr>
<td>answers</td>
<td>(Array: []) The list of possible answers for this question. There are two acceptable formats; (1) an array of strings/numbers, (2) an array of objects with <code>text</code>, <code>value</code> and optionally <code>group</code> parameters. The <code>group</code> parameter will display the values divided into groups with the same name.</td>
</tr>
<tr>
<td>required</td>
<td>(true or false; default: false) Validation: require a response.</td>
</tr>
<tr>
<td>correct</td>
<td>(true or false; default: false) Validation: require the response to be correct (set the target value using <code>correctValue</code>)</td>
</tr>
<tr>
<td>correctValue</td>
<td>(*) Set the correct response value for the correct validation.</td>
</tr>
<tr>
<td>errorMsg</td>
<td>(Object: {}) This object has a property for each validation type. Setting the appropriate type changes the validation message. For instance setting the <code>correct</code> property will change the validation message for instances where the correct response was not given.</td>
</tr>
</tbody>
</table>
<h4 id="selectone-selectmulti">selectOne &amp; selectMulti</h4>
<p>The <code>selectOne</code> and <code>selectMulti</code> questions present a list of possible response options for the user to pick from. The only difference between them is that select Multi allows the user to select more than one response option. They have the following parameters:</p>
<table>
<thead>
<tr>
<th>property</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>dflt</td>
<td>The default <em>value</em> for this question; Use one value for <code>selectOne</code>, and an array of values for <code>selectMulti</code>.</td>
</tr>
<tr>
<td>autoSubmit</td>
<td>(true or false; default: false) If this property is set to true, Clicking twice on the same answer will submit the form. This options is not supported for <code>selectMulti</code>.</td>
</tr>
<tr>
<td>randomize</td>
<td>(true or false; default: false) Shuffle response options after mixing them (the mixer is activated regardless of this parameter, this serves as a shortcut)</td>
</tr>
<tr>
<td>reverse</td>
<td>(true or false; default: false) Reverses the order of response options in this question. It is useful when you inherit a question and only wants to change the order of the response options. Or, if you want to have a between-participant condition that reverses the response scale for half of the participants.</td>
</tr>
<tr>
<td>numericValues</td>
<td>(true or false; default: false) If <code>numericValues</code> is true, default numeric values are set for each answer, they are set <em>before</em> randomization, but <em>after</em> the mixer is activated.</td>
</tr>
<tr>
<td>style</td>
<td>The default style for the select questions is a vertical list (<code>list</code>). You can display the individual answers as a horizontal button group using <code>horizontal</code> instead, or if you have many short answers you can use <code>multiButtons</code> (you might want to use <code>minWidth</code> in order to fineTune the way your question looks). </td>
</tr>
<tr>
<td>minWidth</td>
<td>(String, default:auto) The minimum width for individual answers (e.g. ‘30%’ or ‘200px’). Usefull in concert with <code>style</code>.</td>
</tr>
<tr>
<td>buttons</td>
<td><em>@DEPRECATED</em> (true or false; default: false) Do not use this property any more! use <code>style</code> instead. </br> By default we use a vertical list format for this question. Set this property to true in order to use a horizontal scale (Likert style). This option  does not currently support extremely narrow screens.</td>
</tr>
<tr>
<td>answers</td>
<td>(Array: []) The list of possible answers for this question. There are two acceptable formats; (1) an array of strings/numbers, (2) an array of objects with <code>text</code> and <code>value</code> parameters.</td>
</tr>
<tr>
<td>required</td>
<td>(true or false; default: false) Validation: require a response.</td>
</tr>
<tr>
<td>correct</td>
<td>(true or false; default: false) Validation: require the response to be correct (set the target value using <code>correctValue</code>)</td>
</tr>
<tr>
<td>correctValue</td>
<td>(*) Set the correct response value for the correct validation (This should be an array for selectMulti).</td>
</tr>
<tr>
<td>errorMsg</td>
<td>(Object: {}) This object has a property for each validation type. Setting the appropriate type changes the validation message. For instance setting the <code>correct</code> property will change the validation message for instances where the correct response was not given.</td>
</tr>
</tbody>
</table>
<p>Each answer on the list has a value associated with it. By default the value is equal to the text of the answer. If <code>numericValues</code> is set, the value is set to the appropriate number. Using the object notation, you can set values of your own.</p>
<p>For example, the following question uses the plain notations, using <code>numericValues</code> to abstract numbers out of the result.</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> quest = {
    type: <span class="hljs-string">'selectOne'</span>,
    stem: <span class="hljs-string">"Do you like bananas?"</span>
    numericValues: <span class="hljs-literal">true</span>,
    answers: [
        <span class="hljs-string">'Very much'</span>,    <span class="hljs-comment">// ==&gt; 0</span>
        <span class="hljs-string">'I guess'</span>,        <span class="hljs-comment">// ==&gt; 1</span>
        <span class="hljs-string">'Not at all'</span>    <span class="hljs-comment">// ==&gt; 2</span>
    ]
}
</code></pre>
<p>The following question uses the object notation to do the exact same thing:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> quest = {
    type: <span class="hljs-string">'selectMulti'</span>,
    stem: <span class="hljs-string">"Do you like bananas?"</span>
    numericValues: <span class="hljs-literal">true</span>,
    answers: [
        {text:<span class="hljs-string">'Very much'</span>, value:<span class="hljs-number">0</span>},    <span class="hljs-comment">// ==&gt; 0</span>
        {text:<span class="hljs-string">'I guess'</span>, value:<span class="hljs-number">1</span>},        <span class="hljs-comment">// ==&gt; 1</span>
        {text:<span class="hljs-string">'Not at all'</span>, value:<span class="hljs-number">2</span>}    <span class="hljs-comment">// ==&gt; 2</span>
    ]
}
</code></pre>
<h4 id="grid">grid</h4>
<p>The grid question allows you to group multiple “multiple choice” questions into a single table. This is often useful when asking several likert type questions using the same scale.</p>
<p>The grid question itself keeps track of the sum of the row questions (excluding any questions that have non-number values).</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>columns</td>
<td>An array of column descriptions. You can use a string here or a column object as described <a href="#gridcolumns">below</a>.</td>
</tr>
<tr>
<td>rows</td>
<td>An array of row descriptions. You can use a string here or a row object as described <a href="#gridrows">below</a>.</td>
</tr>
<tr>
<td>shuffle</td>
<td>Whether to shuffle the order of the questions.</td>
</tr>
<tr>
<td>required</td>
<td>Require the user to respond to all rows (true or false).</td>
</tr>
</tbody>
</table>
<h5 id="grid-columns">grid.columns</h5>
<p>If you set a string instead of a column object it will be treated as if you set only the stem and all other values will be set by default.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stem</td>
<td>(text) The description of this column.</td>
</tr>
<tr>
<td>value</td>
<td>The value to set for this column. Defaults to the number of the column (starting from 1, so that the response for choosing the third column is 3).</td>
</tr>
<tr>
<td>noReverse</td>
<td>When reversing row values, ignore this column (it will retain its normal value).</td>
</tr>
</tbody>
</table>
<h5 id="grid-rows">grid.rows</h5>
<p>If you set a string instead of a row object it will be treated as if you set only the stem and all other values will be set by default.</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>stem</td>
<td>(text) The description of this column.</td>
</tr>
<tr>
<td>name</td>
<td>The name you want this row to be called within the <code>questions</code> object. If this is not set the grid automatically sets it according to the grid name. So that if grid.name is “myGrid” then you’re first row will be called by default “myGrid001”.</td>
</tr>
<tr>
<td>reverse</td>
<td>When calculating the default value for this row, should we reverse the order of columns (high to low and vise versa).</td>
</tr>
<tr>
<td>required</td>
<td>Require the user to respond to this row (this property is redundant if you’ve already set main questions required property to true).</td>
</tr>
</tbody>
</table>
<p>Here is a simple example of using a grid:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> grid =     {
    type: <span class="hljs-string">'grid'</span>,
    name:<span class="hljs-string">'grid'</span>,
    columns: [<span class="hljs-string">'Strongly agree'</span> , <span class="hljs-string">'agree'</span> , <span class="hljs-string">'don\'t know'</span> , <span class="hljs-string">'disagree'</span> , <span class="hljs-string">'Strongly disagree'</span>],
    rows: [<span class="hljs-string">'I like grids'</span>, <span class="hljs-string">'I like bananas too'</span>]
}
</code></pre>
<p>You can, of course have tighter control over the way things work:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> grid =     {
    type: <span class="hljs-string">'grid'</span>,
    name:<span class="hljs-string">'grid'</span>,
    columns: [
        <span class="hljs-string">'Strongly agree'</span>,
        <span class="hljs-string">'agree'</span>,
        <span class="hljs-string">'don\'t know'</span>,
        <span class="hljs-string">'disagree'</span>,
        <span class="hljs-string">'Strongly disagree'</span>,
        {stem:<span class="hljs-string">'Decline to answer'</span>, value:<span class="hljs-string">'n/a'</span>, noReverse:<span class="hljs-literal">true</span>}
    ],
    rows: [
        {stem:<span class="hljs-string">'I like grids'</span>,name:<span class="hljs-string">'likeGrids'</span>},
        <span class="hljs-comment">// This questions scores will be reversed so that the sum of scores is meaningful </span>
        {stem:<span class="hljs-string">'I hate bananas'</span>, name:<span class="hljs-string">'likeBananas'</span>, reverse:<span class="hljs-literal">true</span>}
    ]
}
</code></pre>
<h4 id="slider">slider</h4>
<p>The slider question presents a slider that allows the user to pick a response along a preassigned range. It allows either the creation a continuous scale or dividing the range into steps. The values of the slider are always numbers.
These are the supported properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>min</td>
<td>Maximum slider value (default:0).</td>
</tr>
<tr>
<td>max</td>
<td>Minimum slider value (default:100).</td>
</tr>
<tr>
<td>highlight</td>
<td>Show highlight to left of handle.</td>
</tr>
<tr>
<td>steps</td>
<td>How many steps the slider should be divided into. These intervals are marked with pips and the handle snaps to them.</td>
</tr>
<tr>
<td>hidePips</td>
<td>When the slider is divided into steps, do not display the step pips.</td>
</tr>
<tr>
<td>leftLabel</td>
<td>A label to display on the top left of the slider.</td>
</tr>
<tr>
<td>rightLabel</td>
<td>A label to display on the top right of te slider.</td>
</tr>
<tr>
<td>labels</td>
<td>An array of labels to display underneath the slider. They will be spread evenly across the slider.</td>
</tr>
<tr>
<td>displayValue</td>
<td>Display the value of the slider, beneath the slider control.</td>
</tr>
<tr>
<td>required</td>
<td>(true of false; default: false) Validation: require a non-empty string as a response.</td>
</tr>
<tr>
<td>dflt</td>
<td>The default value for the slider. If no default value is defined, the handle will not be displayed until the slider is first clicked.</td>
</tr>
<tr>
<td>autosubmit</td>
<td>Submit automatically on click or when handle is drop.</td>
</tr>
</tbody>
</table>
<p>The most common use of the slider is the creation of a visual analog scale (VAS). This is an example of using a slider to create a Likert type scale:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> quest = {
    type: <span class="hljs-string">'slider'</span>,
    stem: <span class="hljs-string">'Sliders are exremely useful.'</span>,
    min:<span class="hljs-number">1</span>,
    max:<span class="hljs-number">7</span>,
    steps:<span class="hljs-number">7</span>,
    labels: [<span class="hljs-string">'Strongly Agree'</span>, <span class="hljs-string">'Neutral'</span>, <span class="hljs-string">'Strongly Disagree'</span>]    
}
</code></pre>
<h3 id="settings">settings</h3>
<p>Settings allow you to control the generic way that the player works. Change the settings using the <code>addSettings</code> function. The first argument to the function is always the name of the setting, the second argument is the setting values. In case the setting is an object, subsequent objects will extend each other so that settings may be progressively added.</p>
<h4 id="onend">onEnd</h4>
<p><code>onEnd</code> is a function to be called as soon as the task ends. It should be taken care of automatically when PIQuest is run from within the task manager.</p>
<pre><code class="lang-js">API.addSettings(<span class="hljs-string">'onEnd'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">()</span></span>{
    <span class="hljs-comment">// Do something: for instance, redirect to 'my/url.js'</span>
    location.href = <span class="hljs-string">'my/url.js'</span>;
});
</code></pre>
<h4 id="logger">logger</h4>
<p>This setting controls the way that logging works within the player.</p>
<pre><code class="lang-js">API.addSettings(<span class="hljs-string">"logger"</span>, {
    pulse: <span class="hljs-number">34</span>,
    url: <span class="hljs-string">'/my/url'</span>,    
    logfn: <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(log,pagesData, global)</span></span>{
        <span class="hljs-keyword">return</span> {name: log.name, set: global.setName};
    }
});
</code></pre>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>pulse</td>
<td>(Number; Default: 0) How many rows to collect before posting to the server. 0 means that the player sends to the server only at the end of the task. Note that only questions and pages marked with the <code>lognow</code> property will be pulsed. All other questions will be sent at the end of the task.</td>
</tr>
<tr>
<td>url</td>
<td>(Text; default:””) The URL to which we should post the data to.</td>
</tr>
<tr>
<td>logfn</td>
<td>(Function) The task has a default object that it logs, if you want to change the logged object itself, you may use a function of the form: <code>function(log, pagesData, global){return logObj;}</code></td>
</tr>
</tbody>
</table>
<p>Within the player, each question (as defined by unique question name) may be logged only once. By default questions are logged at the end of a page (on submit or decline), if you want to delay logging until the end of the task, you may do so by setting <code>nolog</code> in the appropriate page or question.</p>
<p>If you want a question not to be logged at all, simply do not give it a name.</p>
<p>You may want to debug the logger by <a href="#debugging">activating the DEBUG <code>logger</code> setting</a>. When activated, it prints each logged object into the console.</p>
<h4 id="debugging">Debugging</h4>
<p>PIQuest can supply some extra information regarding its inner workings, all you have to do is set the DEBUG setting property like so:</p>
<pre><code class="lang-js"><span class="hljs-comment">// Log everything</span>
API.addSettings(<span class="hljs-string">'DEBUG'</span>, {
    level: <span class="hljs-string">'warn'</span>, <span class="hljs-comment">// log errors and warnings</span>
    tags: [<span class="hljs-string">'page'</span>,<span class="hljs-string">'animation'</span>], <span class="hljs-comment">// Log page and animation related messages</span>
    hideConsole: <span class="hljs-literal">true</span> 
});
</code></pre>
<p><strong>tags</strong>:
Logs are broken down into subjects by tags. The tags property allows you to insert an array of tags that you want to be logged. If you want all tags to printed you may use the string <code>&#39;all&#39;</code> instead of an array (this is also the default).</p>
<p>The tags currently available are as follows: <code>page</code>, <code>question</code>, <code>conditions</code> and <code>animate</code>.</p>
<p><strong>level</strong>:
The player has several levels of logging, by default it logs only <code>error</code> level logs. When you want to debug you should probably use <code>info</code> or <code>warn</code>. The precedence of logging levels is as follows: error&gt;warn&gt;info&gt;debug. Each logging level includes any levels higher than itself.</p>
<table>
<thead>
<tr>
<th>level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>none</td>
<td>Do not log any messages</td>
</tr>
<tr>
<td>error</td>
<td>Log messages that warn that something in the script is broken (this is the default level, and you should probably leave at least this level active).</td>
</tr>
<tr>
<td>warn</td>
<td>Log warning messages that something smells fishy, these are not necessarily errors, but you might want to check them out.</td>
</tr>
<tr>
<td>info</td>
<td>Log General useful information.</td>
</tr>
<tr>
<td>debug</td>
<td>Just spill everything out.</td>
</tr>
</tbody>
</table>
<p><strong>hideConsole</strong>:
This property allows you to control the display of logs inside the browser, if it is set to <code>true</code> then the logs will only be printed into your console.</p>
<h3 id="making-your-questionnaire-dynamic">Making your questionnaire dynamic</h3>
<p>There are several ways that you can make your questionnaire more dynamic. We will give a short overview and then get into the specifics.</p>
<p>The basic elements of the player (pages or questions) are set into ordered lists (arrays). The player parses these lists into the questionnaire that the user eventually sees.</p>
<p>The first level of parsing has to do with the order that the elements appear.The <a href="#mixer">mixer</a> allows you to control the order of the lists; it allows you to randomize the order, duplicate elements and even display them conditionally.</p>
<p>The second level of parsing has to do with inheritance. Many times you want to present several elements that share some of the same features (for instance, you may want all your pages to have the same header or the same submit text). The <a href="#inheritance">inherit </a> feature allows you to create prototypes of elements that you may reuse thought your script.</p>
<p>The third and last level of parsing has to do with templates. <a href="#templates">Templates</a> allow you to change the settings of your elements depending on existing data from within the player. For instance, you may want to refer to the answer of a previous question. </p>
<p>Some sequence may be parsed more than once, for instance, the questions sequences get re-parsed each time a response is changed, and each time a user returns to a page it is re-parsed. By default, none of the parsing is repeated so that the questionnaires can stay fixed. For each type of parsing there is a property that lets the player know that you want it re-parsed.</p>
<p>In order to re-parse mixers, set <code>remix</code> to true. In order to re-parse inheritance set <code>reinflate</code> to true. In order to re-parse templates set <code>regenerateTemplate</code> to true.</p>
<p>Another consideration when creating complex sequences is logging. By default the player logs user responses automatically as soon as the user submits. If you are creating a sequence that allows users to go back to previous questions etc. you should make sure you don’t prematurely log the user response (use <code>nolog</code>. learn more <a href="#logger">here</a>).</p>
<h3 id="mixer">Mixer</h3>
<p>The mixer is responsible for managing lists (arrays) within PIQuest, it is capable of repeating, randomizing and even changing the list according to <a href="#variables">environmental variables</a>. You may use it within the sequence, for answer lists within pages and even for answers within the <code>selectOne</code> or <code>selectMulti</code> questions.
The mixer allows wrapping a sub list in an object that allows you to manipulate the way in which it appears. You may insert such an object at any place within a list and it will be replaced by the appropriate objs.</p>
<p>The basic structure of a mixer object is:</p>
<pre><code class="lang-js">{
    mixer: <span class="hljs-string">'functionType'</span>,
    data: [obj1, obj2]
}
</code></pre>
<p>The <code>mixer</code> property defines the mixer type. It tells the mixer what to do with the list. The <code>data</code> property defines the list; an array of elements (either plain objects or mixer objects).</p>
<p>A sequence can look something like this:</p>
<pre><code class="lang-js">[
    <span class="hljs-comment">// The first obj to present.</span>
    firstobj,

    <span class="hljs-comment">// Repeat the structure inside 10 time (so we get 40 objs)</span>
    {
        mixer: <span class="hljs-string">'repeat'</span>,
        times: <span class="hljs-number">10</span>,
        data: [
            <span class="hljs-comment">// Delay the mixing of these elements until after the `repeat`.</span>
            {
                mixer: <span class="hljs-string">'wrapper'</span>,
                data: [
                    obj1,
                    <span class="hljs-comment">// Randomize the order of the objectss within.</span>
                    {
                        mixer: <span class="hljs-string">'random'</span>,
                        data: [
                            obj2,
                            <span class="hljs-comment">// Keep obj 3 and 4 together.</span>
                            {
                                mixer: <span class="hljs-string">'wrapper'</span>,
                                data: [
                                    obj3,
                                    obj4
                                ]
                            }
                        ]
                    } <span class="hljs-comment">// end random</span>
                ]
            } <span class="hljs-comment">// end wrapper</span>
        ]
    }, <span class="hljs-comment">// end repeat</span>

    <span class="hljs-comment">// the last obj to present</span>
    lastobj
]
</code></pre>
<p>This sequence has an opening and ending obj (<code>firstobj</code> and <code>lastobj</code>).
Between them them we repeat a set of four objs ten times.
The order of the four objs is randomized, so that <code>obj1</code> always comes first and the order of the following objs are randomized but <code>obj3</code> and <code>obj4</code> are wrapped together and therefore always stay consecutive.</p>
<h4 id="mixer-types">Mixer types</h4>
<p><strong>repeat</strong>:
Repeats the element in <code>data</code> <code>times</code> times.</p>
<ul>
<li><code>{mixer:&#39;repeat&#39;, times:10, data: [obj1,obj2]}</code></li>
</ul>
<p><strong>random</strong>:
Randomizes the order of elements in <code>data</code>.</p>
<ul>
<li><code>{mixer:&#39;random&#39;, data: [obj1,obj2]}</code></li>
</ul>
<p><strong>weightedRandom</strong>:
Selects a single element using a weighted random algorithm. Each element in <code>data</code> is given the appropriate weight from <code>weights</code>. In the following example obj2 has four times the probability of being selected as obj1.</p>
<ul>
<li><code>{mixer:&#39;weightedRandom&#39;, weights: [0.2,0.8], data: [obj1,obj2]}</code></li>
</ul>
<p><strong>choose</strong>:
Selects <code>n</code> random elements from <code>data</code> (by default the chooser picks one element).</p>
<ul>
<li><code>{mixer:&#39;choose&#39;, data: [obj1,obj2]}</code> pick one of these two objs</li>
<li><code>{mixer:&#39;choose&#39;, n:2, data: [obj1,obj2,obj3]}</code> pick two of these three objs</li>
</ul>
<p><strong>wrapper</strong>:
The wrapper mixer serves a sort of parenthesis for the mixer. In case you want to keep a set of elements as a block (when randomizing) simply wrap them and they’ll stay together.</p>
<ul>
<li><code>{mixer:&#39;wrapper&#39;, data: [obj1,obj2]}</code></li>
</ul>
<p><strong>branch</strong>:</p>
<ul>
<li><code>{mixer:&#39;branch&#39;, conditions:[cond], data:[obj1,obj2]}</code></li>
<li><code>{mixer:&#39;branch&#39;, conditions:[cond], data:[obj1,obj2], elseData: [obj3, obj4]}</code>
Select the elements in <code>data</code> if all the conditions in the <code>conditions</code> array are true, select the elements in <code>elseData</code> if at least one of the conditions in <code>conditions</code> are not true. If <code>elseData</code> is not defined, or is left empty, then nothing happen in case the conditions are not true (See <a href="#conditions">conditions</a> to learn about how conditions work).</li>
</ul>
<p><strong>multiBranch</strong>:</p>
<pre><code class="lang-js">{
    mixer: <span class="hljs-string">'multiBranch'</span>,
    branches: [
        {conditions: [],data: []},
        {conditions: [],data: []}
    ],
    elseData: [] <span class="hljs-comment">// optional</span>
}
</code></pre>
<p>Find the first object within <code>branches</code> for which <code>conditions</code> is true, and select the elements in that objects <code>data</code>. If no object is selected then select <code>elseData</code> (optional). (See <a href="#conditions">conditions</a> to learn about how conditions work).</p>
<h4 id="conditions">Conditions</h4>
<p>The conditional mixers allow you to change the content of a list according to <a href="#variables">environmental variables</a>. Each list has specific variables available to it, you can find the relevant details in the documentation for each list, but all lists have access to the <code>global</code> and <code>current</code> objects, so we’ll use them for all examples here.</p>
<p>A condition is a proposition, it is evaluated to either a <code>true</code> or <code>false</code> value. Conditions are used for decision making within the branching mixers. Conditions are represented by objects. The following condition object <code>compare</code>s <strong>global.var</strong> <code>to</code> <strong>local.otherVar</strong> and examines if they are equal (if you aren’t sure what <strong>global.var</strong> means, see <a href="#variables">here</a>):</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> cond = {
    compare: <span class="hljs-string">'global.myVar'</span>,
    to: <span class="hljs-string">'local.myOtherVar'</span>
}
</code></pre>
<p>Conditions should be treated as a type of equation.</p>
<p>In the <code>compare</code> and <code>to</code> properties you can set either straight forward values or references to a variable:</p>
<pre><code class="lang-js"><span class="hljs-comment">//Compares the variable time to the value 12</span>
<span class="hljs-keyword">var</span> cond1 = {
    compare: <span class="hljs-string">'global.time'</span>,
    to: <span class="hljs-string">'12'</span>
}
<span class="hljs-comment">//Compare the variable gender to the value 'Female'</span>
<span class="hljs-keyword">var</span> cond2 = {
    compare: <span class="hljs-string">'Female'</span>,
    to: <span class="hljs-string">'local.gender'</span>
}
</code></pre>
<p>When you want to refer to a variable, you use text with dots: <code>global.var</code>, <code>questions.q1.response</code>; these values will be treated as pointing to variables within the lists context. <code>questions.q1.response</code> will retrieve the value of the response for q1 from the questions object. The following checks whether the global variable var is equal to 15.</p>
<p>Here are the condition’s possible properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>compare</td>
<td>The left side of the equation.</td>
</tr>
<tr>
<td>to</td>
<td>The right side of the equation.</td>
</tr>
<tr>
<td>operator</td>
<td>The type of comparison to do (read more about operators <a href="#operators">here</a>).</td>
</tr>
</tbody>
</table>
<p>You may want to debug conditions by <a href="#debugging">activating the DEBUG <code>conditions</code> setting</a>. When activated, then any condition that is evaluated will be logged to the console.</p>
<p>Advanced users may want to replace the whole condition object with a custom function that returns true or false. The context for the function is an object holding the <em>global</em>, <em>current</em> and <em>questions</em> objects.</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">cond</span><span class="hljs-params">()</span></span>{
    <span class="hljs-keyword">var</span> global = <span class="hljs-keyword">this</span>.global; <span class="hljs-comment">// get the global from the context</span>
    <span class="hljs-keyword">return</span> global.skip;
}
</code></pre>
<h4 id="operators">Operators</h4>
<p>The default comparison for a condition is to check equality (supports comparison of objects and arrays too). You can use the <code>operator</code> property to change the comparison method. The following checks if var is greater than otherVar:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> cond = {
    compare: <span class="hljs-string">'global.var'</span>,
    to: <span class="hljs-string">'local.otherVar'</span>,
    operator: <span class="hljs-string">'greaterThan'</span>
}
</code></pre>
<table>
<thead>
<tr>
<th>Operator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>equals</td>
<td>This is the default operator. It checks if <em>compare</em> is equal to <em>to</em> (supports comparison of objects and arrays too)</td>
</tr>
<tr>
<td>exactly</td>
<td>Checks if <em>compare</em> is exactly equal to <em>to</em> (uses ===)</td>
</tr>
<tr>
<td>greaterThan</td>
<td><em>compare</em> &gt; <em>to</em></td>
</tr>
<tr>
<td>greaterThanOrEquals</td>
<td><em>compare</em> &gt;= <em>to</em></td>
</tr>
<tr>
<td>in</td>
<td><em>compare</em> is in the Array <em>to</em>;</td>
</tr>
<tr>
<td>function(){}</td>
<td>This operator allows you to use a custom function of the form: <code>function(compareValue, toValue, context){return {Boolean}}</code>. The context is an object holding the <em>global</em>, <em>current</em> and <em>questions</em> objects.</td>
</tr>
</tbody>
</table>
<h4 id="aggregation">Aggregation</h4>
<p>Sometimes you will want a branch to be activated only if more than one condition is true, or in some other complex specific condition. For cases like this, the mixer supports aggregation. The mixer supports applying logical operations on conditions in the following way:</p>
<p>An aggregator object has a single property, denoting the type of aggregation, holding an array of conditions to aggregate. The following condition will only be true if <code>cond1</code> and <code>cond2</code> are both true:</p>
<pre><code class="lang-js"><span class="hljs-keyword">var</span> cond = {and:[cond1, cond2]};
</code></pre>
<p>The mixer supports several types of aggregators:</p>
<table>
<thead>
<tr>
<th>Aggregator</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>and</td>
<td>If all conditions are true</td>
</tr>
<tr>
<td>or</td>
<td>If at least one condition is true</td>
</tr>
<tr>
<td>nor</td>
<td>If all conditions are false</td>
</tr>
<tr>
<td>nand</td>
<td>If at least one condition is false</td>
</tr>
</tbody>
</table>
<p>By default, if the mixer runs into an array instead of an object, it will treat it as an <code>and</code> aggregator and be true only if all conditions within the array are true.</p>
<p>Following are several examples for how to create different aggregations:</p>
<pre><code class="lang-js"><span class="hljs-comment">// cond1 &amp;&amp; cond2</span>
<span class="hljs-keyword">var</span> conds = [cond1, cond2];

<span class="hljs-comment">// cond1 &amp;&amp; (cond2 || cond3)</span>
<span class="hljs-keyword">var</span> conds = [cond1, {or:[cond2,cond3]}];

<span class="hljs-comment">// (cond1 &amp;&amp; cond2) || cond2</span>
<span class="hljs-keyword">var</span> conds = [{or:[{and:[cond1,cond2]},cond3]}]
</code></pre>
<h3 id="variables">Variables</h3>
<p>Sometimes it is not enough to hard code behaviors into your tasks, sometimes you want behavior to depend on a previous response, or change texts according to randomization. In order to support these behaviors you can use variables.</p>
<p>The <code>global</code> variable is the context of everything that happens within the task manager. It is an object that holds a property for each task that is run.
The current task object is automatically set into the global, as well as any questions that the user completes. In addition you as a user may extend it manually using the <code>API.addGlobal</code> function. You can also set Global by using the <code>pi-global</code> attribute of <code>pi-task</code>;</p>
<pre><code class="lang-js">API.addGlobal({
    value: <span class="hljs-number">123</span>,
    variable: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
})
</code></pre>
<p>Each <strong>PIQuest</strong> task has an object associated with it that logs anything that happens within the task. In the duration of the task, this object can be accessed using the <code>current</code> object. After the task ends, the object stays available from within the global object as <code>global.taskName</code>, where “taskName” is the name associated with this specific task.
The task object is there for you to change. You can extend it to your hearts content using <code>API.addCurrent</code>:</p>
<pre><code class="lang-js">API.addCurrent({
    value: <span class="hljs-number">123</span>,
    variable: [<span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>]
})
</code></pre>
<p><strong>PIQuest</strong> task objects have a reserved property called <code>questions</code>. <code>questions</code> holds an object that keeps track of all questions answered throughout the questionnaire. Each question is logged on to the property with its name; for instance if you have a question named quest1, then <code>questions.quest1</code> will hold an object describing the user response.
The following is a list of the response object properties:</p>
<table>
<thead>
<tr>
<th>Property</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>response</td>
<td>The user response itself.</td>
</tr>
<tr>
<td>latency</td>
<td>The time from the moment the question was displayed to the last time it was changed.</td>
</tr>
<tr>
<td>pristineLatency</td>
<td>The time from the moment the question was displayed to the first time it was changed.</td>
</tr>
<tr>
<td>declined</td>
<td>whether the user declined to answer this question.</td>
</tr>
</tbody>
</table>
<p>Throughout the player there are several components that refer to environmental variables. In particular you should check out <a href="#conditions">mixer conditions</a> and <a href="#templates">templates</a>.</p>
<h3 id="templates">Templates</h3>
<p>One of the ways to create dynamic questionnaires is using templates. Templates are a format that allows you to dynamically generate settings for your questions. You can replace any non-object setting from within your questions/pages with a template, and it will be rendered according to the <a href="#variables">environmental variables</a> (The exception to this rule is the <code>inherit</code> setting that cannot use templates).</p>
<p>A template is a string that has a section of the form <code>&lt;%= %&gt;</code> in it. Within these brackets you can write any Javascript that you like and it will be evaluated and printed out. The main use of templates is probably accessing local and global variables. For instance, in order to print the global variable “name”, you could create a template that looks like this: <code>My name is &lt;%= global.name%&gt;</code>.</p>
<p>The player uses <a href="http://lodash.com/docs#template">lodash templates</a> internally, you can look them up to see all the possible uses.</p>
<p>Templates allow access only to a confined number of variables; following is a list of the variables that you can access from within templates:</p>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>global</td>
<td>The global object.</td>
</tr>
<tr>
<td>current</td>
<td>The current task object.</td>
</tr>
<tr>
<td>questions</td>
<td>The questions object.</td>
</tr>
<tr>
<td>pagesData</td>
<td>The ‘data’ attribute from the page.</td>
</tr>
<tr>
<td>questionsData</td>
<td>The ‘data’ attribute from the question (available only within questions).</td>
</tr>
<tr>
<td>pagesMeta</td>
<td>An object describing meta data about the page:</br> <code>number</code>: the serial number of this page, <code>outOf</code> the overall number of pages, <code>name</code>: the name of the current page. These can be used for instance to generate a description of your place within the questionnaire: <code>&lt;%= pagesMeta.number %&gt; out of &lt;%= pagesMeta.outOf%&gt;</code>.</td>
</tr>
</tbody>
</table>
<p>Questions and Pages have access to the same local variables, with the exception of questionsData that is available only to questions.</p>
<h3 id="inheritance">Inheritance</h3>
<p>Each element in PIQuest (page/question) can inherit its attributes from an element set.</p>
<h4 id="sets">Sets</h4>
<p>The element sets are defined using the <code>addPagesSet</code> and <code>addQuestionsSet</code> function in the API.</p>
<p>Each set is simply an array of elements that can later be referred to as a base for new elements. Note that the name that you give the set (in the example: base or demographics) is the handle that you later use to refer to it.</p>
<pre><code class="lang-js">API.addQuestionsSet(<span class="hljs-string">'likert'</span>, [
    {type: <span class="hljs-string">'selectOne'</span>, numericValues: <span class="hljs-literal">true</span>}
]);

API.addQuestionsSet(<span class="hljs-string">'sizeLikert'</span>, [
    {inherit: <span class="hljs-string">'likert'</span>, answers: [<span class="hljs-string">'Big'</span>, <span class="hljs-string">'Medium'</span>, <span class="hljs-string">'Small'</span>]}
]);
</code></pre>
<h4 id="inheriting">Inheriting</h4>
<p>When inheriting an element the new element starts out with all of the parent’s attributes and extends them with its own. This means that we use the parent element as a base and then copy in any properties that the child has, overwriting any existing properties.
The only exception to this rule is the <code>data</code> objects which we attempt to merge (giving precedence to the child).</p>
<p>Follow this pseudo code:</p>
<pre><code class="lang-js"><span class="hljs-comment">// The parent page</span>
{
    data: {name: <span class="hljs-string">'jhon'</span>, family:<span class="hljs-string">'doe'</span>}
    questions: [
        quest1,
        quest2
    ]
}

<span class="hljs-comment">// The child page which attempts to inherit the parent</span>
{
    inherit: <span class="hljs-string">'parent'</span>,
    data: {name: <span class="hljs-string">'jack'</span>}
    questions: [
        quest3
    ]
}

<span class="hljs-comment">// The result would be:</span>
{
    data: {name: <span class="hljs-string">'jack'</span>, family:<span class="hljs-string">'doe'</span>}     <span class="hljs-comment">// the child kept its own name but inherited the family name</span>
    stimuli: [                            <span class="hljs-comment">// the questions array was completely overwritten</span>
        quest3
    ]
}
</code></pre>
<p>In order for an element to inherit another element it must use the <code>inherit</code> property of the inheriting element.</p>
<pre><code class="lang-js">{
    inherit: inheritObject
}
</code></pre>
<p>The inherit object has a <code>set</code> property defining which element set it should inherit from.
It also has a <code>type</code> property that defines what type of inheritance we should use.</p>
<p>We have implemented several types of inheritance:</p>
<p><strong>random</strong>:
Randomly selects an element from the set (in case the set has only one element, the same element will always be selected, of course). </p>
<ul>
<li><code>&#39;setName&#39;</code></li>
<li><code>{set: &#39;setName&#39;}</code></li>
<li><code>{set: &#39;setName&#39;, type:&#39;random&#39;}</code>
<code>random</code> this is the default inheritance type, so it is not obligatory to use the <code>type</code> property. You can also use a short cut and set the <code>set</code> using only its name, like we did in the example above:<pre><code class="lang-js">{
  inherit: <span class="hljs-string">'parent'</span>,
  data: {name: <span class="hljs-string">'jack'</span>}
  questions: [
      quest3
  ]
}
</code></pre>
</li>
</ul>
<p><strong>exRandom</strong>:
Selects a random element without repeating the same element until we’ve gone through the whole set</p>
<ul>
<li><code>{set: &#39;setName&#39;, type:&#39;exRandom&#39;}</code></li>
</ul>
<p><strong>sequential</strong>:
Selects the elements by the order they were inserted into the set</p>
<ul>
<li><code>{set: &#39;setName&#39;, type:&#39;sequential&#39;}</code></li>
</ul>
<p><strong>byData</strong>:
Selects a specific element from the set.
We compare the <code>data</code> property to the <code>element.data</code> property and if <code>data</code> is a subset of <code>element.data</code> it selects the element (this means that if all properties of data property equal to the properties of the same name in element.data it is a fit).
This function will select only the first element to fit the data.
If the data property is set as a string, we assume it refers to the element handle.</p>
<ul>
<li><code>{set: &#39;setName&#39;, type: &#39;byData&#39;, data: {block:1, row:2}}</code> picks the element with both block:1 and row:2</li>
<li><code>{set: &#39;setName&#39;, type: &#39;byData&#39;, data: &quot;myStimHandle&quot;}</code> picks the element that has the “myStimHandle” handle</li>
</ul>
<p><strong>function</strong>:
You may also use a custom function to select your element (the function here, fully replaces the inherit object).</p>
<pre><code class="lang-js"><span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(definitions)</span></span>{
    <span class="hljs-comment">// definitions is the inherit object (including  set, type, and whatever other properties you'd like to use)</span>
}
</code></pre>
<h4 id="customization">Customization</h4>
<p>Each question/page can also define a <code>customize</code> method, this method is called once the element is inherited but before it is activated.
It accepts two argument: the source object on which it is called (the page or question object), and the global object (in which you can find the current object etc.). The source object is also the context for the function.</p>
<pre><code class="lang-js">{
    inherit: <span class="hljs-string">'something'</span>,
    customize : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(source)</span></span>{
        source.questions.push(quest);
    }
}
</code></pre>


				</div>

				<div class="col-md-3" role="complementary">
					<nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm">

						

						

						<ul class="nav bs-docs-sidenav">
						

							
							<li class="">
								<a href="../quest/overview.html">Overview</a>
							</li>
						
							
							<li class="">
								<a href="../quest/introduction.html">Introduction</a>
							</li>
						
							<li>
								<a href="helloworldDocco.html">Examples</a>
								<ul class="nav">
									
							<li class="">
								<div>
									<a href="../quest/helloworldDocco.html">Hello world</a>
									<a href="../quest/helloworld.js" download="../quest/helloworld.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../quest/helloworldPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../quest/bodyAwarenessDocco.html">Body Awareness</a>
									<a href="../quest/bodyAwareness.js" download="../quest/bodyAwareness.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../quest/bodyAwarenessPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../quest/weightDocco.html">Weight demo</a>
									<a href="../quest/weight.js" download="../quest/weight.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../quest/weightPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../quest/usingImagesDocco.html">Using Images</a>
									<a href="../quest/usingImages.js" download="../quest/usingImages.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../quest/usingImagesPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
								</ul>
							</li>
							<li>
								<a href="javascript:void(0)">Questions</a>
								<ul class="nav">
									
							<li class="">
								<div>
									<a href="../questExamples/textDocco.html">Text</a>
									<a href="../questExamples/text.js" download="../questExamples/text.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/textPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/textareaDocco.html">Textarea</a>
									<a href="../questExamples/textarea.js" download="../questExamples/textarea.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/textareaPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/textNumberDocco.html">Text Number</a>
									<a href="../questExamples/textNumber.js" download="../questExamples/textNumber.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/textNumberPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/selectOneDocco.html">Select One</a>
									<a href="../questExamples/selectOne.js" download="../questExamples/selectOne.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/selectOnePlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/selectMultiDocco.html">Select Multi</a>
									<a href="../questExamples/selectMulti.js" download="../questExamples/selectMulti.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/selectMultiPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/gridDocco.html">Grid</a>
									<a href="../questExamples/grid.js" download="../questExamples/grid.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/gridPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
									
							<li class="">
								<div>
									<a href="../questExamples/sliderDocco.html">Slider</a>
									<a href="../questExamples/slider.js" download="../questExamples/slider.js" title="Download"><span class="glyphicon glyphicon-download"></span></a>
									<a href="../questExamples/sliderPlay.html" title="Play"><span class="glyphicon glyphicon-play-circle"></span></a>
								</div>
							</li>
						
								</ul>
							</li>
							
							<li class="">
								<a href="../quest/API.html">API</a>
							</li>
						
							
							<li class="">
								<a href="../quest/questplayground.html">Playground</a>
							</li>
						
						
						</ul>
						<!-- <a class="back-to-top" href="#top">
							Back to top
						</a> -->
					</nav>
				</div>
			</div>
		</div>

		<!-- Footer
		================================================== -->
		<footer class="bs-docs-footer" role="contentinfo">
			<div class="container">
				<p>Created by Project Implicit for the benefit of all.</p>
				<!-- <p>Code licensed under <a href="https://github.com/twbs/bootstrap/blob/master/LICENSE" target="_blank">MIT</a>, documentation under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</p> -->
				<ul class="bs-docs-footer-links text-muted">
					<li>Currently v0.0.44</li>
					<li>&middot;</li>
					<li><a href="https://github.com/ProjectImplicit/PIquest">GitHub</a></li>
					<li>&middot;</li>
					<li><a href="https://github.com/ProjectImplicit/PIquest/releases">Releases</a></li>
				</ul>
			</div>
		</footer>

	</body>
</html>